import{r as m,_ as V,R as y,c as z,P as u,u as Ot,T as Eo,t as Ss,a as ke,s as ks,h as wt,i as Os,k as So,C as Ds,l as Ts,j as a,p as Rs,d as Ms,e as Un,f as Ps}from"./pivotHelper-DRcZQBeS.js";var ve="top",Oe="bottom",De="right",be="left",lr="auto",on=[ve,Oe,De,be],Nt="start",Jt="end",Fs="clippingParents",ko="viewport",Bt="popper",As="reference",Ir=on.reduce(function(e,t){return e.concat([t+"-"+Nt,t+"-"+Jt])},[]),Oo=[].concat(on,[lr]).reduce(function(e,t){return e.concat([t,t+"-"+Nt,t+"-"+Jt])},[]),$s="beforeRead",Ls="read",Ys="afterRead",Is="beforeMain",zs="main",Ws="afterMain",Bs="beforeWrite",Hs="write",Vs="afterWrite",qs=[$s,Ls,Ys,Is,zs,Ws,Bs,Hs,Vs];function Ye(e){return e?(e.nodeName||"").toLowerCase():null}function Ce(e){if(e==null)return window;if(e.toString()!=="[object Window]"){var t=e.ownerDocument;return t&&t.defaultView||window}return e}function mt(e){var t=Ce(e).Element;return e instanceof t||e instanceof Element}function Se(e){var t=Ce(e).HTMLElement;return e instanceof t||e instanceof HTMLElement}function cr(e){if(typeof ShadowRoot>"u")return!1;var t=Ce(e).ShadowRoot;return e instanceof t||e instanceof ShadowRoot}function Gs(e){var t=e.state;Object.keys(t.elements).forEach(function(n){var r=t.styles[n]||{},o=t.attributes[n]||{},s=t.elements[n];!Se(s)||!Ye(s)||(Object.assign(s.style,r),Object.keys(o).forEach(function(i){var l=o[i];l===!1?s.removeAttribute(i):s.setAttribute(i,l===!0?"":l)}))})}function Xs(e){var t=e.state,n={popper:{position:t.options.strategy,left:"0",top:"0",margin:"0"},arrow:{position:"absolute"},reference:{}};return Object.assign(t.elements.popper.style,n.popper),t.styles=n,t.elements.arrow&&Object.assign(t.elements.arrow.style,n.arrow),function(){Object.keys(t.elements).forEach(function(r){var o=t.elements[r],s=t.attributes[r]||{},i=Object.keys(t.styles.hasOwnProperty(r)?t.styles[r]:n[r]),l=i.reduce(function(c,f){return c[f]="",c},{});!Se(o)||!Ye(o)||(Object.assign(o.style,l),Object.keys(s).forEach(function(c){o.removeAttribute(c)}))})}}const _s={name:"applyStyles",enabled:!0,phase:"write",fn:Gs,effect:Xs,requires:["computeStyles"]};function Le(e){return e.split("-")[0]}var ut=Math.max,wn=Math.min,jt=Math.round;function nr(){var e=navigator.userAgentData;return e!=null&&e.brands&&Array.isArray(e.brands)?e.brands.map(function(t){return t.brand+"/"+t.version}).join(" "):navigator.userAgent}function Do(){return!/^((?!chrome|android).)*safari/i.test(nr())}function Et(e,t,n){t===void 0&&(t=!1),n===void 0&&(n=!1);var r=e.getBoundingClientRect(),o=1,s=1;t&&Se(e)&&(o=e.offsetWidth>0&&jt(r.width)/e.offsetWidth||1,s=e.offsetHeight>0&&jt(r.height)/e.offsetHeight||1);var i=mt(e)?Ce(e):window,l=i.visualViewport,c=!Do()&&n,f=(r.left+(c&&l?l.offsetLeft:0))/o,d=(r.top+(c&&l?l.offsetTop:0))/s,p=r.width/o,b=r.height/s;return{width:p,height:b,top:d,right:f+p,bottom:d+b,left:f,x:f,y:d}}function dr(e){var t=Et(e),n=e.offsetWidth,r=e.offsetHeight;return Math.abs(t.width-n)<=1&&(n=t.width),Math.abs(t.height-r)<=1&&(r=t.height),{x:e.offsetLeft,y:e.offsetTop,width:n,height:r}}function To(e,t){var n=t.getRootNode&&t.getRootNode();if(e.contains(t))return!0;if(n&&cr(n)){var r=t;do{if(r&&e.isSameNode(r))return!0;r=r.parentNode||r.host}while(r)}return!1}function Ve(e){return Ce(e).getComputedStyle(e)}function Ks(e){return["table","td","th"].indexOf(Ye(e))>=0}function nt(e){return((mt(e)?e.ownerDocument:e.document)||window.document).documentElement}function Mn(e){return Ye(e)==="html"?e:e.assignedSlot||e.parentNode||(cr(e)?e.host:null)||nt(e)}function zr(e){return!Se(e)||Ve(e).position==="fixed"?null:e.offsetParent}function Us(e){var t=/firefox/i.test(nr()),n=/Trident/i.test(nr());if(n&&Se(e)){var r=Ve(e);if(r.position==="fixed")return null}var o=Mn(e);for(cr(o)&&(o=o.host);Se(o)&&["html","body"].indexOf(Ye(o))<0;){var s=Ve(o);if(s.transform!=="none"||s.perspective!=="none"||s.contain==="paint"||["transform","perspective"].indexOf(s.willChange)!==-1||t&&s.willChange==="filter"||t&&s.filter&&s.filter!=="none")return o;o=o.parentNode}return null}function sn(e){for(var t=Ce(e),n=zr(e);n&&Ks(n)&&Ve(n).position==="static";)n=zr(n);return n&&(Ye(n)==="html"||Ye(n)==="body"&&Ve(n).position==="static")?t:n||Us(e)||t}function ur(e){return["top","bottom"].indexOf(e)>=0?"x":"y"}function qt(e,t,n){return ut(e,wn(t,n))}function Qs(e,t,n){var r=qt(e,t,n);return r>n?n:r}function Ro(){return{top:0,right:0,bottom:0,left:0}}function Mo(e){return Object.assign({},Ro(),e)}function Po(e,t){return t.reduce(function(n,r){return n[r]=e,n},{})}var Js=function(t,n){return t=typeof t=="function"?t(Object.assign({},n.rects,{placement:n.placement})):t,Mo(typeof t!="number"?t:Po(t,on))};function Zs(e){var t,n=e.state,r=e.name,o=e.options,s=n.elements.arrow,i=n.modifiersData.popperOffsets,l=Le(n.placement),c=ur(l),f=[be,De].indexOf(l)>=0,d=f?"height":"width";if(!(!s||!i)){var p=Js(o.padding,n),b=dr(s),v=c==="y"?ve:be,w=c==="y"?Oe:De,g=n.rects.reference[d]+n.rects.reference[c]-i[c]-n.rects.popper[d],h=i[c]-n.rects.reference[c],x=sn(s),E=x?c==="y"?x.clientHeight||0:x.clientWidth||0:0,C=g/2-h/2,j=p[v],k=E-b[d]-p[w],O=E/2-b[d]/2+C,N=qt(j,O,k),S=c;n.modifiersData[r]=(t={},t[S]=N,t.centerOffset=N-O,t)}}function ea(e){var t=e.state,n=e.options,r=n.element,o=r===void 0?"[data-popper-arrow]":r;o!=null&&(typeof o=="string"&&(o=t.elements.popper.querySelector(o),!o)||To(t.elements.popper,o)&&(t.elements.arrow=o))}const ta={name:"arrow",enabled:!0,phase:"main",fn:Zs,effect:ea,requires:["popperOffsets"],requiresIfExists:["preventOverflow"]};function St(e){return e.split("-")[1]}var na={top:"auto",right:"auto",bottom:"auto",left:"auto"};function ra(e,t){var n=e.x,r=e.y,o=t.devicePixelRatio||1;return{x:jt(n*o)/o||0,y:jt(r*o)/o||0}}function Wr(e){var t,n=e.popper,r=e.popperRect,o=e.placement,s=e.variation,i=e.offsets,l=e.position,c=e.gpuAcceleration,f=e.adaptive,d=e.roundOffsets,p=e.isFixed,b=i.x,v=b===void 0?0:b,w=i.y,g=w===void 0?0:w,h=typeof d=="function"?d({x:v,y:g}):{x:v,y:g};v=h.x,g=h.y;var x=i.hasOwnProperty("x"),E=i.hasOwnProperty("y"),C=be,j=ve,k=window;if(f){var O=sn(n),N="clientHeight",S="clientWidth";if(O===Ce(n)&&(O=nt(n),Ve(O).position!=="static"&&l==="absolute"&&(N="scrollHeight",S="scrollWidth")),O=O,o===ve||(o===be||o===De)&&s===Jt){j=Oe;var R=p&&O===k&&k.visualViewport?k.visualViewport.height:O[N];g-=R-r.height,g*=c?1:-1}if(o===be||(o===ve||o===Oe)&&s===Jt){C=De;var F=p&&O===k&&k.visualViewport?k.visualViewport.width:O[S];v-=F-r.width,v*=c?1:-1}}var P=Object.assign({position:l},f&&na),A=d===!0?ra({x:v,y:g},Ce(n)):{x:v,y:g};if(v=A.x,g=A.y,c){var Y;return Object.assign({},P,(Y={},Y[j]=E?"0":"",Y[C]=x?"0":"",Y.transform=(k.devicePixelRatio||1)<=1?"translate("+v+"px, "+g+"px)":"translate3d("+v+"px, "+g+"px, 0)",Y))}return Object.assign({},P,(t={},t[j]=E?g+"px":"",t[C]=x?v+"px":"",t.transform="",t))}function oa(e){var t=e.state,n=e.options,r=n.gpuAcceleration,o=r===void 0?!0:r,s=n.adaptive,i=s===void 0?!0:s,l=n.roundOffsets,c=l===void 0?!0:l,f={placement:Le(t.placement),variation:St(t.placement),popper:t.elements.popper,popperRect:t.rects.popper,gpuAcceleration:o,isFixed:t.options.strategy==="fixed"};t.modifiersData.popperOffsets!=null&&(t.styles.popper=Object.assign({},t.styles.popper,Wr(Object.assign({},f,{offsets:t.modifiersData.popperOffsets,position:t.options.strategy,adaptive:i,roundOffsets:c})))),t.modifiersData.arrow!=null&&(t.styles.arrow=Object.assign({},t.styles.arrow,Wr(Object.assign({},f,{offsets:t.modifiersData.arrow,position:"absolute",adaptive:!1,roundOffsets:c})))),t.attributes.popper=Object.assign({},t.attributes.popper,{"data-popper-placement":t.placement})}const sa={name:"computeStyles",enabled:!0,phase:"beforeWrite",fn:oa,data:{}};var hn={passive:!0};function aa(e){var t=e.state,n=e.instance,r=e.options,o=r.scroll,s=o===void 0?!0:o,i=r.resize,l=i===void 0?!0:i,c=Ce(t.elements.popper),f=[].concat(t.scrollParents.reference,t.scrollParents.popper);return s&&f.forEach(function(d){d.addEventListener("scroll",n.update,hn)}),l&&c.addEventListener("resize",n.update,hn),function(){s&&f.forEach(function(d){d.removeEventListener("scroll",n.update,hn)}),l&&c.removeEventListener("resize",n.update,hn)}}const ia={name:"eventListeners",enabled:!0,phase:"write",fn:function(){},effect:aa,data:{}};var la={left:"right",right:"left",bottom:"top",top:"bottom"};function yn(e){return e.replace(/left|right|bottom|top/g,function(t){return la[t]})}var ca={start:"end",end:"start"};function Br(e){return e.replace(/start|end/g,function(t){return ca[t]})}function fr(e){var t=Ce(e),n=t.pageXOffset,r=t.pageYOffset;return{scrollLeft:n,scrollTop:r}}function mr(e){return Et(nt(e)).left+fr(e).scrollLeft}function da(e,t){var n=Ce(e),r=nt(e),o=n.visualViewport,s=r.clientWidth,i=r.clientHeight,l=0,c=0;if(o){s=o.width,i=o.height;var f=Do();(f||!f&&t==="fixed")&&(l=o.offsetLeft,c=o.offsetTop)}return{width:s,height:i,x:l+mr(e),y:c}}function ua(e){var t,n=nt(e),r=fr(e),o=(t=e.ownerDocument)==null?void 0:t.body,s=ut(n.scrollWidth,n.clientWidth,o?o.scrollWidth:0,o?o.clientWidth:0),i=ut(n.scrollHeight,n.clientHeight,o?o.scrollHeight:0,o?o.clientHeight:0),l=-r.scrollLeft+mr(e),c=-r.scrollTop;return Ve(o||n).direction==="rtl"&&(l+=ut(n.clientWidth,o?o.clientWidth:0)-s),{width:s,height:i,x:l,y:c}}function pr(e){var t=Ve(e),n=t.overflow,r=t.overflowX,o=t.overflowY;return/auto|scroll|overlay|hidden/.test(n+o+r)}function Fo(e){return["html","body","#document"].indexOf(Ye(e))>=0?e.ownerDocument.body:Se(e)&&pr(e)?e:Fo(Mn(e))}function Gt(e,t){var n;t===void 0&&(t=[]);var r=Fo(e),o=r===((n=e.ownerDocument)==null?void 0:n.body),s=Ce(r),i=o?[s].concat(s.visualViewport||[],pr(r)?r:[]):r,l=t.concat(i);return o?l:l.concat(Gt(Mn(i)))}function rr(e){return Object.assign({},e,{left:e.x,top:e.y,right:e.x+e.width,bottom:e.y+e.height})}function fa(e,t){var n=Et(e,!1,t==="fixed");return n.top=n.top+e.clientTop,n.left=n.left+e.clientLeft,n.bottom=n.top+e.clientHeight,n.right=n.left+e.clientWidth,n.width=e.clientWidth,n.height=e.clientHeight,n.x=n.left,n.y=n.top,n}function Hr(e,t,n){return t===ko?rr(da(e,n)):mt(t)?fa(t,n):rr(ua(nt(e)))}function ma(e){var t=Gt(Mn(e)),n=["absolute","fixed"].indexOf(Ve(e).position)>=0,r=n&&Se(e)?sn(e):e;return mt(r)?t.filter(function(o){return mt(o)&&To(o,r)&&Ye(o)!=="body"}):[]}function pa(e,t,n,r){var o=t==="clippingParents"?ma(e):[].concat(t),s=[].concat(o,[n]),i=s[0],l=s.reduce(function(c,f){var d=Hr(e,f,r);return c.top=ut(d.top,c.top),c.right=wn(d.right,c.right),c.bottom=wn(d.bottom,c.bottom),c.left=ut(d.left,c.left),c},Hr(e,i,r));return l.width=l.right-l.left,l.height=l.bottom-l.top,l.x=l.left,l.y=l.top,l}function Ao(e){var t=e.reference,n=e.element,r=e.placement,o=r?Le(r):null,s=r?St(r):null,i=t.x+t.width/2-n.width/2,l=t.y+t.height/2-n.height/2,c;switch(o){case ve:c={x:i,y:t.y-n.height};break;case Oe:c={x:i,y:t.y+t.height};break;case De:c={x:t.x+t.width,y:l};break;case be:c={x:t.x-n.width,y:l};break;default:c={x:t.x,y:t.y}}var f=o?ur(o):null;if(f!=null){var d=f==="y"?"height":"width";switch(s){case Nt:c[f]=c[f]-(t[d]/2-n[d]/2);break;case Jt:c[f]=c[f]+(t[d]/2-n[d]/2);break}}return c}function Zt(e,t){t===void 0&&(t={});var n=t,r=n.placement,o=r===void 0?e.placement:r,s=n.strategy,i=s===void 0?e.strategy:s,l=n.boundary,c=l===void 0?Fs:l,f=n.rootBoundary,d=f===void 0?ko:f,p=n.elementContext,b=p===void 0?Bt:p,v=n.altBoundary,w=v===void 0?!1:v,g=n.padding,h=g===void 0?0:g,x=Mo(typeof h!="number"?h:Po(h,on)),E=b===Bt?As:Bt,C=e.rects.popper,j=e.elements[w?E:b],k=pa(mt(j)?j:j.contextElement||nt(e.elements.popper),c,d,i),O=Et(e.elements.reference),N=Ao({reference:O,element:C,placement:o}),S=rr(Object.assign({},C,N)),R=b===Bt?S:O,F={top:k.top-R.top+x.top,bottom:R.bottom-k.bottom+x.bottom,left:k.left-R.left+x.left,right:R.right-k.right+x.right},P=e.modifiersData.offset;if(b===Bt&&P){var A=P[o];Object.keys(F).forEach(function(Y){var Z=[De,Oe].indexOf(Y)>=0?1:-1,H=[ve,Oe].indexOf(Y)>=0?"y":"x";F[Y]+=A[H]*Z})}return F}function ha(e,t){t===void 0&&(t={});var n=t,r=n.placement,o=n.boundary,s=n.rootBoundary,i=n.padding,l=n.flipVariations,c=n.allowedAutoPlacements,f=c===void 0?Oo:c,d=St(r),p=d?l?Ir:Ir.filter(function(w){return St(w)===d}):on,b=p.filter(function(w){return f.indexOf(w)>=0});b.length===0&&(b=p);var v=b.reduce(function(w,g){return w[g]=Zt(e,{placement:g,boundary:o,rootBoundary:s,padding:i})[Le(g)],w},{});return Object.keys(v).sort(function(w,g){return v[w]-v[g]})}function ga(e){if(Le(e)===lr)return[];var t=yn(e);return[Br(e),t,Br(t)]}function va(e){var t=e.state,n=e.options,r=e.name;if(!t.modifiersData[r]._skip){for(var o=n.mainAxis,s=o===void 0?!0:o,i=n.altAxis,l=i===void 0?!0:i,c=n.fallbackPlacements,f=n.padding,d=n.boundary,p=n.rootBoundary,b=n.altBoundary,v=n.flipVariations,w=v===void 0?!0:v,g=n.allowedAutoPlacements,h=t.options.placement,x=Le(h),E=x===h,C=c||(E||!w?[yn(h)]:ga(h)),j=[h].concat(C).reduce(function($,X){return $.concat(Le(X)===lr?ha(t,{placement:X,boundary:d,rootBoundary:p,padding:f,flipVariations:w,allowedAutoPlacements:g}):X)},[]),k=t.rects.reference,O=t.rects.popper,N=new Map,S=!0,R=j[0],F=0;F<j.length;F++){var P=j[F],A=Le(P),Y=St(P)===Nt,Z=[ve,Oe].indexOf(A)>=0,H=Z?"width":"height",te=Zt(t,{placement:P,boundary:d,rootBoundary:p,altBoundary:b,padding:f}),G=Z?Y?De:be:Y?Oe:ve;k[H]>O[H]&&(G=yn(G));var ie=yn(G),I=[];if(s&&I.push(te[A]<=0),l&&I.push(te[G]<=0,te[ie]<=0),I.every(function($){return $})){R=P,S=!1;break}N.set(P,I)}if(S)for(var L=w?3:1,K=function(X){var T=j.find(function(U){var W=N.get(U);if(W)return W.slice(0,X).every(function(oe){return oe})});if(T)return R=T,"break"},D=L;D>0;D--){var M=K(D);if(M==="break")break}t.placement!==R&&(t.modifiersData[r]._skip=!0,t.placement=R,t.reset=!0)}}const ba={name:"flip",enabled:!0,phase:"main",fn:va,requiresIfExists:["offset"],data:{_skip:!1}};function Vr(e,t,n){return n===void 0&&(n={x:0,y:0}),{top:e.top-t.height-n.y,right:e.right-t.width+n.x,bottom:e.bottom-t.height+n.y,left:e.left-t.width-n.x}}function qr(e){return[ve,De,Oe,be].some(function(t){return e[t]>=0})}function ya(e){var t=e.state,n=e.name,r=t.rects.reference,o=t.rects.popper,s=t.modifiersData.preventOverflow,i=Zt(t,{elementContext:"reference"}),l=Zt(t,{altBoundary:!0}),c=Vr(i,r),f=Vr(l,o,s),d=qr(c),p=qr(f);t.modifiersData[n]={referenceClippingOffsets:c,popperEscapeOffsets:f,isReferenceHidden:d,hasPopperEscaped:p},t.attributes.popper=Object.assign({},t.attributes.popper,{"data-popper-reference-hidden":d,"data-popper-escaped":p})}const xa={name:"hide",enabled:!0,phase:"main",requiresIfExists:["preventOverflow"],fn:ya};function wa(e,t,n){var r=Le(e),o=[be,ve].indexOf(r)>=0?-1:1,s=typeof n=="function"?n(Object.assign({},t,{placement:e})):n,i=s[0],l=s[1];return i=i||0,l=(l||0)*o,[be,De].indexOf(r)>=0?{x:l,y:i}:{x:i,y:l}}function Ca(e){var t=e.state,n=e.options,r=e.name,o=n.offset,s=o===void 0?[0,0]:o,i=Oo.reduce(function(d,p){return d[p]=wa(p,t.rects,s),d},{}),l=i[t.placement],c=l.x,f=l.y;t.modifiersData.popperOffsets!=null&&(t.modifiersData.popperOffsets.x+=c,t.modifiersData.popperOffsets.y+=f),t.modifiersData[r]=i}const Na={name:"offset",enabled:!0,phase:"main",requires:["popperOffsets"],fn:Ca};function ja(e){var t=e.state,n=e.name;t.modifiersData[n]=Ao({reference:t.rects.reference,element:t.rects.popper,placement:t.placement})}const Ea={name:"popperOffsets",enabled:!0,phase:"read",fn:ja,data:{}};function Sa(e){return e==="x"?"y":"x"}function ka(e){var t=e.state,n=e.options,r=e.name,o=n.mainAxis,s=o===void 0?!0:o,i=n.altAxis,l=i===void 0?!1:i,c=n.boundary,f=n.rootBoundary,d=n.altBoundary,p=n.padding,b=n.tether,v=b===void 0?!0:b,w=n.tetherOffset,g=w===void 0?0:w,h=Zt(t,{boundary:c,rootBoundary:f,padding:p,altBoundary:d}),x=Le(t.placement),E=St(t.placement),C=!E,j=ur(x),k=Sa(j),O=t.modifiersData.popperOffsets,N=t.rects.reference,S=t.rects.popper,R=typeof g=="function"?g(Object.assign({},t.rects,{placement:t.placement})):g,F=typeof R=="number"?{mainAxis:R,altAxis:R}:Object.assign({mainAxis:0,altAxis:0},R),P=t.modifiersData.offset?t.modifiersData.offset[t.placement]:null,A={x:0,y:0};if(O){if(s){var Y,Z=j==="y"?ve:be,H=j==="y"?Oe:De,te=j==="y"?"height":"width",G=O[j],ie=G+h[Z],I=G-h[H],L=v?-S[te]/2:0,K=E===Nt?N[te]:S[te],D=E===Nt?-S[te]:-N[te],M=t.elements.arrow,$=v&&M?dr(M):{width:0,height:0},X=t.modifiersData["arrow#persistent"]?t.modifiersData["arrow#persistent"].padding:Ro(),T=X[Z],U=X[H],W=qt(0,N[te],$[te]),oe=C?N[te]/2-L-W-T-F.mainAxis:K-W-T-F.mainAxis,_=C?-N[te]/2+L+W+U+F.mainAxis:D+W+U+F.mainAxis,Ne=t.elements.arrow&&sn(t.elements.arrow),he=Ne?j==="y"?Ne.clientTop||0:Ne.clientLeft||0:0,B=(Y=P?.[j])!=null?Y:0,ee=G+oe-B-he,re=G+_-B,ce=qt(v?wn(ie,ee):ie,G,v?ut(I,re):I);O[j]=ce,A[j]=ce-G}if(l){var Te,Ge=j==="x"?ve:be,$t=j==="x"?Oe:De,ue=O[k],Ie=k==="y"?"height":"width",it=ue+h[Ge],Lt=ue-h[$t],ht=[ve,be].indexOf(x)!==-1,mn=(Te=P?.[k])!=null?Te:0,pn=ht?it:ue-N[Ie]-S[Ie]-mn+F.altAxis,ze=ht?ue+N[Ie]+S[Ie]-mn-F.altAxis:Lt,We=v&&ht?Qs(pn,ue,ze):qt(v?pn:it,ue,v?ze:Lt);O[k]=We,A[k]=We-ue}t.modifiersData[r]=A}}const Oa={name:"preventOverflow",enabled:!0,phase:"main",fn:ka,requiresIfExists:["offset"]};function Da(e){return{scrollLeft:e.scrollLeft,scrollTop:e.scrollTop}}function Ta(e){return e===Ce(e)||!Se(e)?fr(e):Da(e)}function Ra(e){var t=e.getBoundingClientRect(),n=jt(t.width)/e.offsetWidth||1,r=jt(t.height)/e.offsetHeight||1;return n!==1||r!==1}function Ma(e,t,n){n===void 0&&(n=!1);var r=Se(t),o=Se(t)&&Ra(t),s=nt(t),i=Et(e,o,n),l={scrollLeft:0,scrollTop:0},c={x:0,y:0};return(r||!r&&!n)&&((Ye(t)!=="body"||pr(s))&&(l=Ta(t)),Se(t)?(c=Et(t,!0),c.x+=t.clientLeft,c.y+=t.clientTop):s&&(c.x=mr(s))),{x:i.left+l.scrollLeft-c.x,y:i.top+l.scrollTop-c.y,width:i.width,height:i.height}}function Pa(e){var t=new Map,n=new Set,r=[];e.forEach(function(s){t.set(s.name,s)});function o(s){n.add(s.name);var i=[].concat(s.requires||[],s.requiresIfExists||[]);i.forEach(function(l){if(!n.has(l)){var c=t.get(l);c&&o(c)}}),r.push(s)}return e.forEach(function(s){n.has(s.name)||o(s)}),r}function Fa(e){var t=Pa(e);return qs.reduce(function(n,r){return n.concat(t.filter(function(o){return o.phase===r}))},[])}function Aa(e){var t;return function(){return t||(t=new Promise(function(n){Promise.resolve().then(function(){t=void 0,n(e())})})),t}}function $a(e){var t=e.reduce(function(n,r){var o=n[r.name];return n[r.name]=o?Object.assign({},o,r,{options:Object.assign({},o.options,r.options),data:Object.assign({},o.data,r.data)}):r,n},{});return Object.keys(t).map(function(n){return t[n]})}var Gr={placement:"bottom",modifiers:[],strategy:"absolute"};function Xr(){for(var e=arguments.length,t=new Array(e),n=0;n<e;n++)t[n]=arguments[n];return!t.some(function(r){return!(r&&typeof r.getBoundingClientRect=="function")})}function La(e){e===void 0&&(e={});var t=e,n=t.defaultModifiers,r=n===void 0?[]:n,o=t.defaultOptions,s=o===void 0?Gr:o;return function(l,c,f){f===void 0&&(f=s);var d={placement:"bottom",orderedModifiers:[],options:Object.assign({},Gr,s),modifiersData:{},elements:{reference:l,popper:c},attributes:{},styles:{}},p=[],b=!1,v={state:d,setOptions:function(x){var E=typeof x=="function"?x(d.options):x;g(),d.options=Object.assign({},s,d.options,E),d.scrollParents={reference:mt(l)?Gt(l):l.contextElement?Gt(l.contextElement):[],popper:Gt(c)};var C=Fa($a([].concat(r,d.options.modifiers)));return d.orderedModifiers=C.filter(function(j){return j.enabled}),w(),v.update()},forceUpdate:function(){if(!b){var x=d.elements,E=x.reference,C=x.popper;if(Xr(E,C)){d.rects={reference:Ma(E,sn(C),d.options.strategy==="fixed"),popper:dr(C)},d.reset=!1,d.placement=d.options.placement,d.orderedModifiers.forEach(function(F){return d.modifiersData[F.name]=Object.assign({},F.data)});for(var j=0;j<d.orderedModifiers.length;j++){if(d.reset===!0){d.reset=!1,j=-1;continue}var k=d.orderedModifiers[j],O=k.fn,N=k.options,S=N===void 0?{}:N,R=k.name;typeof O=="function"&&(d=O({state:d,options:S,name:R,instance:v})||d)}}}},update:Aa(function(){return new Promise(function(h){v.forceUpdate(),h(d)})}),destroy:function(){g(),b=!0}};if(!Xr(l,c))return v;v.setOptions(f).then(function(h){!b&&f.onFirstUpdate&&f.onFirstUpdate(h)});function w(){d.orderedModifiers.forEach(function(h){var x=h.name,E=h.options,C=E===void 0?{}:E,j=h.effect;if(typeof j=="function"){var k=j({state:d,name:x,instance:v,options:C}),O=function(){};p.push(k||O)}})}function g(){p.forEach(function(h){return h()}),p=[]}return v}}var Ya=[ia,Ea,sa,_s,Na,ba,Oa,ta,xa],Ia=La({defaultModifiers:Ya});const Pn=m.forwardRef((e,t)=>{var{children:n,active:r,as:o="a",className:s,disabled:i}=e,l=V(e,["children","active","as","className","disabled"]);return y.createElement(o,Object.assign({className:z(s,{active:r,disabled:i})},r&&{"aria-current":"page"},o==="a"&&i&&{"aria-disabled":!0,tabIndex:-1},(o==="a"||o==="button")&&{onClick:c=>{c.preventDefault,!i&&l.onClick&&l.onClick(c)}},{disabled:i},l,{ref:t}),n)});Pn.propTypes={active:u.bool,as:u.elementType,children:u.node,className:u.string,disabled:u.bool};Pn.displayName="CLink";const hr=m.forwardRef((e,t)=>{var{className:n="modal-backdrop",visible:r}=e,o=V(e,["className","visible"]);const s=m.useRef(null),i=Ot(t,s);return y.createElement(Eo,{in:r,mountOnEnter:!0,nodeRef:s,timeout:150,unmountOnExit:!0},l=>y.createElement("div",Object.assign({className:z(n,"fade",{show:l==="entered"})},o,{ref:i})))});hr.propTypes={className:u.string,visible:u.bool};hr.displayName="CBackdrop";const gr=m.forwardRef((e,t)=>{var{children:n,as:r="span",className:o,color:s,position:i,shape:l,size:c,textBgColor:f,textColor:d}=e,p=V(e,["children","as","className","color","position","shape","size","textBgColor","textColor"]);return y.createElement(r,Object.assign({className:z("badge",{[`bg-${s}`]:s,"position-absolute translate-middle":i,"top-0":i?.includes("top"),"top-100":i?.includes("bottom"),"start-100":i?.includes("end"),"start-0":i?.includes("start"),[`badge-${c}`]:c,[`text-${d}`]:d,[`text-bg-${f}`]:f},l,o)},p,{ref:t}),n)});gr.propTypes={as:u.elementType,children:u.node,className:u.string,color:ke,position:u.oneOf(["top-start","top-end","bottom-end","bottom-start"]),shape:ks,size:u.oneOf(["sm"]),textBgColor:ke,textColor:Ss};gr.displayName="CBadge";const J=m.forwardRef((e,t)=>{var{children:n,as:r="button",className:o,color:s,shape:i,size:l,type:c="button",variant:f}=e,d=V(e,["children","as","className","color","shape","size","type","variant"]);return y.createElement(Pn,Object.assign({as:d.href?"a":r},!d.href&&{type:c},{className:z("btn",{[`btn-${f}-${s}`]:f&&s,[`btn-${f}`]:f&&!s,[`btn-${s}`]:!f&&s,[`btn-${l}`]:l},i,o)},d,{ref:t}),n)});J.propTypes={as:u.elementType,children:u.node,className:u.string,color:ke,shape:u.string,size:u.oneOf(["sm","lg"]),type:u.oneOf(["button","submit","reset"]),variant:u.oneOf(["outline","ghost"])};J.displayName="CButton";const Dt=m.forwardRef((e,t)=>{var{children:n,className:r,color:o,textBgColor:s,textColor:i}=e,l=V(e,["children","className","color","textBgColor","textColor"]);return y.createElement("div",Object.assign({className:z("card",{[`bg-${o}`]:o,[`text-${i}`]:i,[`text-bg-${s}`]:s},r)},l,{ref:t}),n)});Dt.propTypes={children:u.node,className:u.string,color:ke,textBgColor:ke,textColor:u.string};Dt.displayName="CCard";const Tt=m.forwardRef((e,t)=>{var{children:n,className:r}=e,o=V(e,["children","className"]);return y.createElement("div",Object.assign({className:z("card-body",r)},o,{ref:t}),n)});Tt.propTypes={children:u.node,className:u.string};Tt.displayName="CCardBody";const an=m.forwardRef((e,t)=>{var{children:n,as:r="div",className:o}=e,s=V(e,["children","as","className"]);return y.createElement(r,Object.assign({className:z("card-header",o)},s,{ref:t}),n)});an.propTypes={as:u.elementType,children:u.node,className:u.string};an.displayName="CCardHeader";const za=e=>e?typeof e=="function"?e():e:document.body,kt=({children:e,container:t,portal:n})=>{const[r,o]=m.useState(null);return m.useEffect(()=>{n&&o(za(t)||document.body)},[t,n]),typeof window<"u"&&n&&r?wt.createPortal(e,r):y.createElement(y.Fragment,null,e)};kt.propTypes={children:u.node,container:u.any,portal:u.bool.isRequired};kt.displayName="CConditionalPortal";const vr=m.createContext({}),$o=()=>{const e=m.useRef(void 0),t=m.useRef(null),n=(s,i,l)=>{e.current=Ia(s,i,l),t.current=i},r=()=>{const s=e.current;s&&t.current&&s.destroy(),e.current=void 0},o=s=>{const i=e.current;i&&s&&i.setOptions(s),i&&i.update()};return{popper:e.current,initPopper:n,destroyPopper:r,updatePopper:o}},Wa=(e,t,n,r)=>{const o=e.length;let s=e.indexOf(t);return s===-1?!n&&r?e[o-1]:e[0]:(s+=n?1:-1,s=(s+o)%o,e[Math.max(0,Math.min(s,o-1))])},or=e=>typeof document<"u"&&document.documentElement.dir==="rtl"?!0:e?e.closest('[dir="rtl"]')!==null:!1,Ba=e=>{const t=[];if(typeof e=="object")for(const n in e)t.push(`dropdown-menu${n==="xs"?"":`-${n}`}-${e[n]}`);return typeof e=="string"&&t.push(`dropdown-menu-${e}`),t},Ha=(e,t,n,r)=>{let o=e;return t==="dropup"&&(o=r?"top-end":"top-start"),t==="dropup-center"&&(o="top"),t==="dropend"&&(o=r?"left-start":"right-start"),t==="dropstart"&&(o=r?"right-start":"left-start"),n==="end"&&(o=r?"bottom-start":"bottom-end"),o},_r=(e,t,n)=>e==="parent"?n.current:e instanceof HTMLElement?e:e instanceof Object&&"current"in e?e.current:t,gn=e=>{const t=["a[href]","button:not([disabled])","input:not([disabled])","textarea:not([disabled])","select:not([disabled])","details",'[tabindex]:not([tabindex="-1"])','[contenteditable="true"]'].join(",");return[...e.querySelectorAll(t)].filter(r=>!qa(r)&&Xa(r))},Va=e=>{var t,n,r;if(Number((r=(n=(t=y.version)===null||t===void 0?void 0:t.split)===null||n===void 0?void 0:n.call(t,".")[0])!==null&&r!==void 0?r:18)<=18&&"ref"in e&&e.ref!==void 0)return e.ref;if(e.props&&typeof e.props=="object"&&"ref"in e.props)return e.props.ref},qa=e=>!e||e.nodeType!==Node.ELEMENT_NODE||e.classList.contains("disabled")?!0:"disabled"in e&&typeof e.disabled=="boolean"?e.disabled:e.hasAttribute("disabled")&&e.getAttribute("disabled")!=="false",Ga=e=>!e||typeof e!="object"?!1:"nodeType"in e&&typeof e.nodeType=="number",Xa=e=>{if(!Ga(e)||e.getClientRects().length===0)return!1;const t=getComputedStyle(e).getPropertyValue("visibility")==="visible",n=e.closest("details:not([open])");if(!n)return t;if(n!==e){const r=e.closest("summary");if(r?.parentNode!==n)return!1}return t},_a=(...e)=>t=>{e.forEach(n=>{if(n)if(typeof n=="function")n(t);else try{n.current=t}catch{}})},Lo=({active:e=!0,additionalContainer:t,children:n,focusFirstElement:r=!1,onActivate:o,onDeactivate:s,restoreFocus:i=!0})=>{const l=m.useRef(null),c=m.useRef(null),f=m.useRef(!1),d=m.useRef("forward"),p=m.useRef(null);m.useEffect(()=>{var g;const h=l.current,x=t?.current||null;if(!e||!h){f.current&&(i&&(!((g=c.current)===null||g===void 0)&&g.isConnected)&&c.current.focus({preventScroll:!0}),s?.(),f.current=!1,c.current=null);return}if(c.current=document.activeElement,f.current=!0,r){const j=gn(h);j.length>0?j[0].focus({preventScroll:!0}):h.focus({preventScroll:!0})}else h.focus({preventScroll:!0});o?.();const E=j=>{var k;if(l.current!==p.current)return;const O=j.target;if(O===document||O===h||h.contains(O)||x&&(O===x||x.contains(O)))return;const N=gn(h);if(N.length===0){h.focus({preventScroll:!0});return}d.current==="backward"?(k=N.at(-1))===null||k===void 0||k.focus({preventScroll:!0}):N[0].focus({preventScroll:!0})},C=j=>{var k,O;if(j.key!=="Tab")return;p.current=h,d.current=j.shiftKey?"backward":"forward";const N=gn(h),S=x?gn(x):[];if(N.length===0&&S.length===0){j.preventDefault();return}const R=[...N,...S],F=R[0],P=R.at(-1),A=document.activeElement;if(j.shiftKey&&A===F){j.preventDefault(),P.focus();return}if(!j.shiftKey&&A===P){j.preventDefault(),F.focus();return}if(!x)return;const Y=N.includes(A),Z=S.includes(A);if(Y){const H=N.indexOf(A);!j.shiftKey&&H===N.length-1&&S.length>0?(j.preventDefault(),S[0].focus({preventScroll:!0})):j.shiftKey&&H===0&&S.length>0&&(j.preventDefault(),(k=S.at(-1))===null||k===void 0||k.focus({preventScroll:!0}))}else if(Z){const H=S.indexOf(A);!j.shiftKey&&H===S.length-1&&N.length>0?(j.preventDefault(),N[0].focus({preventScroll:!0})):j.shiftKey&&H===0&&N.length>0&&(j.preventDefault(),(O=N.at(-1))===null||O===void 0||O.focus({preventScroll:!0}))}};return h.addEventListener("keydown",C,!0),x&&x.addEventListener("keydown",C,!0),document.addEventListener("focusin",E,!0),()=>{var j;h.removeEventListener("keydown",C,!0),x&&x.removeEventListener("keydown",C,!0),document.removeEventListener("focusin",E,!0),i&&(!((j=c.current)===null||j===void 0)&&j.isConnected)&&c.current.focus({preventScroll:!0}),f.current&&(s?.(),f.current=!1),c.current=null}},[e,t,r,o,s,i]);const b=y.Children.only(n),v=Va(b),w=_a(v,g=>{l.current=g});return m.cloneElement(b,{ref:w})},Fn=m.forwardRef((e,t)=>{var{children:n,alignment:r,as:o="div",autoClose:s=!0,className:i,container:l,dark:c,direction:f,offset:d=[0,2],onHide:p,onShow:b,placement:v="bottom-start",popper:w=!0,popperConfig:g,portal:h=!1,reference:x="toggle",variant:E="btn-group",visible:C=!1}=e,j=V(e,["children","alignment","as","autoClose","className","container","dark","direction","offset","onHide","onShow","placement","popper","popperConfig","portal","reference","variant","visible"]);const k=m.useRef(null),O=m.useRef(null),N=Ot(t,k),[S,R]=m.useState(null),[F,P]=m.useState(null),[A,Y]=m.useState(C),{initPopper:Z,destroyPopper:H}=$o(),te=m.useCallback(T=>{T&&R(T)},[]),G=w&&typeof r!="object",ie=E==="nav-item"?"li":o,I=m.useMemo(()=>{const T={modifiers:[{name:"offset",options:{offset:d}}],placement:Ha(v,f,r,or(O.current))};return Object.assign(Object.assign({},T),typeof g=="function"?g(T):g)},[d,v,f,r,g]);m.useEffect(()=>{C?$():L()},[C]),m.useEffect(()=>()=>{A&&L()},[]),m.useEffect(()=>{const T=_r(x,S,k),U=O.current;G&&U&&T&&A&&Z(T,U,I)},[S,x]),m.useEffect(()=>{F!==null&&(K(F),P(null))},[F]);const L=m.useCallback(()=>{Y(!1);const T=O.current,U=S;G&&H(),T?.removeEventListener("keydown",K),U?.removeEventListener("keydown",K),window.removeEventListener("click",M),window.removeEventListener("keyup",D),p?.()},[G,S,H,p]),K=m.useCallback(T=>{if(O.current&&(T.key==="ArrowDown"||T.key==="ArrowUp")){T.preventDefault();const U=T.target,W=[...O.current.querySelectorAll(".dropdown-item:not(.disabled):not(:disabled)")];Wa(W,U,T.key==="ArrowDown",!0).focus()}},[]),D=m.useCallback(T=>{s!==!1&&T.key==="Escape"&&(L(),S?.focus())},[s,S,L]),M=m.useCallback(T=>{if(!S||!O.current||T.button===2)return;const U=T.composedPath(),W=U.includes(S),oe=U.includes(O.current);if(W)return;const _=T.target;oe&&_&&/^(input|select|option|textarea|form|button|label)$/i.test(_.tagName)||(s===!0||s==="inside"&&oe||s==="outside"&&!oe)&&L()},[s,S,L]),$=m.useCallback(T=>{const U=O.current,W=_r(x,S,k),oe=S;U&&W&&oe&&(Y(!0),G&&Z(W,U,I),oe.focus(),oe.addEventListener("keydown",K),U.addEventListener("keydown",K),window.addEventListener("click",M),window.addEventListener("keyup",D),T&&(T.key==="ArrowDown"||T.key==="ArrowUp")&&P(T),b?.())},[G,I,S,x,M,K,D,Z,b]),X=m.useMemo(()=>({alignment:r,container:l,dark:c,dropdownMenuRef:O,dropdownToggleRef:te,handleHide:L,handleShow:$,popper:G,portal:h,variant:E,visible:A}),[r,l,c,O,te,L,$,G,h,E,A]);return y.createElement(vr.Provider,{value:X},y.createElement(Lo,{active:h&&A,additionalContainer:O,restoreFocus:!0},E==="input-group"?y.createElement(y.Fragment,null,n):y.createElement(ie,Object.assign({className:z(E==="nav-item"?"nav-item dropdown":E,{"dropdown-center":f==="center","dropup dropup-center":f==="dropup-center",[`${f}`]:f&&f!=="center"&&f!=="dropup-center"},i)},j,{ref:N}),n)))}),lt=u.oneOf(["start","end"]);Fn.propTypes={alignment:u.oneOfType([lt,u.shape({xs:lt.isRequired}),u.shape({sm:lt.isRequired}),u.shape({md:lt.isRequired}),u.shape({lg:lt.isRequired}),u.shape({xl:lt.isRequired}),u.shape({xxl:lt.isRequired})]),as:u.elementType,autoClose:u.oneOfType([u.bool,u.oneOf(["inside","outside"])]),children:u.node,className:u.string,dark:u.bool,direction:u.oneOf(["center","dropup","dropup-center","dropend","dropstart"]),offset:u.any,onHide:u.func,onShow:u.func,placement:Os,popper:u.bool,popperConfig:u.oneOfType([u.func,u.object]),portal:u.bool,variant:u.oneOf(["btn-group","dropdown","input-group","nav-item"]),visible:u.bool};Fn.displayName="CDropdown";const Ze=m.forwardRef((e,t)=>{var{children:n,as:r="a",className:o}=e,s=V(e,["children","as","className"]);return y.createElement(Pn,Object.assign({className:z("dropdown-item",o),as:r},s,{ref:t}),n)});Ze.propTypes={as:u.elementType,children:u.node,className:u.string};Ze.displayName="CDropdownItem";const An=m.forwardRef((e,t)=>{var{children:n,as:r="ul",className:o}=e,s=V(e,["children","as","className"]);const{alignment:i,container:l,dark:c,dropdownMenuRef:f,popper:d,portal:p,visible:b}=m.useContext(vr),v=Ot(t,f);return y.createElement(kt,{container:l,portal:p??!1},y.createElement(r,Object.assign({className:z("dropdown-menu",{show:b},i&&Ba(i),o),ref:v,role:"menu"},!d&&{"data-coreui-popper":"static"},c&&{"data-coreui-theme":"dark"},s),r==="ul"?y.Children.map(n,(w,g)=>{if(y.isValidElement(w))return y.createElement("li",{key:g},y.cloneElement(w))}):n))});An.propTypes={as:u.elementType,children:u.node,className:u.string};An.displayName="CDropdownMenu";const $n=e=>{var{children:t,caret:n=!0,custom:r,className:o,navLink:s=!0,split:i,splitLabel:l="Toggle Dropdown",trigger:c="click"}=e,f=V(e,["children","caret","custom","className","navLink","split","splitLabel","trigger"]);const{dropdownToggleRef:d,handleHide:p,handleShow:b,variant:v,visible:w}=m.useContext(vr),g=Object.assign(Object.assign(Object.assign({},(c==="click"||c.includes("click"))&&{onClick:x=>{x.preventDefault(),w?p?.():b?.()}}),(c==="focus"||c.includes("focus"))&&{onFocus:()=>b?.(),onBlur:()=>p?.()}),{onKeyDown:x=>{(x.key==="ArrowDown"||x.key==="ArrowUp")&&(x.preventDefault(),b?.(x.nativeEvent))}}),h=Object.assign({className:z({"nav-link":v==="nav-item"&&s,"dropdown-toggle":n,"dropdown-toggle-split":i,show:w},o),"aria-expanded":w},!f.disabled&&Object.assign({},g));return r&&y.isValidElement(t)?y.createElement(y.Fragment,null,y.cloneElement(t,Object.assign(Object.assign({"aria-expanded":w},!f.disabled&&Object.assign({},g)),{ref:d}))):v==="nav-item"&&s?y.createElement("a",Object.assign({href:"#"},h,{role:"button"},f,{ref:d}),t):y.createElement(J,Object.assign({},h,{tabIndex:0},f,{ref:d}),t,i&&y.createElement("span",{className:"visually-hidden"},l))};$n.propTypes={caret:u.bool,children:u.node,className:u.string,custom:u.bool,split:u.bool,splitLabel:u.string,trigger:So};$n.displayName="CDropdownToggle";const Xt=m.forwardRef((e,t)=>{var{children:n,as:r="div",className:o,invalid:s,tooltip:i,valid:l}=e,c=V(e,["children","as","className","invalid","tooltip","valid"]);return y.createElement(r,Object.assign({className:z({[`invalid-${i?"tooltip":"feedback"}`]:s,[`valid-${i?"tooltip":"feedback"}`]:l},o)},c,{ref:t}),n)});Xt.propTypes={as:u.elementType,children:u.node,className:u.string,invalid:u.bool,tooltip:u.bool,valid:u.bool};Xt.displayName="CFormFeedback";const Rt=({describedby:e,feedback:t,feedbackInvalid:n,feedbackValid:r,invalid:o,tooltipFeedback:s,valid:i})=>y.createElement(y.Fragment,null,t&&(i||o)&&y.createElement(Xt,Object.assign({},o&&{id:e},{invalid:o,tooltip:s,valid:i}),t),n&&y.createElement(Xt,{id:e,invalid:!0,tooltip:s},n),r&&y.createElement(Xt,{valid:!0,tooltip:s},r));Rt.propTypes={describedby:u.string,feedback:u.oneOfType([u.node,u.string]),feedbackValid:u.oneOfType([u.node,u.string]),feedbackInvalid:u.oneOfType([u.node,u.string]),invalid:u.bool,tooltipFeedback:u.bool,valid:u.bool};Rt.displayName="CFormControlValidation";const q=m.forwardRef((e,t)=>{var{children:n,className:r,customClassName:o}=e,s=V(e,["children","className","customClassName"]);return y.createElement("label",Object.assign({className:o??z("form-label",r)},s,{ref:t}),n)});q.propTypes={children:u.node,className:u.string,customClassName:u.string};q.displayName="CFormLabel";const qe=m.forwardRef((e,t)=>{var{className:n,button:r,feedback:o,feedbackInvalid:s,feedbackValid:i,floatingLabel:l,tooltipFeedback:c,hitArea:f,id:d,indeterminate:p,inline:b,invalid:v,label:w,reverse:g,type:h="checkbox",valid:x}=e,E=V(e,["className","button","feedback","feedbackInvalid","feedbackValid","floatingLabel","tooltipFeedback","hitArea","id","indeterminate","inline","invalid","label","reverse","type","valid"]);const C=m.useRef(null),j=Ot(t,C);m.useEffect(()=>{C.current&&p&&(C.current.indeterminate=p)},[p,C.current]);const k=()=>y.createElement("input",Object.assign({type:h,className:z(r?"btn-check":"form-check-input",{"is-invalid":v,"is-valid":x,"me-2":f}),id:d},E,{ref:j})),O=()=>y.createElement(Rt,{describedby:E["aria-describedby"],feedback:o,feedbackInvalid:s,feedbackValid:i,floatingLabel:l,invalid:v,tooltipFeedback:c,valid:x}),N=()=>y.createElement(q,Object.assign({customClassName:z(r?z("btn",r.variant?`btn-${r.variant}-${r.color}`:`btn-${r.color}`,{[`btn-${r.size}`]:r.size},`${r.shape}`):"form-check-label")},d&&{htmlFor:d}),w),S=()=>r?y.createElement(y.Fragment,null,y.createElement(k,null),w&&y.createElement(N,null),y.createElement(O,null)):w?f?y.createElement(y.Fragment,null,y.createElement(k,null),y.createElement(q,Object.assign({customClassName:z("form-check-label stretched-link",n)},d&&{htmlFor:d}),w),y.createElement(O,null)):y.createElement("div",{className:z("form-check",{"form-check-inline":b,"form-check-reverse":g,"is-invalid":v,"is-valid":x},n)},y.createElement(k,null),y.createElement(N,null),y.createElement(O,null)):y.createElement(k,null);return y.createElement(S,null)});qe.propTypes=Object.assign({button:u.object,className:u.string,hitArea:u.oneOf(["full"]),id:u.string,indeterminate:u.bool,inline:u.bool,label:u.oneOfType([u.string,u.node]),reverse:u.bool,type:u.oneOf(["checkbox","radio"])},Rt.propTypes);qe.displayName="CFormCheck";const br=m.forwardRef((e,t)=>{var{children:n,className:r}=e,o=V(e,["children","className"]);return y.createElement("div",Object.assign({className:z("form-floating",r)},o,{ref:t}),n)});br.propTypes={children:u.node,className:u.string};br.displayName="CFormFloating";const Cn=m.forwardRef((e,t)=>{var{children:n,as:r="div",className:o}=e,s=V(e,["children","as","className"]);return y.createElement(r,Object.assign({className:z("form-text",o)},s,{ref:t}),n)});Cn.propTypes={as:u.elementType,children:u.node,className:u.string};Cn.displayName="CFormText";const Mt=({children:e,describedby:t,feedback:n,feedbackInvalid:r,feedbackValid:o,floatingClassName:s,floatingLabel:i,id:l,invalid:c,label:f,text:d,tooltipFeedback:p,valid:b})=>{const v=()=>y.createElement(Rt,{describedby:t,feedback:n,feedbackInvalid:r,feedbackValid:o,floatingLabel:i,invalid:c,tooltipFeedback:p,valid:b});return i?y.createElement(br,{className:s},e,y.createElement(q,{htmlFor:l},f||i),d&&y.createElement(Cn,{id:t},d),y.createElement(v,null)):y.createElement(y.Fragment,null,f&&y.createElement(q,{htmlFor:l},f),e,d&&y.createElement(Cn,{id:t},d),y.createElement(v,null))};Mt.propTypes=Object.assign({children:u.node,floatingClassName:u.string,floatingLabel:u.oneOfType([u.node,u.string]),label:u.oneOfType([u.node,u.string]),text:u.oneOfType([u.node,u.string])},Rt.propTypes);Mt.displayName="CFormControlWrapper";const ge=m.forwardRef((e,t)=>{var{children:n,className:r,delay:o=!1,feedback:s,feedbackInvalid:i,feedbackValid:l,floatingClassName:c,floatingLabel:f,id:d,invalid:p,label:b,onChange:v,plainText:w,size:g,text:h,tooltipFeedback:x,type:E="text",valid:C}=e,j=V(e,["children","className","delay","feedback","feedbackInvalid","feedbackValid","floatingClassName","floatingLabel","id","invalid","label","onChange","plainText","size","text","tooltipFeedback","type","valid"]);const[k,O]=m.useState();return m.useEffect(()=>{const N=setTimeout(()=>k&&v&&v(k),typeof o=="number"?o:500);return()=>clearTimeout(N)},[k]),y.createElement(Mt,{describedby:j["aria-describedby"],feedback:s,feedbackInvalid:i,feedbackValid:l,floatingClassName:c,floatingLabel:f,id:d,invalid:p,label:b,text:h,tooltipFeedback:x,valid:C},y.createElement("input",Object.assign({className:z(w?"form-control-plaintext":"form-control",{[`form-control-${g}`]:g,"form-control-color":E==="color","is-invalid":p,"is-valid":C},r),id:d,type:E,onChange:N=>o?O(N):v&&v(N)},j,{ref:t}),n))});ge.propTypes=Object.assign({className:u.string,id:u.string,delay:u.oneOfType([u.bool,u.number]),plainText:u.bool,size:u.oneOf(["sm","lg"]),type:u.oneOfType([u.oneOf(["color","file","text"]),u.string])},Mt.propTypes);ge.displayName="CFormInput";const ae=m.forwardRef((e,t)=>{var{children:n,className:r,feedback:o,feedbackInvalid:s,feedbackValid:i,floatingClassName:l,floatingLabel:c,htmlSize:f,id:d,invalid:p,label:b,options:v,size:w,text:g,tooltipFeedback:h,valid:x}=e,E=V(e,["children","className","feedback","feedbackInvalid","feedbackValid","floatingClassName","floatingLabel","htmlSize","id","invalid","label","options","size","text","tooltipFeedback","valid"]);return y.createElement(Mt,{describedby:E["aria-describedby"],feedback:o,feedbackInvalid:s,feedbackValid:i,floatingClassName:l,floatingLabel:c,id:d,invalid:p,label:b,text:g,tooltipFeedback:h,valid:x},y.createElement("select",Object.assign({id:d,className:z("form-select",{[`form-select-${w}`]:w,"is-invalid":p,"is-valid":x},r),size:f},E,{ref:t}),v?v.map((C,j)=>y.createElement("option",Object.assign({},typeof C=="object"&&C.disabled&&{disabled:C.disabled},typeof C=="object"&&C.value!==void 0&&{value:C.value},{key:j}),typeof C=="string"?C:C.label)):n))});ae.propTypes=Object.assign({className:u.string,htmlSize:u.number,options:u.array},Mt.propTypes);ae.displayName="CFormSelect";const _t=m.forwardRef((e,t)=>{var{className:n,id:r,invalid:o,label:s,reverse:i,size:l,type:c="checkbox",valid:f}=e,d=V(e,["className","id","invalid","label","reverse","size","type","valid"]);return y.createElement("div",{className:z("form-check form-switch",{"form-check-reverse":i,[`form-switch-${l}`]:l,"is-invalid":o,"is-valid":f},n)},y.createElement("input",Object.assign({type:c,className:z("form-check-input",{"is-invalid":o,"is-valid":f}),id:r},d,{ref:t})),s&&y.createElement(q,Object.assign({customClassName:"form-check-label"},r&&{htmlFor:r}),s))});_t.propTypes={className:u.string,id:u.string,invalid:u.bool,label:u.oneOfType([u.string,u.node]),reverse:u.bool,size:u.oneOf(["lg","xl"]),type:u.oneOf(["checkbox","radio"]),valid:u.bool};_t.displayName="CFormSwitch";const Ka=["xxl","xl","lg","md","sm","xs"],He=m.forwardRef((e,t)=>{var{children:n,className:r}=e,o=V(e,["children","className"]);const s=[];return Ka.forEach(i=>{const l=o[i];delete o[i];const c=i==="xs"?"":`-${i}`;(typeof l=="number"||typeof l=="string")&&s.push(`col${c}-${l}`),typeof l=="boolean"&&s.push(`col${c}`),l&&typeof l=="object"&&((typeof l.span=="number"||typeof l.span=="string")&&s.push(`col${c}-${l.span}`),typeof l.span=="boolean"&&s.push(`col${c}`),(typeof l.order=="number"||typeof l.order=="string")&&s.push(`order${c}-${l.order}`),typeof l.offset=="number"&&s.push(`offset${c}-${l.offset}`))}),y.createElement("div",Object.assign({className:z(s.length>0?s:"col",r)},o,{ref:t}),n)}),Kr=u.oneOfType([u.bool,u.number,u.string,u.oneOf(["auto"])]),vt=u.oneOfType([Kr,u.shape({span:Kr,offset:u.oneOfType([u.number,u.string]),order:u.oneOfType([u.oneOf(["first","last"]),u.number,u.string])})]);He.propTypes={children:u.node,className:u.string,xs:vt,sm:vt,md:vt,lg:vt,xl:vt,xxl:vt};He.displayName="CCol";const Ua=["xxl","xl","lg","md","sm","fluid"],yr=m.forwardRef((e,t)=>{var{children:n,className:r}=e,o=V(e,["children","className"]);const s=[];return Ua.forEach(i=>{const l=o[i];delete o[i],l&&s.push(`container-${i}`)}),y.createElement("div",Object.assign({className:z(s.length>0?s:"container",r)},o,{ref:t}),n)});yr.propTypes={children:u.node,className:u.string,sm:u.bool,md:u.bool,lg:u.bool,xl:u.bool,xxl:u.bool,fluid:u.bool};yr.displayName="CContainer";const Qa=["xxl","xl","lg","md","sm","xs"],Ln=m.forwardRef((e,t)=>{var{children:n,className:r}=e,o=V(e,["children","className"]);const s=[];return Qa.forEach(i=>{const l=o[i];delete o[i];const c=i==="xs"?"":`-${i}`;typeof l=="object"&&(l.cols&&s.push(`row-cols${c}-${l.cols}`),typeof l.gutter=="number"&&s.push(`g${c}-${l.gutter}`),typeof l.gutterX=="number"&&s.push(`gx${c}-${l.gutterX}`),typeof l.gutterY=="number"&&s.push(`gy${c}-${l.gutterY}`))}),y.createElement("div",Object.assign({className:z("row",s,r)},o,{ref:t}),n)}),bt=u.shape({cols:u.oneOfType([u.oneOf(["auto"]),u.number,u.string]),gutter:u.oneOfType([u.string,u.number]),gutterX:u.oneOfType([u.string,u.number]),gutterY:u.oneOfType([u.string,u.number])});Ln.propTypes={children:u.node,className:u.string,xs:bt,sm:bt,md:bt,lg:bt,xl:bt,xxl:bt};Ln.displayName="CRow";const xr=m.forwardRef((e,t)=>{var{children:n,className:r}=e,o=V(e,["children","className"]);return y.createElement("div",Object.assign({className:z("modal-content",r)},o,{ref:t}),n)});xr.propTypes={children:u.node,className:u.string};xr.displayName="CModalContent";const Yo=m.createContext({}),wr=m.forwardRef((e,t)=>{var{children:n,alignment:r,className:o,fullscreen:s,scrollable:i,size:l}=e,c=V(e,["children","alignment","className","fullscreen","scrollable","size"]);return y.createElement("div",Object.assign({className:z("modal-dialog",{"modal-dialog-centered":r==="center",[typeof s=="boolean"?"modal-fullscreen":`modal-fullscreen-${s}-down`]:s,"modal-dialog-scrollable":i,[`modal-${l}`]:l},o)},c,{ref:t}),n)});wr.propTypes={alignment:u.oneOf(["top","center"]),children:u.node,className:u.string,fullscreen:u.oneOfType([u.bool,u.oneOf(["sm","md","lg","xl","xxl"])]),scrollable:u.bool,size:u.oneOf(["sm","lg","xl"])};wr.displayName="CModalDialog";const rt=m.forwardRef((e,t)=>{var{children:n,alignment:r,backdrop:o=!0,className:s,container:i,duration:l=150,focus:c=!0,fullscreen:f,keyboard:d=!0,onClose:p,onClosePrevented:b,onShow:v,portal:w=!0,scrollable:g,size:h,transition:x=!0,unmountOnClose:E=!0,visible:C}=e,j=V(e,["children","alignment","backdrop","className","container","duration","focus","fullscreen","keyboard","onClose","onClosePrevented","onShow","portal","scrollable","size","transition","unmountOnClose","visible"]);const k=m.useRef(null),O=Ot(t,k),[N,S]=m.useState(C),[R,F]=m.useState(!1),P={visible:N,setVisible:S};m.useEffect(()=>{S(C)},[C]),m.useEffect(()=>(N&&(document.addEventListener("mouseup",Y),document.addEventListener("keydown",Z)),()=>{document.removeEventListener("mouseup",Y),document.removeEventListener("keydown",Z)}),[N]);const A=()=>{if(o==="static")return F(!0);S(!1)};m.useLayoutEffect(()=>{b?.(),setTimeout(()=>F(!1),l)},[R]),m.useLayoutEffect(()=>(N?(document.body.classList.add("modal-open"),o&&(document.body.style.overflow="hidden",document.body.style.paddingRight="0px")):(document.body.classList.remove("modal-open"),o&&(document.body.style.removeProperty("overflow"),document.body.style.removeProperty("padding-right"))),()=>{document.body.classList.remove("modal-open"),o&&(document.body.style.removeProperty("overflow"),document.body.style.removeProperty("padding-right"))}),[N]);const Y=H=>{k.current&&k.current==H.target&&A()},Z=H=>{H.key==="Escape"&&d&&A()};return y.createElement(y.Fragment,null,y.createElement(Eo,{in:N,mountOnEnter:!0,nodeRef:k,onEnter:v,onExit:p,unmountOnExit:E,timeout:x?l:0},H=>y.createElement(kt,{container:i,portal:w},y.createElement(Yo.Provider,{value:P},y.createElement(Lo,{active:c&&H==="entered"},y.createElement("div",Object.assign({className:z("modal",{"modal-static":R,fade:x,show:H==="entered"},s),tabIndex:-1},N?{"aria-modal":!0,role:"dialog"}:{"aria-hidden":"true"},{style:Object.assign({},H!=="exited"&&{display:"block"})},j,{ref:O}),y.createElement(wr,{alignment:r,fullscreen:f,scrollable:g,size:h},y.createElement(xr,null,n))))))),o&&y.createElement(kt,{container:i,portal:w},y.createElement(hr,{visible:N})))});rt.propTypes={alignment:u.oneOf(["top","center"]),backdrop:u.oneOfType([u.bool,u.oneOf(["static"])]),children:u.node,className:u.string,container:u.any,duration:u.number,focus:u.bool,fullscreen:u.oneOfType([u.bool,u.oneOf(["sm","md","lg","xl","xxl"])]),keyboard:u.bool,onClose:u.func,onClosePrevented:u.func,onShow:u.func,portal:u.bool,scrollable:u.bool,size:u.oneOf(["sm","lg","xl"]),transition:u.bool,unmountOnClose:u.bool,visible:u.bool};rt.displayName="CModal";const ot=m.forwardRef((e,t)=>{var{children:n,className:r}=e,o=V(e,["children","className"]);return y.createElement("div",Object.assign({className:z("modal-body",r)},o,{ref:t}),n)});ot.propTypes={children:u.node,className:u.string};ot.displayName="CModalBody";const pt=m.forwardRef((e,t)=>{var{children:n,className:r}=e,o=V(e,["children","className"]);return y.createElement("div",Object.assign({className:z("modal-footer",r)},o,{ref:t}),n)});pt.propTypes={children:u.node,className:u.string};pt.displayName="CModalFooter";const st=m.forwardRef((e,t)=>{var{children:n,className:r,closeButton:o=!0}=e,s=V(e,["children","className","closeButton"]);const{setVisible:i}=m.useContext(Yo);return y.createElement("div",Object.assign({className:z("modal-header",r)},s,{ref:t}),n,o&&y.createElement(Ds,{onClick:()=>i(!1)}))});st.propTypes={children:u.node,className:u.string,closeButton:u.bool};st.displayName="CModalHeader";const at=m.forwardRef((e,t)=>{var{children:n,as:r="h5",className:o}=e,s=V(e,["children","as","className"]);return y.createElement(r,Object.assign({className:z("modal-title",o)},s,{ref:t}),n)});at.propTypes={as:u.elementType,children:u.node,className:u.string};at.displayName="CModalTitle";const Ja=e=>{if(!e)return 0;let{transitionDuration:t,transitionDelay:n}=window.getComputedStyle(e);const r=Number.parseFloat(t),o=Number.parseFloat(n);return!r&&!o?0:(t=t.split(",")[0],n=n.split(",")[0],(Number.parseFloat(t)+Number.parseFloat(n))*1e3)},Ur=e=>{typeof e=="function"&&e()},Za=e=>{e.dispatchEvent(new Event("transitionend"))},ei=(e,t,n=!0)=>{if(!n){Ur(e);return}const o=Ja(t)+5;let s=!1;const i=({target:l})=>{l===t&&(s=!0,t.removeEventListener("transitionend",i),Ur(e))};t.addEventListener("transitionend",i),setTimeout(()=>{s||Za(t)},o)},ti=(e,t)=>{switch(e){case"right":return or(t)?"left":"right";case"left":return or(t)?"right":"left";default:return e}},ln=m.forwardRef((e,t)=>{var{children:n,className:r,color:o}=e,s=V(e,["children","className","color"]);return y.createElement("thead",Object.assign({className:z({[`table-${o}`]:o},r)||void 0},s,{ref:t}),n)});ln.propTypes={children:u.node,className:u.string,color:ke};ln.displayName="CTableHead";const dt=m.forwardRef((e,t)=>{var{children:n,className:r,color:o}=e,s=V(e,["children","className","color"]);return y.createElement("th",Object.assign({className:z({[`table-${o}`]:o},r)||void 0},s,{ref:t}),n)});dt.propTypes={children:u.node,className:u.string,color:ke};dt.displayName="CTableHeaderCell";const Yn=m.forwardRef((e,t)=>{var{children:n,className:r,color:o}=e,s=V(e,["children","className","color"]);return y.createElement("tbody",Object.assign({className:z({[`table-${o}`]:o},r)||void 0},s,{ref:t}),n)});Yn.propTypes={children:u.node,className:u.string,color:ke};Yn.displayName="CTableBody";const ft=m.forwardRef((e,t)=>{var{children:n,active:r,align:o,className:s,color:i}=e,l=V(e,["children","active","align","className","color"]);const c=l.scope?"th":"td";return y.createElement(c,Object.assign({className:z({[`align-${o}`]:o,"table-active":r,[`table-${i}`]:i},s)||void 0},l,{ref:t}),n)});ft.propTypes={active:u.bool,align:u.oneOf(["bottom","middle","top"]),children:u.node,className:u.string,color:ke};ft.displayName="CTableDataCell";const $e=m.forwardRef((e,t)=>{var{children:n,active:r,align:o,className:s,color:i}=e,l=V(e,["children","active","align","className","color"]);return y.createElement("tr",Object.assign({className:z({[`align-${o}`]:o,"table-active":r,[`table-${i}`]:i},s)||void 0},l,{ref:t}),n)});$e.propTypes={active:u.bool,align:u.oneOf(["bottom","middle","top"]),children:u.node,className:u.string,color:ke};$e.displayName="CTableRow";const In=m.forwardRef((e,t)=>{var{children:n,className:r,color:o}=e,s=V(e,["children","className","color"]);return y.createElement("tfoot",Object.assign({className:z({[`table-${o}`]:o},r)||void 0},s,{ref:t}),n)});In.propTypes={children:u.node,className:u.string,color:ke};In.displayName="CTableFoot";const Cr=m.forwardRef((e,t)=>{var{children:n}=e,r=V(e,["children"]);return y.createElement("caption",Object.assign({},r,{ref:t}),n)});Cr.propTypes={children:u.node};Cr.displayName="CTableCaption";const Nr=e=>{var{children:t,responsive:n}=e,r=V(e,["children","responsive"]);return n?y.createElement("div",Object.assign({className:typeof n=="boolean"?"table-responsive":`table-responsive-${n}`},r),t):y.createElement(y.Fragment,null,t)};Nr.propTypes={children:u.node,responsive:u.oneOfType([u.bool,u.oneOf(["sm","md","lg","xl","xxl"])])};Nr.displayName="CTableResponsiveWrapper";const Qr=e=>e.replace(/[-_.]/g," ").replace(/ +/g," ").replace(/([a-z0-9])([A-Z])/g,"$1 $2").split(" ").map(t=>t.charAt(0).toUpperCase()+t.slice(1)).join(" "),ni=e=>{var t;return typeof e=="object"?(t=e.label)!==null&&t!==void 0?t:Qr(e.key):Qr(e)},ri=(e,t)=>e?e.map(n=>typeof n=="object"?n.key:n):t&&oi(t),oi=e=>Object.keys(e[0]||{}).filter(t=>t.charAt(0)!=="_"),jr=m.forwardRef((e,t)=>{var{children:n,align:r,borderColor:o,bordered:s,borderless:i,caption:l,captionTop:c,className:f,color:d,columns:p,footer:b,hover:v,items:w,responsive:g,small:h,striped:x,stripedColumns:E,tableFootProps:C,tableHeadProps:j}=e,k=V(e,["children","align","borderColor","bordered","borderless","caption","captionTop","className","color","columns","footer","hover","items","responsive","small","striped","stripedColumns","tableFootProps","tableHeadProps"]);const O=m.useMemo(()=>ri(p,w),[p,w]);return y.createElement(Nr,{responsive:g},y.createElement("table",Object.assign({className:z("table",{[`align-${r}`]:r,[`border-${o}`]:o,"caption-top":c||l==="top","table-bordered":s,"table-borderless":i,[`table-${d}`]:d,"table-hover":v,"table-sm":h,"table-striped":x,"table-striped-columns":E},f)},k,{ref:t}),(l&&l!=="top"||c)&&y.createElement(Cr,null,l||c),p&&y.createElement(ln,Object.assign({},j),y.createElement($e,null,p.map((N,S)=>y.createElement(dt,Object.assign({},N._props&&Object.assign({},N._props),N._style&&{style:Object.assign({},N._style)},{key:S}),ni(N))))),w&&y.createElement(Yn,null,w.map((N,S)=>y.createElement($e,Object.assign({},N._props&&Object.assign({},N._props),{key:S}),O&&O.map((R,F)=>N[R]!==void 0?y.createElement(ft,Object.assign({},N._cellProps&&Object.assign(Object.assign({},N._cellProps.all&&Object.assign({},N._cellProps.all)),N._cellProps[R]&&Object.assign({},N._cellProps[R])),{key:F}),N[R]):null)))),n,b&&y.createElement(In,Object.assign({},C),y.createElement($e,null,b.map((N,S)=>y.createElement(ft,Object.assign({},typeof N=="object"&&N._props&&Object.assign({},N._props),{key:S}),typeof N=="object"?N.label:N))))))});jr.propTypes={align:u.oneOf(["bottom","middle","top"]),borderColor:u.string,bordered:u.bool,borderless:u.bool,caption:u.oneOfType([u.string,u.oneOf(["top"])]),captionTop:u.string,children:u.node,className:u.string,color:ke,columns:u.array,footer:u.array,hover:u.bool,items:u.array,responsive:u.oneOfType([u.bool,u.oneOf(["sm","md","lg","xl","xxl"])]),small:u.bool,striped:u.bool,stripedColumns:u.bool,tableFootProps:u.shape(Object.assign({},In.propTypes)),tableHeadProps:u.shape(Object.assign({},ln.propTypes))};jr.displayName="CTable";const Er=m.forwardRef((e,t)=>{var{children:n,animation:r=!0,className:o,container:s,content:i,delay:l=0,fallbackPlacements:c=["top","right","bottom","left"],offset:f=[0,6],onHide:d,onShow:p,placement:b="top",popperConfig:v,trigger:w=["hover","focus"],visible:g}=e,h=V(e,["children","animation","className","container","content","delay","fallbackPlacements","offset","onHide","onShow","placement","popperConfig","trigger","visible"]);const x=m.useRef(null),E=m.useRef(null),C=Ot(t,x),j=`tooltip${m.useId()}`,[k,O]=m.useState(!1),[N,S]=m.useState(g),{initPopper:R,destroyPopper:F,updatePopper:P}=$o(),A=typeof l=="number"?{show:l,hide:l}:l,Y={modifiers:[{name:"arrow",options:{element:".tooltip-arrow"}},{name:"flip",options:{fallbackPlacements:c}},{name:"offset",options:{offset:f}}],placement:ti(b,E.current)},Z=Object.assign(Object.assign({},Y),typeof v=="function"?v(Y):v);m.useEffect(()=>{if(g){H();return}te()},[g]),m.useEffect(()=>{if(k&&E.current&&x.current){R(E.current,x.current,Z),setTimeout(()=>{S(!0)},A.show);return}!k&&E.current&&x.current&&F()},[k]),m.useEffect(()=>{!N&&E.current&&x.current&&ei(()=>{O(!1)},x.current)},[N]);const H=()=>{O(!0),p&&p()},te=()=>{setTimeout(()=>{S(!1),d&&d()},A.hide)};return m.useEffect(()=>{P()},[i]),y.createElement(y.Fragment,null,y.cloneElement(n,Object.assign(Object.assign(Object.assign(Object.assign(Object.assign({},N&&{"aria-describedby":j}),{ref:E}),(w==="click"||w.includes("click"))&&{onClick:()=>N?te():H()}),(w==="focus"||w.includes("focus"))&&{onFocus:()=>H(),onBlur:()=>te()}),(w==="hover"||w.includes("hover"))&&{onMouseEnter:()=>H(),onMouseLeave:()=>te()})),y.createElement(kt,{container:s,portal:!0},k&&y.createElement("div",Object.assign({className:z("tooltip","bs-tooltip-auto",{fade:r,show:N},o),id:j,ref:C,role:"tooltip"},h),y.createElement("div",{className:"tooltip-arrow"}),y.createElement("div",{className:"tooltip-inner"},i))))});Er.propTypes={animation:u.bool,children:u.node,container:u.any,content:u.oneOfType([u.string,u.node]),delay:u.oneOfType([u.number,u.shape({show:u.number.isRequired,hide:u.number.isRequired})]),fallbackPlacements:Ts,offset:u.any,onHide:u.func,onShow:u.func,placement:u.oneOf(["auto","top","right","bottom","left"]),popperConfig:u.oneOfType([u.func,u.object]),trigger:So,visible:u.bool};Er.displayName="CTooltip";const si="modulepreload",ai=function(e,t){return new URL(e,t).href},Jr={},ii=function(t,n,r){let o=Promise.resolve();if(n&&n.length>0){let f=function(d){return Promise.all(d.map(p=>Promise.resolve(p).then(b=>({status:"fulfilled",value:b}),b=>({status:"rejected",reason:b}))))};const i=document.getElementsByTagName("link"),l=document.querySelector("meta[property=csp-nonce]"),c=l?.nonce||l?.getAttribute("nonce");o=f(n.map(d=>{if(d=ai(d,r),d in Jr)return;Jr[d]=!0;const p=d.endsWith(".css"),b=p?'[rel="stylesheet"]':"";if(r)for(let w=i.length-1;w>=0;w--){const g=i[w];if(g.href===d&&(!p||g.rel==="stylesheet"))return}else if(document.querySelector(`link[href="${d}"]${b}`))return;const v=document.createElement("link");if(v.rel=p?"stylesheet":si,p||(v.as="script"),v.crossOrigin="",v.href=d,c&&v.setAttribute("nonce",c),document.head.appendChild(v),p)return new Promise((w,g)=>{v.addEventListener("load",w),v.addEventListener("error",()=>g(new Error(`Unable to preload CSS for ${d}`)))})}))}function s(i){const l=new Event("vite:preloadError",{cancelable:!0});if(l.payload=i,window.dispatchEvent(l),!l.defaultPrevented)throw i}return o.then(i=>{for(const l of i||[])l.status==="rejected"&&s(l.reason);return t().catch(s)})},Zr={selectedWorksheet:"",worksheet:"",exportMode:"formatted",workbookName:"",worksheetName:"",fileName:"pivot_data",sheetName:"Sheet1",headerRowsCount:0,headerRowSettings:[],tableTitle:"",titleAlignment:"center",titleFontColor:"#000000",titleBgColor:"#F8F9FA",groupColumns:[],pivotColumns:[],valueColumns:[],customFields:[],metricGroups:[],showSubtotals:!1,subtotalLevels:[],subtotalLabels:{},useCustomSubtotalLabels:!1,showRowTotals:!1,rowTotalsPosition:"right",rowTotalsLabel:"Row Totals",showColumnTotals:!1,columnTotalsPosition:"bottom",columnTotalsLabel:"Column Totals",rowFormatRules:{},fieldRenames:{},formatSettings:{},pivotHeaderFormat:{fontColor:"#000000",bgColor:"#F3F4F6",textAlign:"center"}},li=()=>{const[e,t]=m.useState(Zr);return{config:e,updateConfig:d=>{t(p=>({...p,...d}))},addColumnToSection:(d,p)=>{t(b=>{const v=`${d}Columns`,w=b[v];return w.find(g=>g.id===p.id)?b:{...b,[v]:[...w,p]}})},removeColumnFromSection:(d,p)=>{t(b=>{const v=`${d}Columns`,w=b[v];return{...b,[v]:w.filter(g=>g.id!==p)}})},reorderColumns:(d,p)=>{t(b=>({...b,[`${d}Columns`]:p}))},addMetricGroup:()=>{t(d=>{const p=d.metricGroups.length>0?Math.max(...d.metricGroups.map(v=>v.id))+1:1,b={id:p,name:`Group ${p}`,fields:[],collapsed:!1};return{...d,metricGroups:[...d.metricGroups,b]}})},removeMetricGroup:d=>{t(p=>({...p,metricGroups:p.metricGroups.filter(b=>b.id!==d)}))},updateMetricGroup:(d,p)=>{t(b=>({...b,metricGroups:b.metricGroups.map(v=>v.id===d?{...v,...p}:v)}))},resetConfig:d=>{t({...Zr,selectedWorksheet:d})},setConfig:t}};const ci=e=>e.replace(/([a-z0-9])([A-Z])/g,"$1-$2").toLowerCase(),di=e=>e.replace(/^([A-Z])|[\s-_]+(\w)/g,(t,n,r)=>r?r.toUpperCase():n.toLowerCase()),eo=e=>{const t=di(e);return t.charAt(0).toUpperCase()+t.slice(1)},Io=(...e)=>e.filter((t,n,r)=>!!t&&t.trim()!==""&&r.indexOf(t)===n).join(" ").trim(),ui=e=>{for(const t in e)if(t.startsWith("aria-")||t==="role"||t==="title")return!0};var fi={xmlns:"http://www.w3.org/2000/svg",width:24,height:24,viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:2,strokeLinecap:"round",strokeLinejoin:"round"};const mi=m.forwardRef(({color:e="currentColor",size:t=24,strokeWidth:n=2,absoluteStrokeWidth:r,className:o="",children:s,iconNode:i,...l},c)=>m.createElement("svg",{ref:c,...fi,width:t,height:t,stroke:e,strokeWidth:r?Number(n)*24/Number(t):n,className:Io("lucide",o),...!s&&!ui(l)&&{"aria-hidden":"true"},...l},[...i.map(([f,d])=>m.createElement(f,d)),...Array.isArray(s)?s:[s]]));const me=(e,t)=>{const n=m.forwardRef(({className:r,...o},s)=>m.createElement(mi,{ref:s,iconNode:t,className:Io(`lucide-${ci(eo(e))}`,`lucide-${e}`,r),...o}));return n.displayName=eo(e),n};const pi=[["path",{d:"M12 5v14",key:"s699le"}],["path",{d:"m19 12-7 7-7-7",key:"1idqje"}]],hi=me("arrow-down",pi);const gi=[["path",{d:"m5 12 7-7 7 7",key:"hav0vg"}],["path",{d:"M12 19V5",key:"x0mq9r"}]],vi=me("arrow-up",gi);const bi=[["path",{d:"M20 6 9 17l-5-5",key:"1gmf2c"}]],yi=me("check",bi);const xi=[["path",{d:"m6 9 6 6 6-6",key:"qrunsl"}]],wi=me("chevron-down",xi);const Ci=[["path",{d:"m18 15-6-6-6 6",key:"153udz"}]],Ni=me("chevron-up",Ci);const ji=[["circle",{cx:"9",cy:"12",r:"1",key:"1vctgf"}],["circle",{cx:"9",cy:"5",r:"1",key:"hp0tcf"}],["circle",{cx:"9",cy:"19",r:"1",key:"fkjjf6"}],["circle",{cx:"15",cy:"12",r:"1",key:"1tmaij"}],["circle",{cx:"15",cy:"5",r:"1",key:"19l28e"}],["circle",{cx:"15",cy:"19",r:"1",key:"f4zoj3"}]],Ei=me("grip-vertical",ji);const Si=[["line",{x1:"4",x2:"20",y1:"9",y2:"9",key:"4lhtct"}],["line",{x1:"4",x2:"20",y1:"15",y2:"15",key:"vyu0kd"}],["line",{x1:"10",x2:"8",y1:"3",y2:"21",key:"1ggp8o"}],["line",{x1:"16",x2:"14",y1:"3",y2:"21",key:"weycgp"}]],ki=me("hash",Si);const Oi=[["path",{d:"M12.83 2.18a2 2 0 0 0-1.66 0L2.6 6.08a1 1 0 0 0 0 1.83l8.58 3.91a2 2 0 0 0 1.66 0l8.58-3.9a1 1 0 0 0 0-1.83z",key:"zw3jo"}],["path",{d:"M2 12a1 1 0 0 0 .58.91l8.6 3.91a2 2 0 0 0 1.65 0l8.58-3.9A1 1 0 0 0 22 12",key:"1wduqc"}],["path",{d:"M2 17a1 1 0 0 0 .58.91l8.6 3.91a2 2 0 0 0 1.65 0l8.58-3.9A1 1 0 0 0 22 17",key:"kqbvx6"}]],zo=me("layers",Oi);const Di=[["path",{d:"m22 7-8.991 5.727a2 2 0 0 1-2.009 0L2 7",key:"132q7q"}],["rect",{x:"2",y:"4",width:"20",height:"16",rx:"2",key:"izxlao"}]],Ti=me("mail",Di);const Ri=[["path",{d:"M12 22a1 1 0 0 1 0-20 10 9 0 0 1 10 9 5 5 0 0 1-5 5h-2.25a1.75 1.75 0 0 0-1.4 2.8l.3.4a1.75 1.75 0 0 1-1.4 2.8z",key:"e79jfc"}],["circle",{cx:"13.5",cy:"6.5",r:".5",fill:"currentColor",key:"1okk4w"}],["circle",{cx:"17.5",cy:"10.5",r:".5",fill:"currentColor",key:"f64h9f"}],["circle",{cx:"6.5",cy:"12.5",r:".5",fill:"currentColor",key:"qy21gx"}],["circle",{cx:"8.5",cy:"7.5",r:".5",fill:"currentColor",key:"fotxhn"}]],Mi=me("palette",Ri);const Pi=[["path",{d:"M21.174 6.812a1 1 0 0 0-3.986-3.987L3.842 16.174a2 2 0 0 0-.5.83l-1.321 4.352a.5.5 0 0 0 .623.622l4.353-1.32a2 2 0 0 0 .83-.497z",key:"1a8usu"}]],Wo=me("pen",Pi);const Fi=[["path",{d:"M5 12h14",key:"1ays0h"}],["path",{d:"M12 5v14",key:"s699le"}]],Nn=me("plus",Fi);const Ai=[["path",{d:"M9.671 4.136a2.34 2.34 0 0 1 4.659 0 2.34 2.34 0 0 0 3.319 1.915 2.34 2.34 0 0 1 2.33 4.033 2.34 2.34 0 0 0 0 3.831 2.34 2.34 0 0 1-2.33 4.033 2.34 2.34 0 0 0-3.319 1.915 2.34 2.34 0 0 1-4.659 0 2.34 2.34 0 0 0-3.32-1.915 2.34 2.34 0 0 1-2.33-4.033 2.34 2.34 0 0 0 0-3.831A2.34 2.34 0 0 1 6.35 6.051a2.34 2.34 0 0 0 3.319-1.915",key:"1i5ecw"}],["circle",{cx:"12",cy:"12",r:"3",key:"1v7zrd"}]],zn=me("settings",Ai);const $i=[["path",{d:"M10 11v6",key:"nco0om"}],["path",{d:"M14 11v6",key:"outv1u"}],["path",{d:"M19 6v14a2 2 0 0 1-2 2H7a2 2 0 0 1-2-2V6",key:"miytrc"}],["path",{d:"M3 6h18",key:"d0wm0j"}],["path",{d:"M8 6V4a2 2 0 0 1 2-2h4a2 2 0 0 1 2 2v2",key:"e791ji"}]],Sr=me("trash-2",$i);const Li=[["path",{d:"M18 6 6 18",key:"1bl5f8"}],["path",{d:"m6 6 12 12",key:"d8bk6v"}]],jn=me("x",Li),Yi=({worksheets:e,selectedWorksheet:t,onSelect:n,onOpenSettings:r})=>a.jsxs(Dt,{className:"mb-4 shadow-sm",children:[a.jsxs(an,{className:"bg-white font-semibold text-epsilon-blue flex justify-between items-center",children:[a.jsx("span",{children:"Select Worksheet"}),a.jsx(J,{color:"secondary",variant:"outline",size:"sm",onClick:r,title:"Export Settings",children:a.jsx(zn,{size:16})})]}),a.jsx(Tt,{children:a.jsxs(ae,{value:t,onChange:o=>n(o.target.value),"aria-label":"Select Worksheet",children:[a.jsx("option",{value:"",children:"Select a worksheet"}),e.map(o=>a.jsx("option",{value:o.name,children:o.name},o.name))]})})]});function Ii(){for(var e=arguments.length,t=new Array(e),n=0;n<e;n++)t[n]=arguments[n];return m.useMemo(()=>r=>{t.forEach(o=>o(r))},t)}const Wn=typeof window<"u"&&typeof window.document<"u"&&typeof window.document.createElement<"u";function Pt(e){const t=Object.prototype.toString.call(e);return t==="[object Window]"||t==="[object global]"}function kr(e){return"nodeType"in e}function pe(e){var t,n;return e?Pt(e)?e:kr(e)&&(t=(n=e.ownerDocument)==null?void 0:n.defaultView)!=null?t:window:window}function Or(e){const{Document:t}=pe(e);return e instanceof t}function cn(e){return Pt(e)?!1:e instanceof pe(e).HTMLElement}function Bo(e){return e instanceof pe(e).SVGElement}function Ft(e){return e?Pt(e)?e.document:kr(e)?Or(e)?e:cn(e)||Bo(e)?e.ownerDocument:document:document:document}const Re=Wn?m.useLayoutEffect:m.useEffect;function Bn(e){const t=m.useRef(e);return Re(()=>{t.current=e}),m.useCallback(function(){for(var n=arguments.length,r=new Array(n),o=0;o<n;o++)r[o]=arguments[o];return t.current==null?void 0:t.current(...r)},[])}function zi(){const e=m.useRef(null),t=m.useCallback((r,o)=>{e.current=setInterval(r,o)},[]),n=m.useCallback(()=>{e.current!==null&&(clearInterval(e.current),e.current=null)},[]);return[t,n]}function en(e,t){t===void 0&&(t=[e]);const n=m.useRef(e);return Re(()=>{n.current!==e&&(n.current=e)},t),n}function dn(e,t){const n=m.useRef();return m.useMemo(()=>{const r=e(n.current);return n.current=r,r},[...t])}function En(e){const t=Bn(e),n=m.useRef(null),r=m.useCallback(o=>{o!==n.current&&t?.(o,n.current),n.current=o},[]);return[n,r]}function Sn(e){const t=m.useRef();return m.useEffect(()=>{t.current=e},[e]),t.current}let Qn={};function un(e,t){return m.useMemo(()=>{if(t)return t;const n=Qn[e]==null?0:Qn[e]+1;return Qn[e]=n,e+"-"+n},[e,t])}function Ho(e){return function(t){for(var n=arguments.length,r=new Array(n>1?n-1:0),o=1;o<n;o++)r[o-1]=arguments[o];return r.reduce((s,i)=>{const l=Object.entries(i);for(const[c,f]of l){const d=s[c];d!=null&&(s[c]=d+e*f)}return s},{...t})}}const Ct=Ho(1),tn=Ho(-1);function Wi(e){return"clientX"in e&&"clientY"in e}function Hn(e){if(!e)return!1;const{KeyboardEvent:t}=pe(e.target);return t&&e instanceof t}function Bi(e){if(!e)return!1;const{TouchEvent:t}=pe(e.target);return t&&e instanceof t}function kn(e){if(Bi(e)){if(e.touches&&e.touches.length){const{clientX:t,clientY:n}=e.touches[0];return{x:t,y:n}}else if(e.changedTouches&&e.changedTouches.length){const{clientX:t,clientY:n}=e.changedTouches[0];return{x:t,y:n}}}return Wi(e)?{x:e.clientX,y:e.clientY}:null}const et=Object.freeze({Translate:{toString(e){if(!e)return;const{x:t,y:n}=e;return"translate3d("+(t?Math.round(t):0)+"px, "+(n?Math.round(n):0)+"px, 0)"}},Scale:{toString(e){if(!e)return;const{scaleX:t,scaleY:n}=e;return"scaleX("+t+") scaleY("+n+")"}},Transform:{toString(e){if(e)return[et.Translate.toString(e),et.Scale.toString(e)].join(" ")}},Transition:{toString(e){let{property:t,duration:n,easing:r}=e;return t+" "+n+"ms "+r}}}),to="a,frame,iframe,input:not([type=hidden]):not(:disabled),select:not(:disabled),textarea:not(:disabled),button:not(:disabled),*[tabindex]";function Hi(e){return e.matches(to)?e:e.querySelector(to)}const Vi={display:"none"};function qi(e){let{id:t,value:n}=e;return y.createElement("div",{id:t,style:Vi},n)}function Gi(e){let{id:t,announcement:n,ariaLiveType:r="assertive"}=e;const o={position:"fixed",top:0,left:0,width:1,height:1,margin:-1,border:0,padding:0,overflow:"hidden",clip:"rect(0 0 0 0)",clipPath:"inset(100%)",whiteSpace:"nowrap"};return y.createElement("div",{id:t,style:o,role:"status","aria-live":r,"aria-atomic":!0},n)}function Xi(){const[e,t]=m.useState("");return{announce:m.useCallback(r=>{r!=null&&t(r)},[]),announcement:e}}const Vo=m.createContext(null);function _i(e){const t=m.useContext(Vo);m.useEffect(()=>{if(!t)throw new Error("useDndMonitor must be used within a children of <DndContext>");return t(e)},[e,t])}function Ki(){const[e]=m.useState(()=>new Set),t=m.useCallback(r=>(e.add(r),()=>e.delete(r)),[e]);return[m.useCallback(r=>{let{type:o,event:s}=r;e.forEach(i=>{var l;return(l=i[o])==null?void 0:l.call(i,s)})},[e]),t]}const Ui={draggable:`
    To pick up a draggable item, press the space bar.
    While dragging, use the arrow keys to move the item.
    Press space again to drop the item in its new position, or press escape to cancel.
  `},Qi={onDragStart(e){let{active:t}=e;return"Picked up draggable item "+t.id+"."},onDragOver(e){let{active:t,over:n}=e;return n?"Draggable item "+t.id+" was moved over droppable area "+n.id+".":"Draggable item "+t.id+" is no longer over a droppable area."},onDragEnd(e){let{active:t,over:n}=e;return n?"Draggable item "+t.id+" was dropped over droppable area "+n.id:"Draggable item "+t.id+" was dropped."},onDragCancel(e){let{active:t}=e;return"Dragging was cancelled. Draggable item "+t.id+" was dropped."}};function Ji(e){let{announcements:t=Qi,container:n,hiddenTextDescribedById:r,screenReaderInstructions:o=Ui}=e;const{announce:s,announcement:i}=Xi(),l=un("DndLiveRegion"),[c,f]=m.useState(!1);if(m.useEffect(()=>{f(!0)},[]),_i(m.useMemo(()=>({onDragStart(p){let{active:b}=p;s(t.onDragStart({active:b}))},onDragMove(p){let{active:b,over:v}=p;t.onDragMove&&s(t.onDragMove({active:b,over:v}))},onDragOver(p){let{active:b,over:v}=p;s(t.onDragOver({active:b,over:v}))},onDragEnd(p){let{active:b,over:v}=p;s(t.onDragEnd({active:b,over:v}))},onDragCancel(p){let{active:b,over:v}=p;s(t.onDragCancel({active:b,over:v}))}}),[s,t])),!c)return null;const d=y.createElement(y.Fragment,null,y.createElement(qi,{id:r,value:o.draggable}),y.createElement(Gi,{id:l,announcement:i}));return n?wt.createPortal(d,n):d}var se;(function(e){e.DragStart="dragStart",e.DragMove="dragMove",e.DragEnd="dragEnd",e.DragCancel="dragCancel",e.DragOver="dragOver",e.RegisterDroppable="registerDroppable",e.SetDroppableDisabled="setDroppableDisabled",e.UnregisterDroppable="unregisterDroppable"})(se||(se={}));function On(){}function no(e,t){return m.useMemo(()=>({sensor:e,options:t??{}}),[e,t])}function Zi(){for(var e=arguments.length,t=new Array(e),n=0;n<e;n++)t[n]=arguments[n];return m.useMemo(()=>[...t].filter(r=>r!=null),[...t])}const Me=Object.freeze({x:0,y:0});function qo(e,t){return Math.sqrt(Math.pow(e.x-t.x,2)+Math.pow(e.y-t.y,2))}function el(e,t){const n=kn(e);if(!n)return"0 0";const r={x:(n.x-t.left)/t.width*100,y:(n.y-t.top)/t.height*100};return r.x+"% "+r.y+"%"}function Go(e,t){let{data:{value:n}}=e,{data:{value:r}}=t;return n-r}function tl(e,t){let{data:{value:n}}=e,{data:{value:r}}=t;return r-n}function ro(e){let{left:t,top:n,height:r,width:o}=e;return[{x:t,y:n},{x:t+o,y:n},{x:t,y:n+r},{x:t+o,y:n+r}]}function Xo(e,t){if(!e||e.length===0)return null;const[n]=e;return n[t]}function oo(e,t,n){return t===void 0&&(t=e.left),n===void 0&&(n=e.top),{x:t+e.width*.5,y:n+e.height*.5}}const nl=e=>{let{collisionRect:t,droppableRects:n,droppableContainers:r}=e;const o=oo(t,t.left,t.top),s=[];for(const i of r){const{id:l}=i,c=n.get(l);if(c){const f=qo(oo(c),o);s.push({id:l,data:{droppableContainer:i,value:f}})}}return s.sort(Go)},rl=e=>{let{collisionRect:t,droppableRects:n,droppableContainers:r}=e;const o=ro(t),s=[];for(const i of r){const{id:l}=i,c=n.get(l);if(c){const f=ro(c),d=o.reduce((b,v,w)=>b+qo(f[w],v),0),p=Number((d/4).toFixed(4));s.push({id:l,data:{droppableContainer:i,value:p}})}}return s.sort(Go)};function ol(e,t){const n=Math.max(t.top,e.top),r=Math.max(t.left,e.left),o=Math.min(t.left+t.width,e.left+e.width),s=Math.min(t.top+t.height,e.top+e.height),i=o-r,l=s-n;if(r<o&&n<s){const c=t.width*t.height,f=e.width*e.height,d=i*l,p=d/(c+f-d);return Number(p.toFixed(4))}return 0}const sl=e=>{let{collisionRect:t,droppableRects:n,droppableContainers:r}=e;const o=[];for(const s of r){const{id:i}=s,l=n.get(i);if(l){const c=ol(l,t);c>0&&o.push({id:i,data:{droppableContainer:s,value:c}})}}return o.sort(tl)};function al(e,t,n){return{...e,scaleX:t&&n?t.width/n.width:1,scaleY:t&&n?t.height/n.height:1}}function _o(e,t){return e&&t?{x:e.left-t.left,y:e.top-t.top}:Me}function il(e){return function(n){for(var r=arguments.length,o=new Array(r>1?r-1:0),s=1;s<r;s++)o[s-1]=arguments[s];return o.reduce((i,l)=>({...i,top:i.top+e*l.y,bottom:i.bottom+e*l.y,left:i.left+e*l.x,right:i.right+e*l.x}),{...n})}}const ll=il(1);function Ko(e){if(e.startsWith("matrix3d(")){const t=e.slice(9,-1).split(/, /);return{x:+t[12],y:+t[13],scaleX:+t[0],scaleY:+t[5]}}else if(e.startsWith("matrix(")){const t=e.slice(7,-1).split(/, /);return{x:+t[4],y:+t[5],scaleX:+t[0],scaleY:+t[3]}}return null}function cl(e,t,n){const r=Ko(t);if(!r)return e;const{scaleX:o,scaleY:s,x:i,y:l}=r,c=e.left-i-(1-o)*parseFloat(n),f=e.top-l-(1-s)*parseFloat(n.slice(n.indexOf(" ")+1)),d=o?e.width/o:e.width,p=s?e.height/s:e.height;return{width:d,height:p,top:f,right:c+d,bottom:f+p,left:c}}const dl={ignoreTransform:!1};function At(e,t){t===void 0&&(t=dl);let n=e.getBoundingClientRect();if(t.ignoreTransform){const{transform:f,transformOrigin:d}=pe(e).getComputedStyle(e);f&&(n=cl(n,f,d))}const{top:r,left:o,width:s,height:i,bottom:l,right:c}=n;return{top:r,left:o,width:s,height:i,bottom:l,right:c}}function so(e){return At(e,{ignoreTransform:!0})}function ul(e){const t=e.innerWidth,n=e.innerHeight;return{top:0,left:0,right:t,bottom:n,width:t,height:n}}function fl(e,t){return t===void 0&&(t=pe(e).getComputedStyle(e)),t.position==="fixed"}function ml(e,t){t===void 0&&(t=pe(e).getComputedStyle(e));const n=/(auto|scroll|overlay)/;return["overflow","overflowX","overflowY"].some(o=>{const s=t[o];return typeof s=="string"?n.test(s):!1})}function Vn(e,t){const n=[];function r(o){if(t!=null&&n.length>=t||!o)return n;if(Or(o)&&o.scrollingElement!=null&&!n.includes(o.scrollingElement))return n.push(o.scrollingElement),n;if(!cn(o)||Bo(o)||n.includes(o))return n;const s=pe(e).getComputedStyle(o);return o!==e&&ml(o,s)&&n.push(o),fl(o,s)?n:r(o.parentNode)}return e?r(e):n}function Uo(e){const[t]=Vn(e,1);return t??null}function Jn(e){return!Wn||!e?null:Pt(e)?e:kr(e)?Or(e)||e===Ft(e).scrollingElement?window:cn(e)?e:null:null}function Qo(e){return Pt(e)?e.scrollX:e.scrollLeft}function Jo(e){return Pt(e)?e.scrollY:e.scrollTop}function sr(e){return{x:Qo(e),y:Jo(e)}}var le;(function(e){e[e.Forward=1]="Forward",e[e.Backward=-1]="Backward"})(le||(le={}));function Zo(e){return!Wn||!e?!1:e===document.scrollingElement}function es(e){const t={x:0,y:0},n=Zo(e)?{height:window.innerHeight,width:window.innerWidth}:{height:e.clientHeight,width:e.clientWidth},r={x:e.scrollWidth-n.width,y:e.scrollHeight-n.height},o=e.scrollTop<=t.y,s=e.scrollLeft<=t.x,i=e.scrollTop>=r.y,l=e.scrollLeft>=r.x;return{isTop:o,isLeft:s,isBottom:i,isRight:l,maxScroll:r,minScroll:t}}const pl={x:.2,y:.2};function hl(e,t,n,r,o){let{top:s,left:i,right:l,bottom:c}=n;r===void 0&&(r=10),o===void 0&&(o=pl);const{isTop:f,isBottom:d,isLeft:p,isRight:b}=es(e),v={x:0,y:0},w={x:0,y:0},g={height:t.height*o.y,width:t.width*o.x};return!f&&s<=t.top+g.height?(v.y=le.Backward,w.y=r*Math.abs((t.top+g.height-s)/g.height)):!d&&c>=t.bottom-g.height&&(v.y=le.Forward,w.y=r*Math.abs((t.bottom-g.height-c)/g.height)),!b&&l>=t.right-g.width?(v.x=le.Forward,w.x=r*Math.abs((t.right-g.width-l)/g.width)):!p&&i<=t.left+g.width&&(v.x=le.Backward,w.x=r*Math.abs((t.left+g.width-i)/g.width)),{direction:v,speed:w}}function gl(e){if(e===document.scrollingElement){const{innerWidth:s,innerHeight:i}=window;return{top:0,left:0,right:s,bottom:i,width:s,height:i}}const{top:t,left:n,right:r,bottom:o}=e.getBoundingClientRect();return{top:t,left:n,right:r,bottom:o,width:e.clientWidth,height:e.clientHeight}}function ts(e){return e.reduce((t,n)=>Ct(t,sr(n)),Me)}function vl(e){return e.reduce((t,n)=>t+Qo(n),0)}function bl(e){return e.reduce((t,n)=>t+Jo(n),0)}function ns(e,t){if(t===void 0&&(t=At),!e)return;const{top:n,left:r,bottom:o,right:s}=t(e);Uo(e)&&(o<=0||s<=0||n>=window.innerHeight||r>=window.innerWidth)&&e.scrollIntoView({block:"center",inline:"center"})}const yl=[["x",["left","right"],vl],["y",["top","bottom"],bl]];class Dr{constructor(t,n){this.rect=void 0,this.width=void 0,this.height=void 0,this.top=void 0,this.bottom=void 0,this.right=void 0,this.left=void 0;const r=Vn(n),o=ts(r);this.rect={...t},this.width=t.width,this.height=t.height;for(const[s,i,l]of yl)for(const c of i)Object.defineProperty(this,c,{get:()=>{const f=l(r),d=o[s]-f;return this.rect[c]+d},enumerable:!0});Object.defineProperty(this,"rect",{enumerable:!1})}}class Kt{constructor(t){this.target=void 0,this.listeners=[],this.removeAll=()=>{this.listeners.forEach(n=>{var r;return(r=this.target)==null?void 0:r.removeEventListener(...n)})},this.target=t}add(t,n,r){var o;(o=this.target)==null||o.addEventListener(t,n,r),this.listeners.push([t,n,r])}}function xl(e){const{EventTarget:t}=pe(e);return e instanceof t?e:Ft(e)}function Zn(e,t){const n=Math.abs(e.x),r=Math.abs(e.y);return typeof t=="number"?Math.sqrt(n**2+r**2)>t:"x"in t&&"y"in t?n>t.x&&r>t.y:"x"in t?n>t.x:"y"in t?r>t.y:!1}var Ee;(function(e){e.Click="click",e.DragStart="dragstart",e.Keydown="keydown",e.ContextMenu="contextmenu",e.Resize="resize",e.SelectionChange="selectionchange",e.VisibilityChange="visibilitychange"})(Ee||(Ee={}));function ao(e){e.preventDefault()}function wl(e){e.stopPropagation()}var Q;(function(e){e.Space="Space",e.Down="ArrowDown",e.Right="ArrowRight",e.Left="ArrowLeft",e.Up="ArrowUp",e.Esc="Escape",e.Enter="Enter",e.Tab="Tab"})(Q||(Q={}));const rs={start:[Q.Space,Q.Enter],cancel:[Q.Esc],end:[Q.Space,Q.Enter,Q.Tab]},Cl=(e,t)=>{let{currentCoordinates:n}=t;switch(e.code){case Q.Right:return{...n,x:n.x+25};case Q.Left:return{...n,x:n.x-25};case Q.Down:return{...n,y:n.y+25};case Q.Up:return{...n,y:n.y-25}}};class Tr{constructor(t){this.props=void 0,this.autoScrollEnabled=!1,this.referenceCoordinates=void 0,this.listeners=void 0,this.windowListeners=void 0,this.props=t;const{event:{target:n}}=t;this.props=t,this.listeners=new Kt(Ft(n)),this.windowListeners=new Kt(pe(n)),this.handleKeyDown=this.handleKeyDown.bind(this),this.handleCancel=this.handleCancel.bind(this),this.attach()}attach(){this.handleStart(),this.windowListeners.add(Ee.Resize,this.handleCancel),this.windowListeners.add(Ee.VisibilityChange,this.handleCancel),setTimeout(()=>this.listeners.add(Ee.Keydown,this.handleKeyDown))}handleStart(){const{activeNode:t,onStart:n}=this.props,r=t.node.current;r&&ns(r),n(Me)}handleKeyDown(t){if(Hn(t)){const{active:n,context:r,options:o}=this.props,{keyboardCodes:s=rs,coordinateGetter:i=Cl,scrollBehavior:l="smooth"}=o,{code:c}=t;if(s.end.includes(c)){this.handleEnd(t);return}if(s.cancel.includes(c)){this.handleCancel(t);return}const{collisionRect:f}=r.current,d=f?{x:f.left,y:f.top}:Me;this.referenceCoordinates||(this.referenceCoordinates=d);const p=i(t,{active:n,context:r.current,currentCoordinates:d});if(p){const b=tn(p,d),v={x:0,y:0},{scrollableAncestors:w}=r.current;for(const g of w){const h=t.code,{isTop:x,isRight:E,isLeft:C,isBottom:j,maxScroll:k,minScroll:O}=es(g),N=gl(g),S={x:Math.min(h===Q.Right?N.right-N.width/2:N.right,Math.max(h===Q.Right?N.left:N.left+N.width/2,p.x)),y:Math.min(h===Q.Down?N.bottom-N.height/2:N.bottom,Math.max(h===Q.Down?N.top:N.top+N.height/2,p.y))},R=h===Q.Right&&!E||h===Q.Left&&!C,F=h===Q.Down&&!j||h===Q.Up&&!x;if(R&&S.x!==p.x){const P=g.scrollLeft+b.x,A=h===Q.Right&&P<=k.x||h===Q.Left&&P>=O.x;if(A&&!b.y){g.scrollTo({left:P,behavior:l});return}A?v.x=g.scrollLeft-P:v.x=h===Q.Right?g.scrollLeft-k.x:g.scrollLeft-O.x,v.x&&g.scrollBy({left:-v.x,behavior:l});break}else if(F&&S.y!==p.y){const P=g.scrollTop+b.y,A=h===Q.Down&&P<=k.y||h===Q.Up&&P>=O.y;if(A&&!b.x){g.scrollTo({top:P,behavior:l});return}A?v.y=g.scrollTop-P:v.y=h===Q.Down?g.scrollTop-k.y:g.scrollTop-O.y,v.y&&g.scrollBy({top:-v.y,behavior:l});break}}this.handleMove(t,Ct(tn(p,this.referenceCoordinates),v))}}}handleMove(t,n){const{onMove:r}=this.props;t.preventDefault(),r(n)}handleEnd(t){const{onEnd:n}=this.props;t.preventDefault(),this.detach(),n()}handleCancel(t){const{onCancel:n}=this.props;t.preventDefault(),this.detach(),n()}detach(){this.listeners.removeAll(),this.windowListeners.removeAll()}}Tr.activators=[{eventName:"onKeyDown",handler:(e,t,n)=>{let{keyboardCodes:r=rs,onActivation:o}=t,{active:s}=n;const{code:i}=e.nativeEvent;if(r.start.includes(i)){const l=s.activatorNode.current;return l&&e.target!==l?!1:(e.preventDefault(),o?.({event:e.nativeEvent}),!0)}return!1}}];function io(e){return!!(e&&"distance"in e)}function lo(e){return!!(e&&"delay"in e)}class Rr{constructor(t,n,r){var o;r===void 0&&(r=xl(t.event.target)),this.props=void 0,this.events=void 0,this.autoScrollEnabled=!0,this.document=void 0,this.activated=!1,this.initialCoordinates=void 0,this.timeoutId=null,this.listeners=void 0,this.documentListeners=void 0,this.windowListeners=void 0,this.props=t,this.events=n;const{event:s}=t,{target:i}=s;this.props=t,this.events=n,this.document=Ft(i),this.documentListeners=new Kt(this.document),this.listeners=new Kt(r),this.windowListeners=new Kt(pe(i)),this.initialCoordinates=(o=kn(s))!=null?o:Me,this.handleStart=this.handleStart.bind(this),this.handleMove=this.handleMove.bind(this),this.handleEnd=this.handleEnd.bind(this),this.handleCancel=this.handleCancel.bind(this),this.handleKeydown=this.handleKeydown.bind(this),this.removeTextSelection=this.removeTextSelection.bind(this),this.attach()}attach(){const{events:t,props:{options:{activationConstraint:n,bypassActivationConstraint:r}}}=this;if(this.listeners.add(t.move.name,this.handleMove,{passive:!1}),this.listeners.add(t.end.name,this.handleEnd),t.cancel&&this.listeners.add(t.cancel.name,this.handleCancel),this.windowListeners.add(Ee.Resize,this.handleCancel),this.windowListeners.add(Ee.DragStart,ao),this.windowListeners.add(Ee.VisibilityChange,this.handleCancel),this.windowListeners.add(Ee.ContextMenu,ao),this.documentListeners.add(Ee.Keydown,this.handleKeydown),n){if(r!=null&&r({event:this.props.event,activeNode:this.props.activeNode,options:this.props.options}))return this.handleStart();if(lo(n)){this.timeoutId=setTimeout(this.handleStart,n.delay),this.handlePending(n);return}if(io(n)){this.handlePending(n);return}}this.handleStart()}detach(){this.listeners.removeAll(),this.windowListeners.removeAll(),setTimeout(this.documentListeners.removeAll,50),this.timeoutId!==null&&(clearTimeout(this.timeoutId),this.timeoutId=null)}handlePending(t,n){const{active:r,onPending:o}=this.props;o(r,t,this.initialCoordinates,n)}handleStart(){const{initialCoordinates:t}=this,{onStart:n}=this.props;t&&(this.activated=!0,this.documentListeners.add(Ee.Click,wl,{capture:!0}),this.removeTextSelection(),this.documentListeners.add(Ee.SelectionChange,this.removeTextSelection),n(t))}handleMove(t){var n;const{activated:r,initialCoordinates:o,props:s}=this,{onMove:i,options:{activationConstraint:l}}=s;if(!o)return;const c=(n=kn(t))!=null?n:Me,f=tn(o,c);if(!r&&l){if(io(l)){if(l.tolerance!=null&&Zn(f,l.tolerance))return this.handleCancel();if(Zn(f,l.distance))return this.handleStart()}if(lo(l)&&Zn(f,l.tolerance))return this.handleCancel();this.handlePending(l,f);return}t.cancelable&&t.preventDefault(),i(c)}handleEnd(){const{onAbort:t,onEnd:n}=this.props;this.detach(),this.activated||t(this.props.active),n()}handleCancel(){const{onAbort:t,onCancel:n}=this.props;this.detach(),this.activated||t(this.props.active),n()}handleKeydown(t){t.code===Q.Esc&&this.handleCancel()}removeTextSelection(){var t;(t=this.document.getSelection())==null||t.removeAllRanges()}}const Nl={cancel:{name:"pointercancel"},move:{name:"pointermove"},end:{name:"pointerup"}};class Mr extends Rr{constructor(t){const{event:n}=t,r=Ft(n.target);super(t,Nl,r)}}Mr.activators=[{eventName:"onPointerDown",handler:(e,t)=>{let{nativeEvent:n}=e,{onActivation:r}=t;return!n.isPrimary||n.button!==0?!1:(r?.({event:n}),!0)}}];const jl={move:{name:"mousemove"},end:{name:"mouseup"}};var ar;(function(e){e[e.RightClick=2]="RightClick"})(ar||(ar={}));class El extends Rr{constructor(t){super(t,jl,Ft(t.event.target))}}El.activators=[{eventName:"onMouseDown",handler:(e,t)=>{let{nativeEvent:n}=e,{onActivation:r}=t;return n.button===ar.RightClick?!1:(r?.({event:n}),!0)}}];const er={cancel:{name:"touchcancel"},move:{name:"touchmove"},end:{name:"touchend"}};class Sl extends Rr{constructor(t){super(t,er)}static setup(){return window.addEventListener(er.move.name,t,{capture:!1,passive:!1}),function(){window.removeEventListener(er.move.name,t)};function t(){}}}Sl.activators=[{eventName:"onTouchStart",handler:(e,t)=>{let{nativeEvent:n}=e,{onActivation:r}=t;const{touches:o}=n;return o.length>1?!1:(r?.({event:n}),!0)}}];var Ut;(function(e){e[e.Pointer=0]="Pointer",e[e.DraggableRect=1]="DraggableRect"})(Ut||(Ut={}));var Dn;(function(e){e[e.TreeOrder=0]="TreeOrder",e[e.ReversedTreeOrder=1]="ReversedTreeOrder"})(Dn||(Dn={}));function kl(e){let{acceleration:t,activator:n=Ut.Pointer,canScroll:r,draggingRect:o,enabled:s,interval:i=5,order:l=Dn.TreeOrder,pointerCoordinates:c,scrollableAncestors:f,scrollableAncestorRects:d,delta:p,threshold:b}=e;const v=Dl({delta:p,disabled:!s}),[w,g]=zi(),h=m.useRef({x:0,y:0}),x=m.useRef({x:0,y:0}),E=m.useMemo(()=>{switch(n){case Ut.Pointer:return c?{top:c.y,bottom:c.y,left:c.x,right:c.x}:null;case Ut.DraggableRect:return o}},[n,o,c]),C=m.useRef(null),j=m.useCallback(()=>{const O=C.current;if(!O)return;const N=h.current.x*x.current.x,S=h.current.y*x.current.y;O.scrollBy(N,S)},[]),k=m.useMemo(()=>l===Dn.TreeOrder?[...f].reverse():f,[l,f]);m.useEffect(()=>{if(!s||!f.length||!E){g();return}for(const O of k){if(r?.(O)===!1)continue;const N=f.indexOf(O),S=d[N];if(!S)continue;const{direction:R,speed:F}=hl(O,S,E,t,b);for(const P of["x","y"])v[P][R[P]]||(F[P]=0,R[P]=0);if(F.x>0||F.y>0){g(),C.current=O,w(j,i),h.current=F,x.current=R;return}}h.current={x:0,y:0},x.current={x:0,y:0},g()},[t,j,r,g,s,i,JSON.stringify(E),JSON.stringify(v),w,f,k,d,JSON.stringify(b)])}const Ol={x:{[le.Backward]:!1,[le.Forward]:!1},y:{[le.Backward]:!1,[le.Forward]:!1}};function Dl(e){let{delta:t,disabled:n}=e;const r=Sn(t);return dn(o=>{if(n||!r||!o)return Ol;const s={x:Math.sign(t.x-r.x),y:Math.sign(t.y-r.y)};return{x:{[le.Backward]:o.x[le.Backward]||s.x===-1,[le.Forward]:o.x[le.Forward]||s.x===1},y:{[le.Backward]:o.y[le.Backward]||s.y===-1,[le.Forward]:o.y[le.Forward]||s.y===1}}},[n,t,r])}function Tl(e,t){const n=t!=null?e.get(t):void 0,r=n?n.node.current:null;return dn(o=>{var s;return t==null?null:(s=r??o)!=null?s:null},[r,t])}function Rl(e,t){return m.useMemo(()=>e.reduce((n,r)=>{const{sensor:o}=r,s=o.activators.map(i=>({eventName:i.eventName,handler:t(i.handler,r)}));return[...n,...s]},[]),[e,t])}var nn;(function(e){e[e.Always=0]="Always",e[e.BeforeDragging=1]="BeforeDragging",e[e.WhileDragging=2]="WhileDragging"})(nn||(nn={}));var ir;(function(e){e.Optimized="optimized"})(ir||(ir={}));const co=new Map;function Ml(e,t){let{dragging:n,dependencies:r,config:o}=t;const[s,i]=m.useState(null),{frequency:l,measure:c,strategy:f}=o,d=m.useRef(e),p=h(),b=en(p),v=m.useCallback(function(x){x===void 0&&(x=[]),!b.current&&i(E=>E===null?x:E.concat(x.filter(C=>!E.includes(C))))},[b]),w=m.useRef(null),g=dn(x=>{if(p&&!n)return co;if(!x||x===co||d.current!==e||s!=null){const E=new Map;for(let C of e){if(!C)continue;if(s&&s.length>0&&!s.includes(C.id)&&C.rect.current){E.set(C.id,C.rect.current);continue}const j=C.node.current,k=j?new Dr(c(j),j):null;C.rect.current=k,k&&E.set(C.id,k)}return E}return x},[e,s,n,p,c]);return m.useEffect(()=>{d.current=e},[e]),m.useEffect(()=>{p||v()},[n,p]),m.useEffect(()=>{s&&s.length>0&&i(null)},[JSON.stringify(s)]),m.useEffect(()=>{p||typeof l!="number"||w.current!==null||(w.current=setTimeout(()=>{v(),w.current=null},l))},[l,p,v,...r]),{droppableRects:g,measureDroppableContainers:v,measuringScheduled:s!=null};function h(){switch(f){case nn.Always:return!1;case nn.BeforeDragging:return n;default:return!n}}}function Pr(e,t){return dn(n=>e?n||(typeof t=="function"?t(e):e):null,[t,e])}function Pl(e,t){return Pr(e,t)}function Fl(e){let{callback:t,disabled:n}=e;const r=Bn(t),o=m.useMemo(()=>{if(n||typeof window>"u"||typeof window.MutationObserver>"u")return;const{MutationObserver:s}=window;return new s(r)},[r,n]);return m.useEffect(()=>()=>o?.disconnect(),[o]),o}function qn(e){let{callback:t,disabled:n}=e;const r=Bn(t),o=m.useMemo(()=>{if(n||typeof window>"u"||typeof window.ResizeObserver>"u")return;const{ResizeObserver:s}=window;return new s(r)},[n]);return m.useEffect(()=>()=>o?.disconnect(),[o]),o}function Al(e){return new Dr(At(e),e)}function uo(e,t,n){t===void 0&&(t=Al);const[r,o]=m.useState(null);function s(){o(c=>{if(!e)return null;if(e.isConnected===!1){var f;return(f=c??n)!=null?f:null}const d=t(e);return JSON.stringify(c)===JSON.stringify(d)?c:d})}const i=Fl({callback(c){if(e)for(const f of c){const{type:d,target:p}=f;if(d==="childList"&&p instanceof HTMLElement&&p.contains(e)){s();break}}}}),l=qn({callback:s});return Re(()=>{s(),e?(l?.observe(e),i?.observe(document.body,{childList:!0,subtree:!0})):(l?.disconnect(),i?.disconnect())},[e]),r}function $l(e){const t=Pr(e);return _o(e,t)}const fo=[];function Ll(e){const t=m.useRef(e),n=dn(r=>e?r&&r!==fo&&e&&t.current&&e.parentNode===t.current.parentNode?r:Vn(e):fo,[e]);return m.useEffect(()=>{t.current=e},[e]),n}function Yl(e){const[t,n]=m.useState(null),r=m.useRef(e),o=m.useCallback(s=>{const i=Jn(s.target);i&&n(l=>l?(l.set(i,sr(i)),new Map(l)):null)},[]);return m.useEffect(()=>{const s=r.current;if(e!==s){i(s);const l=e.map(c=>{const f=Jn(c);return f?(f.addEventListener("scroll",o,{passive:!0}),[f,sr(f)]):null}).filter(c=>c!=null);n(l.length?new Map(l):null),r.current=e}return()=>{i(e),i(s)};function i(l){l.forEach(c=>{const f=Jn(c);f?.removeEventListener("scroll",o)})}},[o,e]),m.useMemo(()=>e.length?t?Array.from(t.values()).reduce((s,i)=>Ct(s,i),Me):ts(e):Me,[e,t])}function mo(e,t){t===void 0&&(t=[]);const n=m.useRef(null);return m.useEffect(()=>{n.current=null},t),m.useEffect(()=>{const r=e!==Me;r&&!n.current&&(n.current=e),!r&&n.current&&(n.current=null)},[e]),n.current?tn(e,n.current):Me}function Il(e){m.useEffect(()=>{if(!Wn)return;const t=e.map(n=>{let{sensor:r}=n;return r.setup==null?void 0:r.setup()});return()=>{for(const n of t)n?.()}},e.map(t=>{let{sensor:n}=t;return n}))}function zl(e,t){return m.useMemo(()=>e.reduce((n,r)=>{let{eventName:o,handler:s}=r;return n[o]=i=>{s(i,t)},n},{}),[e,t])}function os(e){return m.useMemo(()=>e?ul(e):null,[e])}const po=[];function Wl(e,t){t===void 0&&(t=At);const[n]=e,r=os(n?pe(n):null),[o,s]=m.useState(po);function i(){s(()=>e.length?e.map(c=>Zo(c)?r:new Dr(t(c),c)):po)}const l=qn({callback:i});return Re(()=>{l?.disconnect(),i(),e.forEach(c=>l?.observe(c))},[e]),o}function ss(e){if(!e)return null;if(e.children.length>1)return e;const t=e.children[0];return cn(t)?t:e}function Bl(e){let{measure:t}=e;const[n,r]=m.useState(null),o=m.useCallback(f=>{for(const{target:d}of f)if(cn(d)){r(p=>{const b=t(d);return p?{...p,width:b.width,height:b.height}:b});break}},[t]),s=qn({callback:o}),i=m.useCallback(f=>{const d=ss(f);s?.disconnect(),d&&s?.observe(d),r(d?t(d):null)},[t,s]),[l,c]=En(i);return m.useMemo(()=>({nodeRef:l,rect:n,setRef:c}),[n,l,c])}const Hl=[{sensor:Mr,options:{}},{sensor:Tr,options:{}}],Vl={current:{}},xn={draggable:{measure:so},droppable:{measure:so,strategy:nn.WhileDragging,frequency:ir.Optimized},dragOverlay:{measure:At}};class Qt extends Map{get(t){var n;return t!=null&&(n=super.get(t))!=null?n:void 0}toArray(){return Array.from(this.values())}getEnabled(){return this.toArray().filter(t=>{let{disabled:n}=t;return!n})}getNodeFor(t){var n,r;return(n=(r=this.get(t))==null?void 0:r.node.current)!=null?n:void 0}}const ql={activatorEvent:null,active:null,activeNode:null,activeNodeRect:null,collisions:null,containerNodeRect:null,draggableNodes:new Map,droppableRects:new Map,droppableContainers:new Qt,over:null,dragOverlay:{nodeRef:{current:null},rect:null,setRef:On},scrollableAncestors:[],scrollableAncestorRects:[],measuringConfiguration:xn,measureDroppableContainers:On,windowRect:null,measuringScheduled:!1},as={activatorEvent:null,activators:[],active:null,activeNodeRect:null,ariaDescribedById:{draggable:""},dispatch:On,draggableNodes:new Map,over:null,measureDroppableContainers:On},fn=m.createContext(as),is=m.createContext(ql);function Gl(){return{draggable:{active:null,initialCoordinates:{x:0,y:0},nodes:new Map,translate:{x:0,y:0}},droppable:{containers:new Qt}}}function Xl(e,t){switch(t.type){case se.DragStart:return{...e,draggable:{...e.draggable,initialCoordinates:t.initialCoordinates,active:t.active}};case se.DragMove:return e.draggable.active==null?e:{...e,draggable:{...e.draggable,translate:{x:t.coordinates.x-e.draggable.initialCoordinates.x,y:t.coordinates.y-e.draggable.initialCoordinates.y}}};case se.DragEnd:case se.DragCancel:return{...e,draggable:{...e.draggable,active:null,initialCoordinates:{x:0,y:0},translate:{x:0,y:0}}};case se.RegisterDroppable:{const{element:n}=t,{id:r}=n,o=new Qt(e.droppable.containers);return o.set(r,n),{...e,droppable:{...e.droppable,containers:o}}}case se.SetDroppableDisabled:{const{id:n,key:r,disabled:o}=t,s=e.droppable.containers.get(n);if(!s||r!==s.key)return e;const i=new Qt(e.droppable.containers);return i.set(n,{...s,disabled:o}),{...e,droppable:{...e.droppable,containers:i}}}case se.UnregisterDroppable:{const{id:n,key:r}=t,o=e.droppable.containers.get(n);if(!o||r!==o.key)return e;const s=new Qt(e.droppable.containers);return s.delete(n),{...e,droppable:{...e.droppable,containers:s}}}default:return e}}function _l(e){let{disabled:t}=e;const{active:n,activatorEvent:r,draggableNodes:o}=m.useContext(fn),s=Sn(r),i=Sn(n?.id);return m.useEffect(()=>{if(!t&&!r&&s&&i!=null){if(!Hn(s)||document.activeElement===s.target)return;const l=o.get(i);if(!l)return;const{activatorNode:c,node:f}=l;if(!c.current&&!f.current)return;requestAnimationFrame(()=>{for(const d of[c.current,f.current]){if(!d)continue;const p=Hi(d);if(p){p.focus();break}}})}},[r,t,o,i,s]),null}function ls(e,t){let{transform:n,...r}=t;return e!=null&&e.length?e.reduce((o,s)=>s({transform:o,...r}),n):n}function Kl(e){return m.useMemo(()=>({draggable:{...xn.draggable,...e?.draggable},droppable:{...xn.droppable,...e?.droppable},dragOverlay:{...xn.dragOverlay,...e?.dragOverlay}}),[e?.draggable,e?.droppable,e?.dragOverlay])}function Ul(e){let{activeNode:t,measure:n,initialRect:r,config:o=!0}=e;const s=m.useRef(!1),{x:i,y:l}=typeof o=="boolean"?{x:o,y:o}:o;Re(()=>{if(!i&&!l||!t){s.current=!1;return}if(s.current||!r)return;const f=t?.node.current;if(!f||f.isConnected===!1)return;const d=n(f),p=_o(d,r);if(i||(p.x=0),l||(p.y=0),s.current=!0,Math.abs(p.x)>0||Math.abs(p.y)>0){const b=Uo(f);b&&b.scrollBy({top:p.y,left:p.x})}},[t,i,l,r,n])}const Gn=m.createContext({...Me,scaleX:1,scaleY:1});var Je;(function(e){e[e.Uninitialized=0]="Uninitialized",e[e.Initializing=1]="Initializing",e[e.Initialized=2]="Initialized"})(Je||(Je={}));const Ql=m.memo(function(t){var n,r,o,s;let{id:i,accessibility:l,autoScroll:c=!0,children:f,sensors:d=Hl,collisionDetection:p=sl,measuring:b,modifiers:v,...w}=t;const g=m.useReducer(Xl,void 0,Gl),[h,x]=g,[E,C]=Ki(),[j,k]=m.useState(Je.Uninitialized),O=j===Je.Initialized,{draggable:{active:N,nodes:S,translate:R},droppable:{containers:F}}=h,P=N!=null?S.get(N):null,A=m.useRef({initial:null,translated:null}),Y=m.useMemo(()=>{var fe;return N!=null?{id:N,data:(fe=P?.data)!=null?fe:Vl,rect:A}:null},[N,P]),Z=m.useRef(null),[H,te]=m.useState(null),[G,ie]=m.useState(null),I=en(w,Object.values(w)),L=un("DndDescribedBy",i),K=m.useMemo(()=>F.getEnabled(),[F]),D=Kl(b),{droppableRects:M,measureDroppableContainers:$,measuringScheduled:X}=Ml(K,{dragging:O,dependencies:[R.x,R.y],config:D.droppable}),T=Tl(S,N),U=m.useMemo(()=>G?kn(G):null,[G]),W=Es(),oe=Pl(T,D.draggable.measure);Ul({activeNode:N!=null?S.get(N):null,config:W.layoutShiftCompensation,initialRect:oe,measure:D.draggable.measure});const _=uo(T,D.draggable.measure,oe),Ne=uo(T?T.parentElement:null),he=m.useRef({activatorEvent:null,active:null,activeNode:T,collisionRect:null,collisions:null,droppableRects:M,draggableNodes:S,draggingNode:null,draggingNodeRect:null,droppableContainers:F,over:null,scrollableAncestors:[],scrollAdjustedTranslate:null}),B=F.getNodeFor((n=he.current.over)==null?void 0:n.id),ee=Bl({measure:D.dragOverlay.measure}),re=(r=ee.nodeRef.current)!=null?r:T,ce=O?(o=ee.rect)!=null?o:_:null,Te=!!(ee.nodeRef.current&&ee.rect),Ge=$l(Te?null:_),$t=os(re?pe(re):null),ue=Ll(O?B??T:null),Ie=Wl(ue),it=ls(v,{transform:{x:R.x-Ge.x,y:R.y-Ge.y,scaleX:1,scaleY:1},activatorEvent:G,active:Y,activeNodeRect:_,containerNodeRect:Ne,draggingNodeRect:ce,over:he.current.over,overlayNodeRect:ee.rect,scrollableAncestors:ue,scrollableAncestorRects:Ie,windowRect:$t}),Lt=U?Ct(U,R):null,ht=Yl(ue),mn=mo(ht),pn=mo(ht,[_]),ze=Ct(it,mn),We=ce?ll(ce,it):null,Yt=Y&&We?p({active:Y,collisionRect:We,droppableRects:M,droppableContainers:K,pointerCoordinates:Lt}):null,Ar=Xo(Yt,"id"),[Xe,$r]=m.useState(null),xs=Te?it:Ct(it,pn),ws=al(xs,(s=Xe?.rect)!=null?s:null,_),_n=m.useRef(null),Lr=m.useCallback((fe,ye)=>{let{sensor:xe,options:_e}=ye;if(Z.current==null)return;const je=S.get(Z.current);if(!je)return;const we=fe.nativeEvent,Fe=new xe({active:Z.current,activeNode:je,event:we,options:_e,context:he,onAbort(de){if(!S.get(de))return;const{onDragAbort:Ae}=I.current,Be={id:de};Ae?.(Be),E({type:"onDragAbort",event:Be})},onPending(de,Ke,Ae,Be){if(!S.get(de))return;const{onDragPending:zt}=I.current,Ue={id:de,constraint:Ke,initialCoordinates:Ae,offset:Be};zt?.(Ue),E({type:"onDragPending",event:Ue})},onStart(de){const Ke=Z.current;if(Ke==null)return;const Ae=S.get(Ke);if(!Ae)return;const{onDragStart:Be}=I.current,It={activatorEvent:we,active:{id:Ke,data:Ae.data,rect:A}};wt.unstable_batchedUpdates(()=>{Be?.(It),k(Je.Initializing),x({type:se.DragStart,initialCoordinates:de,active:Ke}),E({type:"onDragStart",event:It}),te(_n.current),ie(we)})},onMove(de){x({type:se.DragMove,coordinates:de})},onEnd:gt(se.DragEnd),onCancel:gt(se.DragCancel)});_n.current=Fe;function gt(de){return async function(){const{active:Ae,collisions:Be,over:It,scrollAdjustedTranslate:zt}=he.current;let Ue=null;if(Ae&&zt){const{cancelDrop:Wt}=I.current;Ue={activatorEvent:we,active:Ae,collisions:Be,delta:zt,over:It},de===se.DragEnd&&typeof Wt=="function"&&await Promise.resolve(Wt(Ue))&&(de=se.DragCancel)}Z.current=null,wt.unstable_batchedUpdates(()=>{x({type:de}),k(Je.Uninitialized),$r(null),te(null),ie(null),_n.current=null;const Wt=de===se.DragEnd?"onDragEnd":"onDragCancel";if(Ue){const Kn=I.current[Wt];Kn?.(Ue),E({type:Wt,event:Ue})}})}}},[S]),Cs=m.useCallback((fe,ye)=>(xe,_e)=>{const je=xe.nativeEvent,we=S.get(_e);if(Z.current!==null||!we||je.dndKit||je.defaultPrevented)return;const Fe={active:we};fe(xe,ye.options,Fe)===!0&&(je.dndKit={capturedBy:ye.sensor},Z.current=_e,Lr(xe,ye))},[S,Lr]),Yr=Rl(d,Cs);Il(d),Re(()=>{_&&j===Je.Initializing&&k(Je.Initialized)},[_,j]),m.useEffect(()=>{const{onDragMove:fe}=I.current,{active:ye,activatorEvent:xe,collisions:_e,over:je}=he.current;if(!ye||!xe)return;const we={active:ye,activatorEvent:xe,collisions:_e,delta:{x:ze.x,y:ze.y},over:je};wt.unstable_batchedUpdates(()=>{fe?.(we),E({type:"onDragMove",event:we})})},[ze.x,ze.y]),m.useEffect(()=>{const{active:fe,activatorEvent:ye,collisions:xe,droppableContainers:_e,scrollAdjustedTranslate:je}=he.current;if(!fe||Z.current==null||!ye||!je)return;const{onDragOver:we}=I.current,Fe=_e.get(Ar),gt=Fe&&Fe.rect.current?{id:Fe.id,rect:Fe.rect.current,data:Fe.data,disabled:Fe.disabled}:null,de={active:fe,activatorEvent:ye,collisions:xe,delta:{x:je.x,y:je.y},over:gt};wt.unstable_batchedUpdates(()=>{$r(gt),we?.(de),E({type:"onDragOver",event:de})})},[Ar]),Re(()=>{he.current={activatorEvent:G,active:Y,activeNode:T,collisionRect:We,collisions:Yt,droppableRects:M,draggableNodes:S,draggingNode:re,draggingNodeRect:ce,droppableContainers:F,over:Xe,scrollableAncestors:ue,scrollAdjustedTranslate:ze},A.current={initial:ce,translated:We}},[Y,T,Yt,We,S,re,ce,M,F,Xe,ue,ze]),kl({...W,delta:R,draggingRect:We,pointerCoordinates:Lt,scrollableAncestors:ue,scrollableAncestorRects:Ie});const Ns=m.useMemo(()=>({active:Y,activeNode:T,activeNodeRect:_,activatorEvent:G,collisions:Yt,containerNodeRect:Ne,dragOverlay:ee,draggableNodes:S,droppableContainers:F,droppableRects:M,over:Xe,measureDroppableContainers:$,scrollableAncestors:ue,scrollableAncestorRects:Ie,measuringConfiguration:D,measuringScheduled:X,windowRect:$t}),[Y,T,_,G,Yt,Ne,ee,S,F,M,Xe,$,ue,Ie,D,X,$t]),js=m.useMemo(()=>({activatorEvent:G,activators:Yr,active:Y,activeNodeRect:_,ariaDescribedById:{draggable:L},dispatch:x,draggableNodes:S,over:Xe,measureDroppableContainers:$}),[G,Yr,Y,_,x,L,S,Xe,$]);return y.createElement(Vo.Provider,{value:C},y.createElement(fn.Provider,{value:js},y.createElement(is.Provider,{value:Ns},y.createElement(Gn.Provider,{value:ws},f)),y.createElement(_l,{disabled:l?.restoreFocus===!1})),y.createElement(Ji,{...l,hiddenTextDescribedById:L}));function Es(){const fe=H?.autoScrollEnabled===!1,ye=typeof c=="object"?c.enabled===!1:c===!1,xe=O&&!fe&&!ye;return typeof c=="object"?{...c,enabled:xe}:{enabled:xe}}}),Jl=m.createContext(null),ho="button",Zl="Draggable";function ec(e){let{id:t,data:n,disabled:r=!1,attributes:o}=e;const s=un(Zl),{activators:i,activatorEvent:l,active:c,activeNodeRect:f,ariaDescribedById:d,draggableNodes:p,over:b}=m.useContext(fn),{role:v=ho,roleDescription:w="draggable",tabIndex:g=0}=o??{},h=c?.id===t,x=m.useContext(h?Gn:Jl),[E,C]=En(),[j,k]=En(),O=zl(i,t),N=en(n);Re(()=>(p.set(t,{id:t,key:s,node:E,activatorNode:j,data:N}),()=>{const R=p.get(t);R&&R.key===s&&p.delete(t)}),[p,t]);const S=m.useMemo(()=>({role:v,tabIndex:g,"aria-disabled":r,"aria-pressed":h&&v===ho?!0:void 0,"aria-roledescription":w,"aria-describedby":d.draggable}),[r,v,g,h,w,d.draggable]);return{active:c,activatorEvent:l,activeNodeRect:f,attributes:S,isDragging:h,listeners:r?void 0:O,node:E,over:b,setNodeRef:C,setActivatorNodeRef:k,transform:x}}function cs(){return m.useContext(is)}const tc="Droppable",nc={timeout:25};function ds(e){let{data:t,disabled:n=!1,id:r,resizeObserverConfig:o}=e;const s=un(tc),{active:i,dispatch:l,over:c,measureDroppableContainers:f}=m.useContext(fn),d=m.useRef({disabled:n}),p=m.useRef(!1),b=m.useRef(null),v=m.useRef(null),{disabled:w,updateMeasurementsFor:g,timeout:h}={...nc,...o},x=en(g??r),E=m.useCallback(()=>{if(!p.current){p.current=!0;return}v.current!=null&&clearTimeout(v.current),v.current=setTimeout(()=>{f(Array.isArray(x.current)?x.current:[x.current]),v.current=null},h)},[h]),C=qn({callback:E,disabled:w||!i}),j=m.useCallback((S,R)=>{C&&(R&&(C.unobserve(R),p.current=!1),S&&C.observe(S))},[C]),[k,O]=En(j),N=en(t);return m.useEffect(()=>{!C||!k.current||(C.disconnect(),p.current=!1,C.observe(k.current))},[k,C]),m.useEffect(()=>(l({type:se.RegisterDroppable,element:{id:r,key:s,disabled:n,node:k,rect:b,data:N}}),()=>l({type:se.UnregisterDroppable,key:s,id:r})),[r]),m.useEffect(()=>{n!==d.current.disabled&&(l({type:se.SetDroppableDisabled,id:r,key:s,disabled:n}),d.current.disabled=n)},[r,s,n,l]),{active:i,rect:b,isOver:c?.id===r,node:k,over:c,setNodeRef:O}}function rc(e){let{animation:t,children:n}=e;const[r,o]=m.useState(null),[s,i]=m.useState(null),l=Sn(n);return!n&&!r&&l&&o(l),Re(()=>{if(!s)return;const c=r?.key,f=r?.props.id;if(c==null||f==null){o(null);return}Promise.resolve(t(f,s)).then(()=>{o(null)})},[t,r,s]),y.createElement(y.Fragment,null,n,r?m.cloneElement(r,{ref:i}):null)}const oc={x:0,y:0,scaleX:1,scaleY:1};function sc(e){let{children:t}=e;return y.createElement(fn.Provider,{value:as},y.createElement(Gn.Provider,{value:oc},t))}const ac={position:"fixed",touchAction:"none"},ic=e=>Hn(e)?"transform 250ms ease":void 0,lc=m.forwardRef((e,t)=>{let{as:n,activatorEvent:r,adjustScale:o,children:s,className:i,rect:l,style:c,transform:f,transition:d=ic}=e;if(!l)return null;const p=o?f:{...f,scaleX:1,scaleY:1},b={...ac,width:l.width,height:l.height,top:l.top,left:l.left,transform:et.Transform.toString(p),transformOrigin:o&&r?el(r,l):void 0,transition:typeof d=="function"?d(r):d,...c};return y.createElement(n,{className:i,style:b,ref:t},s)}),cc=e=>t=>{let{active:n,dragOverlay:r}=t;const o={},{styles:s,className:i}=e;if(s!=null&&s.active)for(const[l,c]of Object.entries(s.active))c!==void 0&&(o[l]=n.node.style.getPropertyValue(l),n.node.style.setProperty(l,c));if(s!=null&&s.dragOverlay)for(const[l,c]of Object.entries(s.dragOverlay))c!==void 0&&r.node.style.setProperty(l,c);return i!=null&&i.active&&n.node.classList.add(i.active),i!=null&&i.dragOverlay&&r.node.classList.add(i.dragOverlay),function(){for(const[c,f]of Object.entries(o))n.node.style.setProperty(c,f);i!=null&&i.active&&n.node.classList.remove(i.active)}},dc=e=>{let{transform:{initial:t,final:n}}=e;return[{transform:et.Transform.toString(t)},{transform:et.Transform.toString(n)}]},uc={duration:250,easing:"ease",keyframes:dc,sideEffects:cc({styles:{active:{opacity:"0"}}})};function fc(e){let{config:t,draggableNodes:n,droppableContainers:r,measuringConfiguration:o}=e;return Bn((s,i)=>{if(t===null)return;const l=n.get(s);if(!l)return;const c=l.node.current;if(!c)return;const f=ss(i);if(!f)return;const{transform:d}=pe(i).getComputedStyle(i),p=Ko(d);if(!p)return;const b=typeof t=="function"?t:mc(t);return ns(c,o.draggable.measure),b({active:{id:s,data:l.data,node:c,rect:o.draggable.measure(c)},draggableNodes:n,dragOverlay:{node:i,rect:o.dragOverlay.measure(f)},droppableContainers:r,measuringConfiguration:o,transform:p})})}function mc(e){const{duration:t,easing:n,sideEffects:r,keyframes:o}={...uc,...e};return s=>{let{active:i,dragOverlay:l,transform:c,...f}=s;if(!t)return;const d={x:l.rect.left-i.rect.left,y:l.rect.top-i.rect.top},p={scaleX:c.scaleX!==1?i.rect.width*c.scaleX/l.rect.width:1,scaleY:c.scaleY!==1?i.rect.height*c.scaleY/l.rect.height:1},b={x:c.x-d.x,y:c.y-d.y,...p},v=o({...f,active:i,dragOverlay:l,transform:{initial:c,final:b}}),[w]=v,g=v[v.length-1];if(JSON.stringify(w)===JSON.stringify(g))return;const h=r?.({active:i,dragOverlay:l,...f}),x=l.node.animate(v,{duration:t,easing:n,fill:"forwards"});return new Promise(E=>{x.onfinish=()=>{h?.(),E()}})}}let go=0;function pc(e){return m.useMemo(()=>{if(e!=null)return go++,go},[e])}const hc=y.memo(e=>{let{adjustScale:t=!1,children:n,dropAnimation:r,style:o,transition:s,modifiers:i,wrapperElement:l="div",className:c,zIndex:f=999}=e;const{activatorEvent:d,active:p,activeNodeRect:b,containerNodeRect:v,draggableNodes:w,droppableContainers:g,dragOverlay:h,over:x,measuringConfiguration:E,scrollableAncestors:C,scrollableAncestorRects:j,windowRect:k}=cs(),O=m.useContext(Gn),N=pc(p?.id),S=ls(i,{activatorEvent:d,active:p,activeNodeRect:b,containerNodeRect:v,draggingNodeRect:h.rect,over:x,overlayNodeRect:h.rect,scrollableAncestors:C,scrollableAncestorRects:j,transform:O,windowRect:k}),R=Pr(b),F=fc({config:r,draggableNodes:w,droppableContainers:g,measuringConfiguration:E}),P=R?h.setRef:void 0;return y.createElement(sc,null,y.createElement(rc,{animation:F},p&&N?y.createElement(lc,{key:N,id:p.id,ref:P,as:l,activatorEvent:d,adjustScale:t,className:c,transition:s,rect:R,style:{zIndex:f,...o},transform:S},n):null))});function Fr(e,t,n){const r=e.slice();return r.splice(n<0?r.length+n:n,0,r.splice(t,1)[0]),r}function gc(e,t){return e.reduce((n,r,o)=>{const s=t.get(r);return s&&(n[o]=s),n},Array(e.length))}function vn(e){return e!==null&&e>=0}function vc(e,t){if(e===t)return!0;if(e.length!==t.length)return!1;for(let n=0;n<e.length;n++)if(e[n]!==t[n])return!1;return!0}function bc(e){return typeof e=="boolean"?{draggable:e,droppable:e}:e}const us=e=>{let{rects:t,activeIndex:n,overIndex:r,index:o}=e;const s=Fr(t,r,n),i=t[o],l=s[o];return!l||!i?null:{x:l.left-i.left,y:l.top-i.top,scaleX:l.width/i.width,scaleY:l.height/i.height}},bn={scaleX:1,scaleY:1},yc=e=>{var t;let{activeIndex:n,activeNodeRect:r,index:o,rects:s,overIndex:i}=e;const l=(t=s[n])!=null?t:r;if(!l)return null;if(o===n){const f=s[i];return f?{x:0,y:n<i?f.top+f.height-(l.top+l.height):f.top-l.top,...bn}:null}const c=xc(s,o,n);return o>n&&o<=i?{x:0,y:-l.height-c,...bn}:o<n&&o>=i?{x:0,y:l.height+c,...bn}:{x:0,y:0,...bn}};function xc(e,t,n){const r=e[t],o=e[t-1],s=e[t+1];return r?n<t?o?r.top-(o.top+o.height):s?s.top-(r.top+r.height):0:s?s.top-(r.top+r.height):o?r.top-(o.top+o.height):0:0}const fs="Sortable",ms=y.createContext({activeIndex:-1,containerId:fs,disableTransforms:!1,items:[],overIndex:-1,useDragOverlay:!1,sortedRects:[],strategy:us,disabled:{draggable:!1,droppable:!1}});function wc(e){let{children:t,id:n,items:r,strategy:o=us,disabled:s=!1}=e;const{active:i,dragOverlay:l,droppableRects:c,over:f,measureDroppableContainers:d}=cs(),p=un(fs,n),b=l.rect!==null,v=m.useMemo(()=>r.map(O=>typeof O=="object"&&"id"in O?O.id:O),[r]),w=i!=null,g=i?v.indexOf(i.id):-1,h=f?v.indexOf(f.id):-1,x=m.useRef(v),E=!vc(v,x.current),C=h!==-1&&g===-1||E,j=bc(s);Re(()=>{E&&w&&d(v)},[E,v,w,d]),m.useEffect(()=>{x.current=v},[v]);const k=m.useMemo(()=>({activeIndex:g,containerId:p,disabled:j,disableTransforms:C,items:v,overIndex:h,useDragOverlay:b,sortedRects:gc(v,c),strategy:o}),[g,p,j.draggable,j.droppable,C,v,h,c,b,o]);return y.createElement(ms.Provider,{value:k},t)}const Cc=e=>{let{id:t,items:n,activeIndex:r,overIndex:o}=e;return Fr(n,r,o).indexOf(t)},Nc=e=>{let{containerId:t,isSorting:n,wasDragging:r,index:o,items:s,newIndex:i,previousItems:l,previousContainerId:c,transition:f}=e;return!f||!r||l!==s&&o===i?!1:n?!0:i!==o&&t===c},jc={duration:200,easing:"ease"},ps="transform",Ec=et.Transition.toString({property:ps,duration:0,easing:"linear"}),Sc={roleDescription:"sortable"};function kc(e){let{disabled:t,index:n,node:r,rect:o}=e;const[s,i]=m.useState(null),l=m.useRef(n);return Re(()=>{if(!t&&n!==l.current&&r.current){const c=o.current;if(c){const f=At(r.current,{ignoreTransform:!0}),d={x:c.left-f.left,y:c.top-f.top,scaleX:c.width/f.width,scaleY:c.height/f.height};(d.x||d.y)&&i(d)}}n!==l.current&&(l.current=n)},[t,n,r,o]),m.useEffect(()=>{s&&i(null)},[s]),s}function Oc(e){let{animateLayoutChanges:t=Nc,attributes:n,disabled:r,data:o,getNewIndex:s=Cc,id:i,strategy:l,resizeObserverConfig:c,transition:f=jc}=e;const{items:d,containerId:p,activeIndex:b,disabled:v,disableTransforms:w,sortedRects:g,overIndex:h,useDragOverlay:x,strategy:E}=m.useContext(ms),C=Dc(r,v),j=d.indexOf(i),k=m.useMemo(()=>({sortable:{containerId:p,index:j,items:d},...o}),[p,o,j,d]),O=m.useMemo(()=>d.slice(d.indexOf(i)),[d,i]),{rect:N,node:S,isOver:R,setNodeRef:F}=ds({id:i,data:k,disabled:C.droppable,resizeObserverConfig:{updateMeasurementsFor:O,...c}}),{active:P,activatorEvent:A,activeNodeRect:Y,attributes:Z,setNodeRef:H,listeners:te,isDragging:G,over:ie,setActivatorNodeRef:I,transform:L}=ec({id:i,data:k,attributes:{...Sc,...n},disabled:C.draggable}),K=Ii(F,H),D=!!P,M=D&&!w&&vn(b)&&vn(h),$=!x&&G,X=$&&M?L:null,U=M?X??(l??E)({rects:g,activeNodeRect:Y,activeIndex:b,overIndex:h,index:j}):null,W=vn(b)&&vn(h)?s({id:i,items:d,activeIndex:b,overIndex:h}):j,oe=P?.id,_=m.useRef({activeId:oe,items:d,newIndex:W,containerId:p}),Ne=d!==_.current.items,he=t({active:P,containerId:p,isDragging:G,isSorting:D,id:i,index:j,items:d,newIndex:_.current.newIndex,previousItems:_.current.items,previousContainerId:_.current.containerId,transition:f,wasDragging:_.current.activeId!=null}),B=kc({disabled:!he,index:j,node:S,rect:N});return m.useEffect(()=>{D&&_.current.newIndex!==W&&(_.current.newIndex=W),p!==_.current.containerId&&(_.current.containerId=p),d!==_.current.items&&(_.current.items=d)},[D,W,p,d]),m.useEffect(()=>{if(oe===_.current.activeId)return;if(oe!=null&&_.current.activeId==null){_.current.activeId=oe;return}const re=setTimeout(()=>{_.current.activeId=oe},50);return()=>clearTimeout(re)},[oe]),{active:P,activeIndex:b,attributes:Z,data:k,rect:N,index:j,newIndex:W,items:d,isOver:R,isSorting:D,isDragging:G,listeners:te,node:S,overIndex:h,over:ie,setNodeRef:K,setActivatorNodeRef:I,setDroppableNodeRef:F,setDraggableNodeRef:H,transform:B??U,transition:ee()};function ee(){if(B||Ne&&_.current.newIndex===j)return Ec;if(!($&&!Hn(A)||!f)&&(D||he))return et.Transition.toString({...f,property:ps})}}function Dc(e,t){var n,r;return typeof e=="boolean"?{draggable:e,droppable:!1}:{draggable:(n=e?.draggable)!=null?n:t.draggable,droppable:(r=e?.droppable)!=null?r:t.droppable}}function Tn(e){if(!e)return!1;const t=e.data.current;return!!(t&&"sortable"in t&&typeof t.sortable=="object"&&"containerId"in t.sortable&&"items"in t.sortable&&"index"in t.sortable)}const Tc=[Q.Down,Q.Right,Q.Up,Q.Left],Rc=(e,t)=>{let{context:{active:n,collisionRect:r,droppableRects:o,droppableContainers:s,over:i,scrollableAncestors:l}}=t;if(Tc.includes(e.code)){if(e.preventDefault(),!n||!r)return;const c=[];s.getEnabled().forEach(p=>{if(!p||p!=null&&p.disabled)return;const b=o.get(p.id);if(b)switch(e.code){case Q.Down:r.top<b.top&&c.push(p);break;case Q.Up:r.top>b.top&&c.push(p);break;case Q.Left:r.left>b.left&&c.push(p);break;case Q.Right:r.left<b.left&&c.push(p);break}});const f=rl({collisionRect:r,droppableRects:o,droppableContainers:c});let d=Xo(f,"id");if(d===i?.id&&f.length>1&&(d=f[1].id),d!=null){const p=s.get(n.id),b=s.get(d),v=b?o.get(b.id):null,w=b?.node.current;if(w&&v&&p&&b){const h=Vn(w).some((O,N)=>l[N]!==O),x=hs(p,b),E=Mc(p,b),C=h||!x?{x:0,y:0}:{x:E?r.width-v.width:0,y:E?r.height-v.height:0},j={x:v.left,y:v.top};return C.x&&C.y?j:tn(j,C)}}}};function hs(e,t){return!Tn(e)||!Tn(t)?!1:e.data.current.sortable.containerId===t.data.current.sortable.containerId}function Mc(e,t){return!Tn(e)||!Tn(t)||!hs(e,t)?!1:e.data.current.sortable.index<t.data.current.sortable.index}const Pc=({id:e,name:t,onRemove:n,onSettings:r,showSettings:o=!1,onEdit:s,showEdit:i=!1,onDelete:l,showDelete:c=!1,onFormat:f,showFormat:d=!1,onNumberFormat:p,showNumberFormat:b=!1})=>{const{attributes:v,listeners:w,setNodeRef:g,transform:h,transition:x,isDragging:E}=Oc({id:e}),C={transform:et.Transform.toString(h),transition:x,opacity:E?.5:1};return a.jsxs("div",{ref:g,style:C,className:"flex items-center justify-between p-2 mb-2 bg-white border rounded shadow-sm group",children:[a.jsxs("div",{className:"flex items-center flex-1 min-w-0",children:[a.jsx("div",{...v,...w,className:"cursor-grab mr-2 text-gray-400 hover:text-gray-600",children:a.jsx(Ei,{size:16})}),a.jsx("span",{className:"truncate text-sm font-medium text-gray-700",title:t,children:t})]}),a.jsxs("div",{className:"flex items-center gap-1 transition-opacity",children:[d&&f&&a.jsx(J,{color:"light",size:"sm",className:"p-1 text-gray-500 hover:text-purple-500",onClick:f,title:"Conditional Formatting",children:a.jsx(Mi,{size:14})}),b&&p&&a.jsx(J,{color:"light",size:"sm",className:"p-1 text-gray-500 hover:text-epsilon-blue",onClick:p,title:"Number/Date Format",children:a.jsx(ki,{size:14})}),i&&s&&a.jsx(J,{color:"light",size:"sm",className:"p-1 text-gray-500 hover:text-epsilon-blue",onClick:s,title:"Edit Formula",children:a.jsx(Wo,{size:14})}),o&&r&&a.jsx(J,{color:"light",size:"sm",className:"p-1 text-gray-500 hover:text-epsilon-blue",onClick:r,children:a.jsx(zn,{size:14})}),c&&l&&a.jsx(J,{color:"light",size:"sm",className:"p-1 text-gray-500 hover:text-red-500",onClick:l,title:"Delete Field",children:a.jsx(jn,{size:14})}),n&&a.jsx(J,{color:"light",size:"sm",className:"p-1 text-gray-500 hover:text-red-500",onClick:n,children:a.jsx(jn,{size:14})})]})]})},Fc=({groups:e,valueColumns:t,onAddGroup:n,onRemoveGroup:r,onUpdateGroup:o})=>{const[s,i]=m.useState(null),[l,c]=m.useState(""),[f,d]=m.useState([]),p=h=>{d(x=>x.includes(h)?x.filter(E=>E!==h):[...x,h])},b=h=>{i(h.id),c(h.name)},v=h=>{l.trim()&&o(h,{name:l.trim()}),i(null)},w=(h,x)=>{const E=e.find(C=>C.id===h);E&&!E.fields.includes(x)&&o(h,{fields:[...E.fields,x]})},g=(h,x)=>{const E=e.find(C=>C.id===h);E&&o(h,{fields:E.fields.filter(C=>C!==x)})};return a.jsxs("div",{className:"space-y-4",children:[a.jsx("div",{className:"flex justify-end mb-4",children:a.jsxs(J,{color:"primary",variant:"outline",size:"sm",className:"flex items-center gap-1 hover:bg-primary hover:text-white transition-colors",onClick:()=>{n()},children:[a.jsx(Nn,{size:16})," New Group"]})}),a.jsx("div",{className:e.length===0?"p-0":"bg-gray-50/30 rounded-lg",children:e.length===0?a.jsxs("div",{className:"text-center py-10 px-4 border-2 border-dashed border-gray-200 rounded-xl bg-gray-50",children:[a.jsx("div",{className:"bg-blue-50 w-12 h-12 rounded-full flex items-center justify-center mx-auto mb-3",children:a.jsx(zo,{className:"text-epsilon-blue",size:24})}),a.jsx("h6",{className:"text-gray-600 font-medium mb-1",children:"No Groups Created"}),a.jsx("p",{className:"text-gray-400 text-sm max-w-xs mx-auto mb-4",children:"Create groups to organize your value columns hierarchically."}),a.jsx(J,{color:"primary",size:"sm",onClick:n,children:"Create First Group"})]}):a.jsx("div",{className:"space-y-3",children:e.map(h=>{const x=f.includes(h.id),E=t.filter(C=>!h.fields.includes(C.id));return a.jsxs("div",{className:`bg-white rounded-lg border transition-all duration-200 ${x?"border-blue-200 shadow-md ring-1 ring-blue-50":"border-gray-200 hover:border-blue-200"}`,children:[a.jsxs("div",{className:"p-3 flex items-center justify-between cursor-pointer select-none",onClick:()=>p(h.id),children:[a.jsxs("div",{className:"flex items-center gap-3 flex-1",children:[a.jsx("div",{className:`p-1.5 rounded-md transition-colors ${x?"bg-blue-50 text-epsilon-blue":"bg-gray-100 text-gray-500"}`,children:x?a.jsx(Ni,{size:16}):a.jsx(wi,{size:16})}),s===h.id?a.jsxs("div",{className:"flex items-center gap-2 flex-1 max-w-md",onClick:C=>C.stopPropagation(),children:[a.jsx(ge,{autoFocus:!0,size:"sm",value:l,onChange:C=>c(C.target.value),onKeyDown:C=>{C.key==="Enter"&&v(h.id),C.key==="Escape"&&i(null)},className:"font-medium"}),a.jsx(J,{color:"success",size:"sm",variant:"ghost",onClick:()=>v(h.id),children:a.jsx(yi,{size:16})}),a.jsx(J,{color:"secondary",size:"sm",variant:"ghost",onClick:()=>i(null),children:a.jsx(jn,{size:16})})]}):a.jsxs("div",{className:"flex items-center gap-2 group",children:[a.jsx("span",{className:"font-semibold text-gray-700",children:h.name}),a.jsxs("span",{className:"text-xs text-gray-400 bg-gray-100 px-2 py-0.5 rounded-full",children:[h.fields.length," fields"]}),a.jsx(J,{color:"secondary",variant:"ghost",size:"sm",className:"text-gray-400 hover:text-epsilon-blue p-1",onClick:C=>{C.stopPropagation(),b(h)},children:a.jsx(Wo,{size:14})})]})]}),a.jsx(J,{color:"danger",variant:"ghost",size:"sm",className:"text-gray-400 hover:text-red-500 hover:bg-red-50",onClick:C=>{C.stopPropagation(),r(h.id)},children:a.jsx(Sr,{size:16})})]}),x&&a.jsx("div",{className:"px-4 pb-4 pt-1 border-t border-gray-50",children:a.jsxs("div",{className:"mt-3 flex flex-wrap gap-2 min-h-[40px] items-center",children:[h.fields.map(C=>{const j=t.find(k=>k.id===C);return a.jsxs(gr,{color:"info",shape:"rounded-pill",className:"flex items-center gap-2 pl-3 pr-2 py-1.5 bg-blue-50 text-blue-700 border border-blue-100 font-medium",children:[j?j.name:C,a.jsx("div",{className:"hover:bg-blue-200 rounded-full p-0.5 cursor-pointer transition-colors",onClick:()=>g(h.id,C),children:a.jsx(jn,{size:12})})]},C)}),a.jsxs(Fn,{className:"inline-block",children:[a.jsxs($n,{color:"secondary",variant:"ghost",size:"sm",className:"text-xs font-medium text-gray-500 hover:text-epsilon-blue border border-dashed border-gray-300 hover:border-epsilon-blue rounded-full px-3",children:[a.jsx(Nn,{size:12,className:"inline mr-1"})," Add Field"]}),a.jsx(An,{className:"max-h-60 overflow-y-auto shadow-lg border-gray-100",children:E.length===0?a.jsx(Ze,{disabled:!0,className:"text-xs text-gray-400",children:"No more value fields available"}):E.map(C=>a.jsx(Ze,{onClick:()=>w(h.id,C.id),className:"text-sm cursor-pointer hover:bg-blue-50",children:C.name},C.id))})]})]})})]},h.id)})})})]})},Ac=({visible:e,onClose:t,onSave:n,column:r,section:o})=>{const[s,i]=m.useState([]),[l,c]=m.useState(null);m.useEffect(()=>{e&&r&&(i(r.conditionalFormats||[]),c(null))},[e,r]);const f=g=>{const h=v(g);i([...s,h]),c(h.id)},d=g=>{i(s.map(h=>h.id===g.id?g:h))},p=g=>{i(s.filter(h=>h.id!==g)),l===g&&c(null)},b=()=>{n(s),t()},v=g=>{const h=`rule_${Date.now()}`,x={fontColor:"#000000",bgColor:"#ffffff"};switch(g){case"cellValue":return{id:h,type:"cellValue",operator:"gt",value1:0,style:{...x,bgColor:"#ffcccc",fontColor:"#9c0006"}};case"topBottom":return{id:h,type:"topBottom",mode:"top",count:10,percent:!1,style:{...x,bgColor:"#c6efce",fontColor:"#006100"}};case"colorScale":return{id:h,type:"colorScale",scaleType:"3-color",minColor:"#f8696b",midColor:"#ffeb84",maxColor:"#63be7b"};case"iconSet":return{id:h,type:"iconSet",iconSet:"trafficLights",reverse:!1}}},w=g=>{switch(g.type){case"cellValue":return a.jsxs("div",{className:"p-3 border rounded bg-gray-50",children:[a.jsxs("div",{className:"mb-3",children:[a.jsx(q,{children:"Format cells where value is:"}),a.jsxs("div",{className:"flex gap-2",children:[a.jsxs(ae,{value:g.operator,onChange:h=>d({...g,operator:h.target.value}),className:"w-1/3",children:[a.jsx("option",{value:"gt",children:"Greater than"}),a.jsx("option",{value:"lt",children:"Less than"}),a.jsx("option",{value:"gte",children:"Greater than or equal to"}),a.jsx("option",{value:"lte",children:"Less than or equal to"}),a.jsx("option",{value:"eq",children:"Equal to"}),a.jsx("option",{value:"neq",children:"Not equal to"}),a.jsx("option",{value:"between",children:"Between"}),a.jsx("option",{value:"contains",children:"Text contains"})]}),a.jsx(ge,{value:g.value1,onChange:h=>d({...g,value1:h.target.value}),className:"w-1/3",placeholder:"Value"}),g.operator==="between"&&a.jsx(ge,{value:g.value2||"",onChange:h=>d({...g,value2:h.target.value}),className:"w-1/3",placeholder:"Value 2"})]})]}),a.jsx(vo,{rule:g,onUpdate:h=>d({...g,style:h})})]});case"topBottom":return a.jsxs("div",{className:"p-3 border rounded bg-gray-50",children:[a.jsxs("div",{className:"mb-3",children:[a.jsx(q,{children:"Format cells that rank in the:"}),a.jsxs("div",{className:"flex gap-2 items-center",children:[a.jsxs(ae,{value:g.mode,onChange:h=>d({...g,mode:h.target.value}),className:"w-1/4",children:[a.jsx("option",{value:"top",children:"Top"}),a.jsx("option",{value:"bottom",children:"Bottom"})]}),a.jsx(ge,{type:"number",value:g.count,onChange:h=>d({...g,count:parseInt(h.target.value)||10}),className:"w-1/4"}),a.jsx("div",{className:"flex items-center",children:a.jsx(qe,{id:"percentCheck",checked:g.percent,onChange:h=>d({...g,percent:h.target.checked}),label:"% of selected range"})})]})]}),a.jsx(vo,{rule:g,onUpdate:h=>d({...g,style:h})})]});case"colorScale":return a.jsxs("div",{className:"p-3 border rounded bg-gray-50",children:[a.jsxs("div",{className:"mb-3",children:[a.jsx(q,{children:"Format Style"}),a.jsxs(ae,{value:g.scaleType,onChange:h=>d({...g,scaleType:h.target.value}),children:[a.jsx("option",{value:"2-color",children:"2-Color Scale"}),a.jsx("option",{value:"3-color",children:"3-Color Scale"})]})]}),a.jsxs("div",{className:"flex gap-4 justify-between",children:[a.jsxs("div",{children:[a.jsx(q,{children:"Minimum"}),a.jsx("input",{type:"color",value:g.minColor,onChange:h=>d({...g,minColor:h.target.value}),className:"form-control form-control-color w-full"})]}),g.scaleType==="3-color"&&a.jsxs("div",{children:[a.jsx(q,{children:"Midpoint"}),a.jsx("input",{type:"color",value:g.midColor,onChange:h=>d({...g,midColor:h.target.value}),className:"form-control form-control-color w-full"})]}),a.jsxs("div",{children:[a.jsx(q,{children:"Maximum"}),a.jsx("input",{type:"color",value:g.maxColor,onChange:h=>d({...g,maxColor:h.target.value}),className:"form-control form-control-color w-full"})]})]})]});case"iconSet":return a.jsxs("div",{className:"p-3 border rounded bg-gray-50",children:[a.jsxs("div",{className:"mb-3",children:[a.jsx(q,{children:"Icon Style"}),a.jsxs(ae,{value:g.iconSet,onChange:h=>d({...g,iconSet:h.target.value}),children:[a.jsx("option",{value:"trafficLights",children:"Traffic Lights (Green, Yellow, Red)"}),a.jsx("option",{value:"arrows",children:"Arrows (Up, Side, Down)"}),a.jsx("option",{value:"flags",children:"Flags (Green, Yellow, Red)"}),a.jsx("option",{value:"shapes",children:"Shapes (Circle, Triangle, Diamond)"})]})]}),a.jsx("div",{className:"mb-3",children:a.jsx(qe,{checked:g.reverse,onChange:h=>d({...g,reverse:h.target.checked}),label:"Reverse Icon Order"})})]})}};return a.jsxs(rt,{visible:e,onClose:t,size:"lg",children:[a.jsx(st,{children:a.jsxs(at,{children:["Conditional Formatting: ",r?.name]})}),a.jsx(ot,{children:a.jsxs("div",{className:"flex gap-4 h-[500px]",children:[a.jsxs("div",{className:"w-1/3 border-r pr-4 overflow-y-auto",children:[a.jsxs("div",{className:"flex justify-between items-center mb-3",children:[a.jsx("h5",{className:"mb-0",children:"Rules"}),a.jsxs(Fn,{children:[a.jsxs($n,{color:"primary",size:"sm",children:[a.jsx(Nn,{size:14})," Add"]}),a.jsxs(An,{children:[a.jsx(Ze,{onClick:()=>f("cellValue"),children:"Cell Value"}),o==="value"&&a.jsxs(a.Fragment,{children:[a.jsx(Ze,{onClick:()=>f("topBottom"),children:"Top/Bottom"}),a.jsx(Ze,{onClick:()=>f("colorScale"),children:"Color Scale"}),a.jsx(Ze,{onClick:()=>f("iconSet"),children:"Icon Set"})]})]})]})]}),s.length===0&&a.jsx("div",{className:"text-gray-400 text-center mt-10 text-sm",children:"No rules defined."}),a.jsx("div",{className:"space-y-2",children:s.map(g=>a.jsxs("div",{className:`p-2 border rounded cursor-pointer flex justify-between items-center ${l===g.id?"border-primary bg-blue-50":"hover:bg-gray-50"}`,onClick:()=>c(g.id),children:[a.jsxs("div",{children:[a.jsxs("div",{className:"font-medium text-sm",children:[g.type==="cellValue"&&"Cell Value",g.type==="topBottom"&&"Top/Bottom",g.type==="colorScale"&&"Color Scale",g.type==="iconSet"&&"Icon Set"]}),a.jsx("div",{className:"text-xs text-gray-500",children:$c(g)})]}),a.jsx("button",{className:"text-gray-400 hover:text-red-500 p-1",onClick:h=>{h.stopPropagation(),p(g.id)},children:a.jsx(Sr,{size:14})})]},g.id))})]}),a.jsx("div",{className:"w-2/3 pl-4 overflow-y-auto",children:l?a.jsxs("div",{children:[a.jsx("h5",{className:"mb-3",children:"Edit Rule"}),w(s.find(g=>g.id===l))]}):a.jsx("div",{className:"flex items-center justify-center h-full text-gray-400",children:"Select a rule to edit or create a new one."})})]})}),a.jsxs(pt,{children:[a.jsx(J,{color:"secondary",onClick:t,children:"Cancel"}),a.jsx(J,{color:"primary",onClick:b,children:"Apply Rules"})]})]})},vo=({rule:e,onUpdate:t})=>a.jsxs("div",{className:"mt-3 border-t pt-3",children:[a.jsx(q,{children:"Preview Style"}),a.jsx("div",{className:"flex gap-4 mb-3",children:a.jsx("div",{className:"border rounded px-4 py-2 text-center w-full",style:{color:e.style.fontColor,backgroundColor:e.style.bgColor,fontWeight:e.style.bold?"bold":"normal",fontStyle:e.style.italic?"italic":"normal"},children:"AaBbCcYyZz"})}),a.jsxs("div",{className:"row",children:[a.jsxs("div",{className:"col-md-6 mb-2",children:[a.jsx(q,{className:"text-xs",children:"Font Color"}),a.jsx("input",{type:"color",value:e.style.fontColor||"#000000",onChange:n=>t({...e.style,fontColor:n.target.value}),className:"form-control form-control-color w-full"})]}),a.jsxs("div",{className:"col-md-6 mb-2",children:[a.jsx(q,{className:"text-xs",children:"Background Color"}),a.jsx("input",{type:"color",value:e.style.bgColor||"#ffffff",onChange:n=>t({...e.style,bgColor:n.target.value}),className:"form-control form-control-color w-full"})]})]}),a.jsxs("div",{className:"flex gap-4 mt-2",children:[a.jsx(qe,{id:`bold-${e.id}`,checked:e.style.bold||!1,onChange:n=>t({...e.style,bold:n.target.checked}),label:"Bold"}),a.jsx(qe,{id:`italic-${e.id}`,checked:e.style.italic||!1,onChange:n=>t({...e.style,italic:n.target.checked}),label:"Italic"})]})]}),$c=e=>{switch(e.type){case"cellValue":return`${e.operator} ${e.value1}`;case"topBottom":return`${e.mode} ${e.count} ${e.percent?"%":"items"}`;case"colorScale":return`${e.scaleType}`;case"iconSet":return`${e.iconSet}`;default:return""}},Lc=({visible:e,onClose:t,onSave:n,column:r})=>{const[o,s]=m.useState({decimalPlaces:2,thousandSeparator:!0,displayType:"number",currencySymbol:"$",negativeFormat:"minus"}),[i,l]=m.useState({pattern:"MM/DD/YYYY",customPattern:""});m.useEffect(()=>{r&&(r.numberFormat&&s(r.numberFormat),r.dateFormat&&l(r.dateFormat))},[r]);const c=()=>r?.dataType==="real"||r?.dataType==="float"||r?.dataType==="integer"||r?.dataType==="int",f=()=>r?.dataType==="date"||r?.dataType==="datetime",d=()=>{c()?n(o,void 0):f()&&n(void 0,i),t()};return a.jsxs(rt,{visible:e,onClose:t,size:"lg",children:[a.jsx(st,{children:a.jsxs(at,{children:["Number/Date Format - ",r?.name]})}),a.jsxs(ot,{children:[c()&&a.jsxs("div",{className:"space-y-3",children:[a.jsxs("div",{children:[a.jsx(q,{children:"Display Type"}),a.jsxs(ae,{value:o.displayType,onChange:p=>s({...o,displayType:p.target.value}),children:[a.jsx("option",{value:"number",children:"Number"}),a.jsx("option",{value:"currency",children:"Currency"}),a.jsx("option",{value:"percentage",children:"Percentage"}),a.jsx("option",{value:"scientific",children:"Scientific"})]})]}),o.displayType==="currency"&&a.jsxs("div",{children:[a.jsx(q,{children:"Currency Symbol"}),a.jsxs(ae,{value:o.currencySymbol,onChange:p=>s({...o,currencySymbol:p.target.value}),children:[a.jsx("option",{value:"$",children:"$ (Dollar)"}),a.jsx("option",{value:"",children:" (Euro)"}),a.jsx("option",{value:"",children:" (Pound)"}),a.jsx("option",{value:"",children:" (Yen/Yuan)"}),a.jsx("option",{value:"",children:" (Rupee)"})]})]}),a.jsxs("div",{children:[a.jsx(q,{children:"Decimal Places"}),a.jsxs(ae,{value:o.decimalPlaces,onChange:p=>s({...o,decimalPlaces:Number(p.target.value)}),children:[a.jsx("option",{value:"0",children:"0"}),a.jsx("option",{value:"1",children:"1"}),a.jsx("option",{value:"2",children:"2"}),a.jsx("option",{value:"3",children:"3"}),a.jsx("option",{value:"4",children:"4"})]})]}),a.jsx("div",{children:a.jsx(qe,{label:"Use Thousand Separator",checked:o.thousandSeparator,onChange:p=>s({...o,thousandSeparator:p.target.checked})})}),a.jsxs("div",{children:[a.jsx(q,{children:"Negative Number Format"}),a.jsxs(ae,{value:o.negativeFormat,onChange:p=>s({...o,negativeFormat:p.target.value}),children:[a.jsx("option",{value:"minus",children:"-123 (Minus sign)"}),a.jsx("option",{value:"parentheses",children:"(123) (Parentheses)"}),a.jsx("option",{value:"red",children:"-123 (Red color)"})]})]})]}),f()&&a.jsxs("div",{className:"space-y-3",children:[a.jsxs("div",{children:[a.jsx(q,{children:"Date Format"}),a.jsxs(ae,{value:i.pattern,onChange:p=>l({...i,pattern:p.target.value}),children:[a.jsx("option",{value:"MM/DD/YYYY",children:"MM/DD/YYYY (01/15/2024)"}),a.jsx("option",{value:"DD/MM/YYYY",children:"DD/MM/YYYY (15/01/2024)"}),a.jsx("option",{value:"YYYY-MM-DD",children:"YYYY-MM-DD (2024-01-15)"}),a.jsx("option",{value:"MMM DD, YYYY",children:"MMM DD, YYYY (Jan 15, 2024)"}),a.jsx("option",{value:"DD MMM YYYY",children:"DD MMM YYYY (15 Jan 2024)"}),a.jsx("option",{value:"MMMM DD, YYYY",children:"MMMM DD, YYYY (January 15, 2024)"}),a.jsx("option",{value:"custom",children:"Custom"})]})]}),i.pattern==="custom"&&a.jsxs("div",{children:[a.jsx(q,{children:"Custom Pattern"}),a.jsx(ge,{type:"text",value:i.customPattern||"",onChange:p=>l({...i,customPattern:p.target.value}),placeholder:"e.g., YYYY/MM/DD HH:mm:ss"}),a.jsx("small",{className:"text-muted",children:"Tokens: YYYY (year), MM (month), DD (day), HH (24hr), hh (12hr), mm (min), ss (sec), A (AM/PM)"})]})]}),!c()&&!f()&&a.jsxs("div",{className:"alert alert-info",children:["This field type (",r?.dataType,") does not support number or date formatting."]})]}),a.jsxs(pt,{children:[a.jsx(J,{color:"secondary",onClick:t,children:"Close"}),a.jsx(J,{color:"primary",onClick:d,disabled:!c()&&!f(),children:"Save"})]})]})},Yc=({id:e,children:t})=>{const{setNodeRef:n}=ds({id:e});return a.jsx("div",{ref:n,className:"h-full",children:t})},Ic=({availableColumns:e,groupColumns:t,pivotColumns:n,valueColumns:r,onUpdate:o,metricGroups:s,onAddGroup:i,onRemoveGroup:l,onUpdateGroup:c,onConfigureTotals:f})=>{const[d,p]=m.useState(null),[b,v]=m.useState(!1),[w,g]=m.useState(!1),[h,x]=m.useState(null),[E,C]=m.useState(null),[j,k]=m.useState(!1),[O,N]=m.useState(null),[S,R]=m.useState({available:e,group:t,pivot:n,value:r});m.useEffect(()=>{R({available:e,group:t,pivot:n,value:r})},[e,t,n,r]);const F=Zi(no(Mr),no(Tr,{coordinateGetter:Rc})),P=I=>{p(I.active.id)},A=I=>I in S?I:Object.keys(S).find(L=>S[L].find(K=>K.id===I)),Y=I=>{const{active:L,over:K}=I,D=A(L.id);if(!D||!K){p(null);return}let M;if(["available","group","pivot","value"].includes(K.id)?M=K.id:M=A(K.id),!M){p(null);return}if(D===M){const $=S[D].findIndex(T=>T.id===L.id),X=S[D].findIndex(T=>T.id===K.id);if($!==-1&&X!==-1&&$!==X){const T=Fr(S[D],$,X),U={...S,[D]:T};R(U),D!=="available"&&o(D,T)}}else{const $=S[D].find(W=>W.id===L.id);if(!$){p(null);return}const X=S[D].filter(W=>W.id!==L.id),T=[...S[M],$],U={...S,[D]:X,[M]:T};R(U),D!=="available"&&o(D,X),M!=="available"&&o(M,T)}p(null)},Z=(I,L)=>{x(I),C(L),g(!0)},H=I=>{if(!h||!E)return;const L=S[E].map(K=>K.id===h.id?{...K,conditionalFormats:I}:K);o(E,L),g(!1),x(null)},te=I=>{N(I),k(!0)},G=I=>{if(!O)return;let L;if(S.value.find(D=>D.id===O.id)?L="value":S.group.find(D=>D.id===O.id)?L="group":S.pivot.find(D=>D.id===O.id)&&(L="pivot"),!L)return;const K=S[L].map(D=>D.id===O.id?D.dataType==="date"||D.dataType==="datetime"?{...D,dateFormat:I}:{...D,numberFormat:I}:D);o(L,K),k(!1),N(null)},ie=(I,L,K,D)=>a.jsx(Yc,{id:L,children:a.jsxs(Dt,{className:"h-full shadow-sm flex flex-col",children:[a.jsxs(an,{className:"bg-gray-50 font-semibold text-sm text-gray-700 flex-none flex justify-between items-center",children:[a.jsxs("span",{children:[I," (",K.length,") "]}),D]}),a.jsx(Tt,{className:"flex-1 bg-gray-50/50 p-2 overflow-y-auto min-h-[200px]",children:a.jsx(wc,{id:L,items:K.map(M=>M.id),strategy:yc,children:K.length===0?a.jsx("div",{className:"text-center text-gray-400 text-sm py-8",children:"Drop columns here"}):K.map(M=>a.jsx(Pc,{id:M.id,name:M.name,showEdit:!1,onEdit:()=>{},showDelete:!1,onDelete:()=>{},showFormat:L!=="available",onFormat:()=>Z(M,L),showNumberFormat:L!=="available",onNumberFormat:()=>te(M)},M.id))})})]})});return a.jsxs(a.Fragment,{children:[a.jsxs(Ql,{sensors:F,collisionDetection:nl,onDragStart:P,onDragEnd:Y,children:[a.jsxs(Ln,{className:"g-4 h-full",children:[a.jsx(He,{md:3,className:"h-full",children:ie("Available Columns","available",S.available)}),a.jsx(He,{md:3,className:"h-full",children:ie("Rows (Group By)","group",S.group)}),a.jsx(He,{md:3,className:"h-full",children:ie("Columns (Pivot)","pivot",S.pivot)}),a.jsx(He,{md:3,className:"h-full",children:ie("Values","value",S.value,a.jsxs("div",{className:"flex gap-1",children:[a.jsx(J,{color:"light",size:"sm",className:"p-1 text-gray-500 hover:text-epsilon-blue hover:bg-blue-50",onClick:f,title:"Configure Totals & Subtotals",children:a.jsx(zn,{size:16})}),a.jsx(J,{color:"light",size:"sm",className:"p-1 text-gray-500 hover:text-epsilon-blue hover:bg-blue-50",onClick:()=>v(!0),title:"Configure Metric Groups",children:a.jsx(zo,{size:16})})]}))})]}),a.jsx(hc,{children:d?a.jsx("div",{className:"p-2 bg-white border border-epsilon-blue rounded shadow-lg",children:a.jsx("span",{className:"text-sm font-medium",children:d})}):null})]}),a.jsxs(rt,{visible:b,onClose:()=>v(!1),size:"lg",children:[a.jsx(st,{closeButton:!0,children:a.jsx(at,{children:"Metric Grouping"})}),a.jsx(ot,{children:a.jsx(Fc,{groups:s,valueColumns:r,onAddGroup:i,onRemoveGroup:l,onUpdateGroup:c})})]}),a.jsx(Ac,{visible:w,onClose:()=>{g(!1),x(null)},onSave:H,column:h,section:E}),a.jsx(Lc,{visible:j,onClose:()=>{k(!1),N(null)},onSave:G,column:O})]})},zc=({headerSettings:e,onUpdate:t,allFields:n,filters:r})=>{const o=()=>{const c={type:"text",text:"",textAlign:"left"};t([...e,c])},s=c=>{const f=[...e];f.splice(c,1),t(f)},i=(c,f)=>{const d=[...e];d[c]={...d[c],...f},t(d)},l=(c,f)=>{if(f==="up"&&c===0||f==="down"&&c===e.length-1)return;const d=[...e],p=f==="up"?c-1:c+1;[d[c],d[p]]=[d[p],d[c]],t(d)};return a.jsxs("div",{className:"space-y-4",children:[a.jsxs("div",{className:"flex justify-between items-center",children:[a.jsx("h5",{className:"font-semibold text-gray-700 m-0",children:"Header Configuration"}),a.jsxs(J,{color:"primary",size:"sm",onClick:o,children:[a.jsx(Nn,{size:16,className:"mr-1"})," Add Header Row"]})]}),e.length===0?a.jsx("div",{className:"text-center p-4 bg-gray-50 rounded border border-dashed border-gray-300 text-gray-500",children:'No header rows configured. Click "Add Header Row" to start.'}):a.jsx("div",{className:"space-y-3",children:e.map((c,f)=>a.jsx(Dt,{className:"border border-gray-200 shadow-sm",children:a.jsx(Tt,{className:"p-3",children:a.jsxs("div",{className:"flex gap-3 items-start",children:[a.jsxs("div",{className:"flex flex-col gap-1 mt-1",children:[a.jsx(J,{color:"light",size:"sm",className:"p-1",onClick:()=>l(f,"up"),disabled:f===0,children:a.jsx(vi,{size:14})}),a.jsx(J,{color:"light",size:"sm",className:"p-1",onClick:()=>l(f,"down"),disabled:f===e.length-1,children:a.jsx(hi,{size:14})})]}),a.jsxs("div",{className:"flex-1 space-y-3",children:[a.jsxs("div",{className:"grid grid-cols-12 gap-3",children:[a.jsxs("div",{className:"col-span-4",children:[a.jsx(q,{className:"text-xs text-gray-500 mb-1",children:"Type"}),a.jsxs(ae,{size:"sm",value:c.type,onChange:d=>i(f,{type:d.target.value}),children:[a.jsx("option",{value:"text",children:"Custom Text"}),a.jsx("option",{value:"column",children:"Field Value"}),a.jsx("option",{value:"filters",children:"Filter List"}),a.jsx("option",{value:"refreshDate",children:"Refresh Date"})]})]}),a.jsxs("div",{className:"col-span-8",children:[c.type==="text"&&a.jsxs("div",{children:[a.jsx(q,{className:"text-xs text-gray-500 mb-1",children:"Text Content"}),a.jsx(ge,{size:"sm",type:"text",value:c.text||"",onChange:d=>i(f,{text:d.target.value}),placeholder:"Enter header text"})]}),c.type==="column"&&a.jsxs("div",{children:[a.jsx(q,{className:"text-xs text-gray-500 mb-1",children:"Select Field"}),a.jsxs(ae,{size:"sm",value:c.column||"",onChange:d=>i(f,{column:d.target.value}),children:[a.jsx("option",{value:"",children:"Select a field..."}),n.map(d=>a.jsx("option",{value:d.id,children:d.name},d.id))]})]}),c.type==="filters"&&a.jsxs("div",{children:[a.jsx(q,{className:"text-xs text-gray-500 mb-1",children:"Select Filters to Show"}),a.jsx(ae,{size:"sm",multiple:!0,value:c.selectedFilters||[],onChange:d=>{const p=Array.from(d.target.selectedOptions,b=>b.value);i(f,{selectedFilters:p})},className:"h-20",children:r.map(d=>a.jsx("option",{value:d.id,children:d.name},d.id))}),a.jsx("small",{className:"text-xs text-gray-400",children:"Hold Ctrl/Cmd to select multiple"})]}),c.type==="refreshDate"&&a.jsxs("div",{children:[a.jsx(q,{className:"text-xs text-gray-500 mb-1",children:"Date Format"}),a.jsxs(ae,{size:"sm",value:c.dateFormat||"MM/DD/YYYY HH:mm",onChange:d=>i(f,{dateFormat:d.target.value}),children:[a.jsx("option",{value:"MM/DD/YYYY HH:mm",children:"MM/DD/YYYY HH:mm"}),a.jsx("option",{value:"YYYY-MM-DD HH:mm",children:"YYYY-MM-DD HH:mm"}),a.jsx("option",{value:"DD MMM YYYY HH:mm",children:"DD MMM YYYY HH:mm"})]})]})]})]}),a.jsxs("div",{className:"flex gap-4",children:[a.jsxs("div",{className:"w-1/3",children:[a.jsx(q,{className:"text-xs text-gray-500 mb-1",children:"Alignment"}),a.jsxs(ae,{size:"sm",value:c.textAlign||"left",onChange:d=>i(f,{textAlign:d.target.value}),children:[a.jsx("option",{value:"left",children:"Left"}),a.jsx("option",{value:"center",children:"Center"}),a.jsx("option",{value:"right",children:"Right"})]})]}),a.jsxs("div",{className:"w-1/3",children:[a.jsx(q,{className:"text-xs text-gray-500 mb-1",children:"Text Color"}),a.jsx(ge,{size:"sm",type:"color",value:c.fontColor||"#000000",onChange:d=>i(f,{fontColor:d.target.value}),className:"h-8 p-1"})]}),a.jsxs("div",{className:"w-1/3",children:[a.jsx(q,{className:"text-xs text-gray-500 mb-1",children:"Background"}),a.jsx(ge,{size:"sm",type:"color",value:c.bgColor||"#ffffff",onChange:d=>i(f,{bgColor:d.target.value}),className:"h-8 p-1"})]})]})]}),a.jsx(J,{color:"danger",variant:"ghost",size:"sm",onClick:()=>s(f),title:"Remove Row",children:a.jsx(Sr,{size:16})})]})})},f))})]})},Wc=({visible:e,onClose:t,config:n,onUpdateConfig:r,allFields:o,filters:s})=>{const[i,l]=m.useState(n);m.useEffect(()=>{e&&l(n)},[e,n]);const c=d=>{l(p=>({...p,...d}))},f=()=>{r(i),t()};return a.jsxs(rt,{visible:e,onClose:t,size:"xl",children:[a.jsx(st,{children:a.jsx(at,{children:"Export Settings"})}),a.jsx(ot,{children:a.jsxs("div",{className:"grid grid-cols-12 gap-6",children:[a.jsxs("div",{className:"col-span-4 space-y-6",children:[a.jsxs("div",{children:[a.jsx("h5",{className:"mb-3 font-semibold text-gray-700",children:"Export Mode"}),a.jsxs("div",{className:"flex flex-col gap-3 p-4 bg-gray-50 rounded-lg border border-gray-200",children:[a.jsx(qe,{type:"radio",name:"exportMode",id:"modeFormatted",label:a.jsxs("span",{children:[a.jsx("span",{className:"font-semibold",children:"Formatted Excel"}),a.jsx("span",{className:"block text-xs text-gray-500 mt-1",children:"Full pivot table with formatting, totals, and grouping"})]}),checked:i.exportMode==="formatted",onChange:()=>c({exportMode:"formatted"})}),a.jsx(qe,{type:"radio",name:"exportMode",id:"modeDataDump",label:a.jsxs("span",{children:[a.jsx("span",{className:"font-semibold",children:"Data Dump"}),a.jsx("span",{className:"block text-xs text-gray-500 mt-1",children:"Raw data export with custom headers only"})]}),checked:i.exportMode==="datadump",onChange:()=>c({exportMode:"datadump"})})]})]}),a.jsxs("div",{children:[a.jsx("h5",{className:"mb-3 font-semibold text-gray-700",children:"File Names"}),a.jsxs("div",{className:"space-y-3 p-4 bg-gray-50 rounded-lg border border-gray-200",children:[a.jsxs("div",{children:[a.jsx(q,{className:"text-xs text-gray-500 mb-1",children:"Workbook Name (Optional)"}),a.jsx(ge,{type:"text",placeholder:"e.g., Sales Report",value:i.workbookName||"",onChange:d=>c({workbookName:d.target.value})})]}),a.jsxs("div",{children:[a.jsx(q,{className:"text-xs text-gray-500 mb-1",children:"Worksheet Name (Optional)"}),a.jsx(ge,{type:"text",placeholder:"e.g., Q1 Data",value:i.worksheetName||"",onChange:d=>c({worksheetName:d.target.value})})]})]})]}),a.jsxs("div",{children:[a.jsx("h5",{className:"mb-3 font-semibold text-gray-700",children:"Pivot Header Styling"}),a.jsxs("div",{className:"space-y-3 p-4 bg-gray-50 rounded-lg border border-gray-200",children:[a.jsxs("div",{children:[a.jsx(q,{className:"text-xs text-gray-500 mb-1",children:"Text Color"}),a.jsx(ge,{type:"color",className:"h-8 p-1 w-full",value:i.pivotHeaderFormat?.fontColor||"#000000",onChange:d=>c({pivotHeaderFormat:{...i.pivotHeaderFormat,fontColor:d.target.value}})})]}),a.jsxs("div",{children:[a.jsx(q,{className:"text-xs text-gray-500 mb-1",children:"Background Color"}),a.jsx(ge,{type:"color",className:"h-8 p-1 w-full",value:i.pivotHeaderFormat?.bgColor||"#F3F4F6",onChange:d=>c({pivotHeaderFormat:{...i.pivotHeaderFormat,bgColor:d.target.value}})})]}),a.jsxs("div",{children:[a.jsx(q,{className:"text-xs text-gray-500 mb-1",children:"Alignment"}),a.jsx("div",{className:"flex gap-2",children:["left","center","right"].map(d=>a.jsx(J,{color:i.pivotHeaderFormat?.textAlign===d?"primary":"light",size:"sm",className:"flex-1 capitalize",onClick:()=>c({pivotHeaderFormat:{...i.pivotHeaderFormat,textAlign:d}}),children:d},d))})]})]})]})]}),a.jsx("div",{className:"col-span-8",children:a.jsx(zc,{headerSettings:i.headerRowSettings||[],onUpdate:d=>c({headerRowSettings:d}),allFields:o,filters:s})})]})}),a.jsxs(pt,{children:[a.jsx(J,{color:"secondary",variant:"ghost",onClick:t,children:"Cancel"}),a.jsx(J,{color:"primary",onClick:f,children:"Save Changes"})]})]})},Bc=({showRowTotals:e,rowTotalsPosition:t,showColumnTotals:n,columnTotalsPosition:r,showSubtotals:o,onUpdate:s})=>a.jsxs(Dt,{className:"mt-4 shadow-sm",children:[a.jsxs(an,{className:"bg-white font-semibold text-epsilon-blue flex items-center gap-2",children:[a.jsx(zn,{size:18}),a.jsx("span",{children:"Totals & Subtotals"})]}),a.jsx(Tt,{children:a.jsxs(Ln,{className:"g-4",children:[a.jsxs(He,{md:4,children:[a.jsx("div",{className:"mb-3",children:a.jsx(_t,{label:"Show Row Grand Totals",id:"showRowTotals",checked:e,onChange:i=>s({showRowTotals:i.target.checked})})}),e&&a.jsxs("div",{className:"ms-4",children:[a.jsx(q,{htmlFor:"rowTotalsPosition",className:"text-sm text-gray-600",children:"Position"}),a.jsxs(ae,{id:"rowTotalsPosition",size:"sm",value:t,onChange:i=>s({rowTotalsPosition:i.target.value}),children:[a.jsx("option",{value:"right",children:"Right (End)"}),a.jsx("option",{value:"left",children:"Left (Start)"})]})]})]}),a.jsxs(He,{md:4,children:[a.jsx("div",{className:"mb-3",children:a.jsx(_t,{label:"Show Column Grand Totals",id:"showColumnTotals",checked:n,onChange:i=>s({showColumnTotals:i.target.checked})})}),n&&a.jsxs("div",{className:"ms-4",children:[a.jsx(q,{htmlFor:"columnTotalsPosition",className:"text-sm text-gray-600",children:"Position"}),a.jsxs(ae,{id:"columnTotalsPosition",size:"sm",value:r,onChange:i=>s({columnTotalsPosition:i.target.value}),children:[a.jsx("option",{value:"bottom",children:"Bottom (End)"}),a.jsx("option",{value:"top",children:"Top (Start)"})]})]})]}),a.jsxs(He,{md:4,children:[a.jsx("div",{className:"mb-3",children:a.jsx(_t,{label:"Show Subtotals",id:"showSubtotals",checked:o,onChange:i=>s({showSubtotals:i.target.checked})})}),o&&a.jsx("div",{className:"ms-4 text-xs text-gray-500",children:"Subtotals will be displayed for each group level."})]})]})})]}),Hc=({config:e,onUpdateConfig:t,worksheets:n,onWorksheetChange:r,availableColumns:o,allFields:s,groupColumns:i,pivotColumns:l,valueColumns:c,onColumnsUpdate:f,metricGroups:d,onAddGroup:p,onRemoveGroup:b,onUpdateGroup:v,onAddCustomField:w,onDeleteCustomField:g,onUpdateCustomField:h,filters:x})=>{const[E,C]=m.useState(!1),[j,k]=m.useState(!1);return a.jsxs(yr,{fluid:!0,className:"p-4",children:[a.jsx(Yi,{worksheets:n,selectedWorksheet:e.selectedWorksheet,onSelect:r,onOpenSettings:()=>C(!0)}),a.jsx(Wc,{visible:E,onClose:()=>C(!1),config:e,onUpdateConfig:t,allFields:s,filters:x}),e.selectedWorksheet&&a.jsx("div",{className:"mt-4",children:a.jsx(Ic,{availableColumns:o,allFields:s,groupColumns:i,pivotColumns:l,valueColumns:c,onUpdate:f,metricGroups:d,onAddGroup:p,onRemoveGroup:b,onUpdateGroup:v,onAddCustomField:w,onDeleteCustomField:g,onUpdateCustomField:h,onConfigureTotals:()=>k(!0)})}),a.jsxs(rt,{visible:j,onClose:()=>k(!1),size:"lg",children:[a.jsx(st,{children:a.jsx(at,{children:"Table Settings"})}),a.jsx(ot,{children:a.jsx(Bc,{showRowTotals:e.showRowTotals,rowTotalsPosition:e.rowTotalsPosition,showColumnTotals:e.showColumnTotals,columnTotalsPosition:e.columnTotalsPosition,showSubtotals:e.showSubtotals,onUpdate:t})}),a.jsx(pt,{children:a.jsx(J,{color:"secondary",onClick:()=>k(!1),children:"Close"})})]})]})},gs=6048e5,Vc=864e5,bo=Symbol.for("constructDateFrom");function tt(e,t){return typeof e=="function"?e(t):e&&typeof e=="object"&&bo in e?e[bo](t):e instanceof Date?new e.constructor(t):new Date(t)}function Pe(e,t){return tt(t||e,e)}let qc={};function Xn(){return qc}function rn(e,t){const n=Xn(),r=t?.weekStartsOn??t?.locale?.options?.weekStartsOn??n.weekStartsOn??n.locale?.options?.weekStartsOn??0,o=Pe(e,t?.in),s=o.getDay(),i=(s<r?7:0)+s-r;return o.setDate(o.getDate()-i),o.setHours(0,0,0,0),o}function Rn(e,t){return rn(e,{...t,weekStartsOn:1})}function vs(e,t){const n=Pe(e,t?.in),r=n.getFullYear(),o=tt(n,0);o.setFullYear(r+1,0,4),o.setHours(0,0,0,0);const s=Rn(o),i=tt(n,0);i.setFullYear(r,0,4),i.setHours(0,0,0,0);const l=Rn(i);return n.getTime()>=s.getTime()?r+1:n.getTime()>=l.getTime()?r:r-1}function yo(e){const t=Pe(e),n=new Date(Date.UTC(t.getFullYear(),t.getMonth(),t.getDate(),t.getHours(),t.getMinutes(),t.getSeconds(),t.getMilliseconds()));return n.setUTCFullYear(t.getFullYear()),+e-+n}function Gc(e,...t){const n=tt.bind(null,t.find(r=>typeof r=="object"));return t.map(n)}function xo(e,t){const n=Pe(e,t?.in);return n.setHours(0,0,0,0),n}function Xc(e,t,n){const[r,o]=Gc(n?.in,e,t),s=xo(r),i=xo(o),l=+s-yo(s),c=+i-yo(i);return Math.round((l-c)/Vc)}function _c(e,t){const n=vs(e,t),r=tt(e,0);return r.setFullYear(n,0,4),r.setHours(0,0,0,0),Rn(r)}function Kc(e){return e instanceof Date||typeof e=="object"&&Object.prototype.toString.call(e)==="[object Date]"}function Uc(e){return!(!Kc(e)&&typeof e!="number"||isNaN(+Pe(e)))}function Qc(e,t){const n=Pe(e,t?.in);return n.setFullYear(n.getFullYear(),0,1),n.setHours(0,0,0,0),n}const Jc={lessThanXSeconds:{one:"less than a second",other:"less than {{count}} seconds"},xSeconds:{one:"1 second",other:"{{count}} seconds"},halfAMinute:"half a minute",lessThanXMinutes:{one:"less than a minute",other:"less than {{count}} minutes"},xMinutes:{one:"1 minute",other:"{{count}} minutes"},aboutXHours:{one:"about 1 hour",other:"about {{count}} hours"},xHours:{one:"1 hour",other:"{{count}} hours"},xDays:{one:"1 day",other:"{{count}} days"},aboutXWeeks:{one:"about 1 week",other:"about {{count}} weeks"},xWeeks:{one:"1 week",other:"{{count}} weeks"},aboutXMonths:{one:"about 1 month",other:"about {{count}} months"},xMonths:{one:"1 month",other:"{{count}} months"},aboutXYears:{one:"about 1 year",other:"about {{count}} years"},xYears:{one:"1 year",other:"{{count}} years"},overXYears:{one:"over 1 year",other:"over {{count}} years"},almostXYears:{one:"almost 1 year",other:"almost {{count}} years"}},Zc=(e,t,n)=>{let r;const o=Jc[e];return typeof o=="string"?r=o:t===1?r=o.one:r=o.other.replace("{{count}}",t.toString()),n?.addSuffix?n.comparison&&n.comparison>0?"in "+r:r+" ago":r};function tr(e){return(t={})=>{const n=t.width?String(t.width):e.defaultWidth;return e.formats[n]||e.formats[e.defaultWidth]}}const ed={full:"EEEE, MMMM do, y",long:"MMMM do, y",medium:"MMM d, y",short:"MM/dd/yyyy"},td={full:"h:mm:ss a zzzz",long:"h:mm:ss a z",medium:"h:mm:ss a",short:"h:mm a"},nd={full:"{{date}} 'at' {{time}}",long:"{{date}} 'at' {{time}}",medium:"{{date}}, {{time}}",short:"{{date}}, {{time}}"},rd={date:tr({formats:ed,defaultWidth:"full"}),time:tr({formats:td,defaultWidth:"full"}),dateTime:tr({formats:nd,defaultWidth:"full"})},od={lastWeek:"'last' eeee 'at' p",yesterday:"'yesterday at' p",today:"'today at' p",tomorrow:"'tomorrow at' p",nextWeek:"eeee 'at' p",other:"P"},sd=(e,t,n,r)=>od[e];function Ht(e){return(t,n)=>{const r=n?.context?String(n.context):"standalone";let o;if(r==="formatting"&&e.formattingValues){const i=e.defaultFormattingWidth||e.defaultWidth,l=n?.width?String(n.width):i;o=e.formattingValues[l]||e.formattingValues[i]}else{const i=e.defaultWidth,l=n?.width?String(n.width):e.defaultWidth;o=e.values[l]||e.values[i]}const s=e.argumentCallback?e.argumentCallback(t):t;return o[s]}}const ad={narrow:["B","A"],abbreviated:["BC","AD"],wide:["Before Christ","Anno Domini"]},id={narrow:["1","2","3","4"],abbreviated:["Q1","Q2","Q3","Q4"],wide:["1st quarter","2nd quarter","3rd quarter","4th quarter"]},ld={narrow:["J","F","M","A","M","J","J","A","S","O","N","D"],abbreviated:["Jan","Feb","Mar","Apr","May","Jun","Jul","Aug","Sep","Oct","Nov","Dec"],wide:["January","February","March","April","May","June","July","August","September","October","November","December"]},cd={narrow:["S","M","T","W","T","F","S"],short:["Su","Mo","Tu","We","Th","Fr","Sa"],abbreviated:["Sun","Mon","Tue","Wed","Thu","Fri","Sat"],wide:["Sunday","Monday","Tuesday","Wednesday","Thursday","Friday","Saturday"]},dd={narrow:{am:"a",pm:"p",midnight:"mi",noon:"n",morning:"morning",afternoon:"afternoon",evening:"evening",night:"night"},abbreviated:{am:"AM",pm:"PM",midnight:"midnight",noon:"noon",morning:"morning",afternoon:"afternoon",evening:"evening",night:"night"},wide:{am:"a.m.",pm:"p.m.",midnight:"midnight",noon:"noon",morning:"morning",afternoon:"afternoon",evening:"evening",night:"night"}},ud={narrow:{am:"a",pm:"p",midnight:"mi",noon:"n",morning:"in the morning",afternoon:"in the afternoon",evening:"in the evening",night:"at night"},abbreviated:{am:"AM",pm:"PM",midnight:"midnight",noon:"noon",morning:"in the morning",afternoon:"in the afternoon",evening:"in the evening",night:"at night"},wide:{am:"a.m.",pm:"p.m.",midnight:"midnight",noon:"noon",morning:"in the morning",afternoon:"in the afternoon",evening:"in the evening",night:"at night"}},fd=(e,t)=>{const n=Number(e),r=n%100;if(r>20||r<10)switch(r%10){case 1:return n+"st";case 2:return n+"nd";case 3:return n+"rd"}return n+"th"},md={ordinalNumber:fd,era:Ht({values:ad,defaultWidth:"wide"}),quarter:Ht({values:id,defaultWidth:"wide",argumentCallback:e=>e-1}),month:Ht({values:ld,defaultWidth:"wide"}),day:Ht({values:cd,defaultWidth:"wide"}),dayPeriod:Ht({values:dd,defaultWidth:"wide",formattingValues:ud,defaultFormattingWidth:"wide"})};function Vt(e){return(t,n={})=>{const r=n.width,o=r&&e.matchPatterns[r]||e.matchPatterns[e.defaultMatchWidth],s=t.match(o);if(!s)return null;const i=s[0],l=r&&e.parsePatterns[r]||e.parsePatterns[e.defaultParseWidth],c=Array.isArray(l)?hd(l,p=>p.test(i)):pd(l,p=>p.test(i));let f;f=e.valueCallback?e.valueCallback(c):c,f=n.valueCallback?n.valueCallback(f):f;const d=t.slice(i.length);return{value:f,rest:d}}}function pd(e,t){for(const n in e)if(Object.prototype.hasOwnProperty.call(e,n)&&t(e[n]))return n}function hd(e,t){for(let n=0;n<e.length;n++)if(t(e[n]))return n}function gd(e){return(t,n={})=>{const r=t.match(e.matchPattern);if(!r)return null;const o=r[0],s=t.match(e.parsePattern);if(!s)return null;let i=e.valueCallback?e.valueCallback(s[0]):s[0];i=n.valueCallback?n.valueCallback(i):i;const l=t.slice(o.length);return{value:i,rest:l}}}const vd=/^(\d+)(th|st|nd|rd)?/i,bd=/\d+/i,yd={narrow:/^(b|a)/i,abbreviated:/^(b\.?\s?c\.?|b\.?\s?c\.?\s?e\.?|a\.?\s?d\.?|c\.?\s?e\.?)/i,wide:/^(before christ|before common era|anno domini|common era)/i},xd={any:[/^b/i,/^(a|c)/i]},wd={narrow:/^[1234]/i,abbreviated:/^q[1234]/i,wide:/^[1234](th|st|nd|rd)? quarter/i},Cd={any:[/1/i,/2/i,/3/i,/4/i]},Nd={narrow:/^[jfmasond]/i,abbreviated:/^(jan|feb|mar|apr|may|jun|jul|aug|sep|oct|nov|dec)/i,wide:/^(january|february|march|april|may|june|july|august|september|october|november|december)/i},jd={narrow:[/^j/i,/^f/i,/^m/i,/^a/i,/^m/i,/^j/i,/^j/i,/^a/i,/^s/i,/^o/i,/^n/i,/^d/i],any:[/^ja/i,/^f/i,/^mar/i,/^ap/i,/^may/i,/^jun/i,/^jul/i,/^au/i,/^s/i,/^o/i,/^n/i,/^d/i]},Ed={narrow:/^[smtwf]/i,short:/^(su|mo|tu|we|th|fr|sa)/i,abbreviated:/^(sun|mon|tue|wed|thu|fri|sat)/i,wide:/^(sunday|monday|tuesday|wednesday|thursday|friday|saturday)/i},Sd={narrow:[/^s/i,/^m/i,/^t/i,/^w/i,/^t/i,/^f/i,/^s/i],any:[/^su/i,/^m/i,/^tu/i,/^w/i,/^th/i,/^f/i,/^sa/i]},kd={narrow:/^(a|p|mi|n|(in the|at) (morning|afternoon|evening|night))/i,any:/^([ap]\.?\s?m\.?|midnight|noon|(in the|at) (morning|afternoon|evening|night))/i},Od={any:{am:/^a/i,pm:/^p/i,midnight:/^mi/i,noon:/^no/i,morning:/morning/i,afternoon:/afternoon/i,evening:/evening/i,night:/night/i}},Dd={ordinalNumber:gd({matchPattern:vd,parsePattern:bd,valueCallback:e=>parseInt(e,10)}),era:Vt({matchPatterns:yd,defaultMatchWidth:"wide",parsePatterns:xd,defaultParseWidth:"any"}),quarter:Vt({matchPatterns:wd,defaultMatchWidth:"wide",parsePatterns:Cd,defaultParseWidth:"any",valueCallback:e=>e+1}),month:Vt({matchPatterns:Nd,defaultMatchWidth:"wide",parsePatterns:jd,defaultParseWidth:"any"}),day:Vt({matchPatterns:Ed,defaultMatchWidth:"wide",parsePatterns:Sd,defaultParseWidth:"any"}),dayPeriod:Vt({matchPatterns:kd,defaultMatchWidth:"any",parsePatterns:Od,defaultParseWidth:"any"})},Td={code:"en-US",formatDistance:Zc,formatLong:rd,formatRelative:sd,localize:md,match:Dd,options:{weekStartsOn:0,firstWeekContainsDate:1}};function Rd(e,t){const n=Pe(e,t?.in);return Xc(n,Qc(n))+1}function Md(e,t){const n=Pe(e,t?.in),r=+Rn(n)-+_c(n);return Math.round(r/gs)+1}function bs(e,t){const n=Pe(e,t?.in),r=n.getFullYear(),o=Xn(),s=t?.firstWeekContainsDate??t?.locale?.options?.firstWeekContainsDate??o.firstWeekContainsDate??o.locale?.options?.firstWeekContainsDate??1,i=tt(t?.in||e,0);i.setFullYear(r+1,0,s),i.setHours(0,0,0,0);const l=rn(i,t),c=tt(t?.in||e,0);c.setFullYear(r,0,s),c.setHours(0,0,0,0);const f=rn(c,t);return+n>=+l?r+1:+n>=+f?r:r-1}function Pd(e,t){const n=Xn(),r=t?.firstWeekContainsDate??t?.locale?.options?.firstWeekContainsDate??n.firstWeekContainsDate??n.locale?.options?.firstWeekContainsDate??1,o=bs(e,t),s=tt(t?.in||e,0);return s.setFullYear(o,0,r),s.setHours(0,0,0,0),rn(s,t)}function Fd(e,t){const n=Pe(e,t?.in),r=+rn(n,t)-+Pd(n,t);return Math.round(r/gs)+1}function ne(e,t){const n=e<0?"-":"",r=Math.abs(e).toString().padStart(t,"0");return n+r}const Qe={y(e,t){const n=e.getFullYear(),r=n>0?n:1-n;return ne(t==="yy"?r%100:r,t.length)},M(e,t){const n=e.getMonth();return t==="M"?String(n+1):ne(n+1,2)},d(e,t){return ne(e.getDate(),t.length)},a(e,t){const n=e.getHours()/12>=1?"pm":"am";switch(t){case"a":case"aa":return n.toUpperCase();case"aaa":return n;case"aaaaa":return n[0];case"aaaa":default:return n==="am"?"a.m.":"p.m."}},h(e,t){return ne(e.getHours()%12||12,t.length)},H(e,t){return ne(e.getHours(),t.length)},m(e,t){return ne(e.getMinutes(),t.length)},s(e,t){return ne(e.getSeconds(),t.length)},S(e,t){const n=t.length,r=e.getMilliseconds(),o=Math.trunc(r*Math.pow(10,n-3));return ne(o,t.length)}},yt={midnight:"midnight",noon:"noon",morning:"morning",afternoon:"afternoon",evening:"evening",night:"night"},wo={G:function(e,t,n){const r=e.getFullYear()>0?1:0;switch(t){case"G":case"GG":case"GGG":return n.era(r,{width:"abbreviated"});case"GGGGG":return n.era(r,{width:"narrow"});case"GGGG":default:return n.era(r,{width:"wide"})}},y:function(e,t,n){if(t==="yo"){const r=e.getFullYear(),o=r>0?r:1-r;return n.ordinalNumber(o,{unit:"year"})}return Qe.y(e,t)},Y:function(e,t,n,r){const o=bs(e,r),s=o>0?o:1-o;if(t==="YY"){const i=s%100;return ne(i,2)}return t==="Yo"?n.ordinalNumber(s,{unit:"year"}):ne(s,t.length)},R:function(e,t){const n=vs(e);return ne(n,t.length)},u:function(e,t){const n=e.getFullYear();return ne(n,t.length)},Q:function(e,t,n){const r=Math.ceil((e.getMonth()+1)/3);switch(t){case"Q":return String(r);case"QQ":return ne(r,2);case"Qo":return n.ordinalNumber(r,{unit:"quarter"});case"QQQ":return n.quarter(r,{width:"abbreviated",context:"formatting"});case"QQQQQ":return n.quarter(r,{width:"narrow",context:"formatting"});case"QQQQ":default:return n.quarter(r,{width:"wide",context:"formatting"})}},q:function(e,t,n){const r=Math.ceil((e.getMonth()+1)/3);switch(t){case"q":return String(r);case"qq":return ne(r,2);case"qo":return n.ordinalNumber(r,{unit:"quarter"});case"qqq":return n.quarter(r,{width:"abbreviated",context:"standalone"});case"qqqqq":return n.quarter(r,{width:"narrow",context:"standalone"});case"qqqq":default:return n.quarter(r,{width:"wide",context:"standalone"})}},M:function(e,t,n){const r=e.getMonth();switch(t){case"M":case"MM":return Qe.M(e,t);case"Mo":return n.ordinalNumber(r+1,{unit:"month"});case"MMM":return n.month(r,{width:"abbreviated",context:"formatting"});case"MMMMM":return n.month(r,{width:"narrow",context:"formatting"});case"MMMM":default:return n.month(r,{width:"wide",context:"formatting"})}},L:function(e,t,n){const r=e.getMonth();switch(t){case"L":return String(r+1);case"LL":return ne(r+1,2);case"Lo":return n.ordinalNumber(r+1,{unit:"month"});case"LLL":return n.month(r,{width:"abbreviated",context:"standalone"});case"LLLLL":return n.month(r,{width:"narrow",context:"standalone"});case"LLLL":default:return n.month(r,{width:"wide",context:"standalone"})}},w:function(e,t,n,r){const o=Fd(e,r);return t==="wo"?n.ordinalNumber(o,{unit:"week"}):ne(o,t.length)},I:function(e,t,n){const r=Md(e);return t==="Io"?n.ordinalNumber(r,{unit:"week"}):ne(r,t.length)},d:function(e,t,n){return t==="do"?n.ordinalNumber(e.getDate(),{unit:"date"}):Qe.d(e,t)},D:function(e,t,n){const r=Rd(e);return t==="Do"?n.ordinalNumber(r,{unit:"dayOfYear"}):ne(r,t.length)},E:function(e,t,n){const r=e.getDay();switch(t){case"E":case"EE":case"EEE":return n.day(r,{width:"abbreviated",context:"formatting"});case"EEEEE":return n.day(r,{width:"narrow",context:"formatting"});case"EEEEEE":return n.day(r,{width:"short",context:"formatting"});case"EEEE":default:return n.day(r,{width:"wide",context:"formatting"})}},e:function(e,t,n,r){const o=e.getDay(),s=(o-r.weekStartsOn+8)%7||7;switch(t){case"e":return String(s);case"ee":return ne(s,2);case"eo":return n.ordinalNumber(s,{unit:"day"});case"eee":return n.day(o,{width:"abbreviated",context:"formatting"});case"eeeee":return n.day(o,{width:"narrow",context:"formatting"});case"eeeeee":return n.day(o,{width:"short",context:"formatting"});case"eeee":default:return n.day(o,{width:"wide",context:"formatting"})}},c:function(e,t,n,r){const o=e.getDay(),s=(o-r.weekStartsOn+8)%7||7;switch(t){case"c":return String(s);case"cc":return ne(s,t.length);case"co":return n.ordinalNumber(s,{unit:"day"});case"ccc":return n.day(o,{width:"abbreviated",context:"standalone"});case"ccccc":return n.day(o,{width:"narrow",context:"standalone"});case"cccccc":return n.day(o,{width:"short",context:"standalone"});case"cccc":default:return n.day(o,{width:"wide",context:"standalone"})}},i:function(e,t,n){const r=e.getDay(),o=r===0?7:r;switch(t){case"i":return String(o);case"ii":return ne(o,t.length);case"io":return n.ordinalNumber(o,{unit:"day"});case"iii":return n.day(r,{width:"abbreviated",context:"formatting"});case"iiiii":return n.day(r,{width:"narrow",context:"formatting"});case"iiiiii":return n.day(r,{width:"short",context:"formatting"});case"iiii":default:return n.day(r,{width:"wide",context:"formatting"})}},a:function(e,t,n){const o=e.getHours()/12>=1?"pm":"am";switch(t){case"a":case"aa":return n.dayPeriod(o,{width:"abbreviated",context:"formatting"});case"aaa":return n.dayPeriod(o,{width:"abbreviated",context:"formatting"}).toLowerCase();case"aaaaa":return n.dayPeriod(o,{width:"narrow",context:"formatting"});case"aaaa":default:return n.dayPeriod(o,{width:"wide",context:"formatting"})}},b:function(e,t,n){const r=e.getHours();let o;switch(r===12?o=yt.noon:r===0?o=yt.midnight:o=r/12>=1?"pm":"am",t){case"b":case"bb":return n.dayPeriod(o,{width:"abbreviated",context:"formatting"});case"bbb":return n.dayPeriod(o,{width:"abbreviated",context:"formatting"}).toLowerCase();case"bbbbb":return n.dayPeriod(o,{width:"narrow",context:"formatting"});case"bbbb":default:return n.dayPeriod(o,{width:"wide",context:"formatting"})}},B:function(e,t,n){const r=e.getHours();let o;switch(r>=17?o=yt.evening:r>=12?o=yt.afternoon:r>=4?o=yt.morning:o=yt.night,t){case"B":case"BB":case"BBB":return n.dayPeriod(o,{width:"abbreviated",context:"formatting"});case"BBBBB":return n.dayPeriod(o,{width:"narrow",context:"formatting"});case"BBBB":default:return n.dayPeriod(o,{width:"wide",context:"formatting"})}},h:function(e,t,n){if(t==="ho"){let r=e.getHours()%12;return r===0&&(r=12),n.ordinalNumber(r,{unit:"hour"})}return Qe.h(e,t)},H:function(e,t,n){return t==="Ho"?n.ordinalNumber(e.getHours(),{unit:"hour"}):Qe.H(e,t)},K:function(e,t,n){const r=e.getHours()%12;return t==="Ko"?n.ordinalNumber(r,{unit:"hour"}):ne(r,t.length)},k:function(e,t,n){let r=e.getHours();return r===0&&(r=24),t==="ko"?n.ordinalNumber(r,{unit:"hour"}):ne(r,t.length)},m:function(e,t,n){return t==="mo"?n.ordinalNumber(e.getMinutes(),{unit:"minute"}):Qe.m(e,t)},s:function(e,t,n){return t==="so"?n.ordinalNumber(e.getSeconds(),{unit:"second"}):Qe.s(e,t)},S:function(e,t){return Qe.S(e,t)},X:function(e,t,n){const r=e.getTimezoneOffset();if(r===0)return"Z";switch(t){case"X":return No(r);case"XXXX":case"XX":return ct(r);case"XXXXX":case"XXX":default:return ct(r,":")}},x:function(e,t,n){const r=e.getTimezoneOffset();switch(t){case"x":return No(r);case"xxxx":case"xx":return ct(r);case"xxxxx":case"xxx":default:return ct(r,":")}},O:function(e,t,n){const r=e.getTimezoneOffset();switch(t){case"O":case"OO":case"OOO":return"GMT"+Co(r,":");case"OOOO":default:return"GMT"+ct(r,":")}},z:function(e,t,n){const r=e.getTimezoneOffset();switch(t){case"z":case"zz":case"zzz":return"GMT"+Co(r,":");case"zzzz":default:return"GMT"+ct(r,":")}},t:function(e,t,n){const r=Math.trunc(+e/1e3);return ne(r,t.length)},T:function(e,t,n){return ne(+e,t.length)}};function Co(e,t=""){const n=e>0?"-":"+",r=Math.abs(e),o=Math.trunc(r/60),s=r%60;return s===0?n+String(o):n+String(o)+t+ne(s,2)}function No(e,t){return e%60===0?(e>0?"-":"+")+ne(Math.abs(e)/60,2):ct(e,t)}function ct(e,t=""){const n=e>0?"-":"+",r=Math.abs(e),o=ne(Math.trunc(r/60),2),s=ne(r%60,2);return n+o+t+s}const jo=(e,t)=>{switch(e){case"P":return t.date({width:"short"});case"PP":return t.date({width:"medium"});case"PPP":return t.date({width:"long"});case"PPPP":default:return t.date({width:"full"})}},ys=(e,t)=>{switch(e){case"p":return t.time({width:"short"});case"pp":return t.time({width:"medium"});case"ppp":return t.time({width:"long"});case"pppp":default:return t.time({width:"full"})}},Ad=(e,t)=>{const n=e.match(/(P+)(p+)?/)||[],r=n[1],o=n[2];if(!o)return jo(e,t);let s;switch(r){case"P":s=t.dateTime({width:"short"});break;case"PP":s=t.dateTime({width:"medium"});break;case"PPP":s=t.dateTime({width:"long"});break;case"PPPP":default:s=t.dateTime({width:"full"});break}return s.replace("{{date}}",jo(r,t)).replace("{{time}}",ys(o,t))},$d={p:ys,P:Ad},Ld=/^D+$/,Yd=/^Y+$/,Id=["D","DD","YY","YYYY"];function zd(e){return Ld.test(e)}function Wd(e){return Yd.test(e)}function Bd(e,t,n){const r=Hd(e,t,n);if(console.warn(r),Id.includes(e))throw new RangeError(r)}function Hd(e,t,n){const r=e[0]==="Y"?"years":"days of the month";return`Use \`${e.toLowerCase()}\` instead of \`${e}\` (in \`${t}\`) for formatting ${r} to the input \`${n}\`; see: https://github.com/date-fns/date-fns/blob/master/docs/unicodeTokens.md`}const Vd=/[yYQqMLwIdDecihHKkms]o|(\w)\1*|''|'(''|[^'])+('|$)|./g,qd=/P+p+|P+|p+|''|'(''|[^'])+('|$)|./g,Gd=/^'([^]*?)'?$/,Xd=/''/g,_d=/[a-zA-Z]/;function xt(e,t,n){const r=Xn(),o=r.locale??Td,s=r.firstWeekContainsDate??r.locale?.options?.firstWeekContainsDate??1,i=r.weekStartsOn??r.locale?.options?.weekStartsOn??0,l=Pe(e,n?.in);if(!Uc(l))throw new RangeError("Invalid time value");let c=t.match(qd).map(d=>{const p=d[0];if(p==="p"||p==="P"){const b=$d[p];return b(d,o.formatLong)}return d}).join("").match(Vd).map(d=>{if(d==="''")return{isToken:!1,value:"'"};const p=d[0];if(p==="'")return{isToken:!1,value:Kd(d)};if(wo[p])return{isToken:!0,value:d};if(p.match(_d))throw new RangeError("Format string contains an unescaped latin alphabet character `"+p+"`");return{isToken:!1,value:d}});o.localize.preprocessor&&(c=o.localize.preprocessor(l,c));const f={firstWeekContainsDate:s,weekStartsOn:i,locale:o};return c.map(d=>{if(!d.isToken)return d.value;const p=d.value;(Wd(p)||zd(p))&&Bd(p,t,String(e));const b=wo[p[0]];return b(l,p,o.localize,f)}).join("")}function Kd(e){const t=e.match(Gd);return t?t[1].replace(Xd,"'"):e}const Ud=(e,t)=>{if(e==null||isNaN(e))return"";if(!t)return e.toString();const{decimalPlaces:n=2,thousandSeparator:r=!0,displayType:o="number",currencySymbol:s="$",negativeFormat:i="-1234"}=t;let l="";if(o==="percentage")l=(e*100).toFixed(n);else{if(o==="scientific")return l=e.toExponential(n),l;l=e.toFixed(n)}if(r&&o!=="scientific"){const c=l.split(".");c[0]=c[0].replace(/\B(?=(\d{3})+(?!\d))/g,","),l=c.join(".")}if(o==="currency"&&(l=`${s}${l}`),o==="percentage"&&(l=`${l}%`),e<0){const c=l.replace("-","");switch(i){case"(1234)":return`(${c})`;case"1234-":return`${c}-`;case"-1234":default:return`-${c}`}}return l},Qd=(e,t)=>{if(!e)return"";if(!t)return new Date(e).toLocaleDateString();const n=new Date(e);if(isNaN(n.getTime()))return String(e);const{pattern:r,customPattern:o}=t;try{if(r==="custom"&&o)return xt(n,o);switch(r){case"short":return xt(n,"P");case"medium":return xt(n,"PP");case"long":return xt(n,"PPP");case"full":return xt(n,"PPPP");case"ISO":return n.toISOString().split("T")[0];default:return xt(n,"P")}}catch(s){return console.warn("Error formatting date:",s),n.toLocaleDateString()}},Jd=({visible:e,onClose:t,config:n,previewData:r,gcData:o,rcData:s,isLoading:i,totalRows:l,filters:c=[],allFields:f=[]})=>{const{headerRows:d,rowHeaders:p,dataMatrix:b}=m.useMemo(()=>Rs(r,n.groupColumns,n.pivotColumns,n.valueColumns,{showRowTotals:n.showRowTotals,rowTotalsPosition:n.rowTotalsPosition,showColumnTotals:n.showColumnTotals,columnTotalsPosition:n.columnTotalsPosition,showSubtotals:n.showSubtotals},o||void 0,s||void 0),[r,o,s,n.groupColumns,n.pivotColumns,n.valueColumns,n.showRowTotals,n.rowTotalsPosition,n.showColumnTotals,n.columnTotalsPosition,n.showSubtotals]),v=w=>{switch(w.type){case"text":return w.text;case"column":const g=f.find(x=>x.id===w.column),h=c.find(x=>x.id===w.column);return h&&h.value&&!h.value.includes(",")?`${g?.name||w.column}: ${h.value}`:`${g?.name||w.column}: (All)`;case"filters":return!w.selectedFilters||w.selectedFilters.length===0?"":a.jsx(a.Fragment,{children:w.selectedFilters.map((x,E)=>{const C=c.find(k=>k.id===x),j=`${C?.name||x}: ${C?.value||"All"}`;return a.jsxs(y.Fragment,{children:[E>0&&a.jsx("br",{}),j]},x)})});case"refreshDate":return`Data as of: ${new Date().toLocaleString()}`;default:return""}};return a.jsxs(rt,{visible:e,onClose:t,size:"xl",children:[a.jsx(st,{closeButton:!0,children:a.jsxs(at,{children:["Preview",l!==void 0&&l>0&&a.jsxs("span",{className:"text-sm text-gray-500 font-normal ml-3",children:["(Showing ",r.length," of ",l," rows)"]})]})}),a.jsx(ot,{className:"overflow-auto max-h-[70vh]",children:i?a.jsxs("div",{className:"text-center py-10",children:[a.jsx("div",{className:"spinner-border text-primary",role:"status",children:a.jsx("span",{className:"visually-hidden",children:"Loading..."})}),a.jsx("p",{className:"mt-2 text-gray-500",children:"Generating preview..."})]}):a.jsxs(jr,{bordered:!0,hover:!0,responsive:!0,className:"text-sm",children:[a.jsxs(ln,{children:[n.headerRowSettings?.map((w,g)=>a.jsx($e,{children:a.jsx(dt,{colSpan:n.groupColumns.length+(d[0]?.length||1),className:"p-2",style:{textAlign:w.textAlign||"left",color:w.fontColor||"inherit",backgroundColor:w.bgColor||"transparent",fontWeight:"bold"},children:v(w)})},`custom-header-${g}`)),d.map((w,g)=>a.jsxs($e,{children:[g===0&&n.groupColumns.map(h=>a.jsx(dt,{rowSpan:d.length,className:"font-semibold align-middle",style:{color:n.pivotHeaderFormat?.fontColor,backgroundColor:n.pivotHeaderFormat?.bgColor,textAlign:n.pivotHeaderFormat?.textAlign},children:h.name},h.id)),w.map((h,x)=>a.jsx(dt,{colSpan:h.colSpan,className:"text-center",style:{...h.style,color:n.pivotHeaderFormat?.fontColor,backgroundColor:h.style?.backgroundColor||n.pivotHeaderFormat?.bgColor,textAlign:n.pivotHeaderFormat?.textAlign},children:h.label},x))]},g)),d.length===0&&n.groupColumns.length>0&&a.jsx($e,{children:n.groupColumns.map(w=>a.jsx(dt,{className:"font-semibold",style:{color:n.pivotHeaderFormat?.fontColor,backgroundColor:n.pivotHeaderFormat?.bgColor,textAlign:n.pivotHeaderFormat?.textAlign},children:w.name},w.id))})]}),a.jsx(Yn,{children:r.length>0?p.map((w,g)=>a.jsxs($e,{children:[w.map((h,x)=>h.isVisible?a.jsx(ft,{rowSpan:h.rowSpan,colSpan:h.colSpan||1,className:`${h.style?"":"bg-white"} font-medium align-top ${h.value==="Grand Total"?"font-bold":""}`,style:h.style,children:h.value},x):null),b[g]?.map((h,x)=>{const E=n.valueColumns[x%n.valueColumns.length];let C=h?.value!==null&&h?.value!==void 0?String(h.value):"";return E&&h&&h.value!==null&&h.value!==void 0&&(E.dataType==="date"||E.dataType==="datetime"?C=Qd(String(h.value),E.dateFormat):(typeof h.value=="number"||!isNaN(Number(h.value)))&&(C=Ud(Number(h.value),E.numberFormat))),a.jsx(ft,{className:"text-right",style:h?.style,children:C},x)})]},g)):a.jsx($e,{children:a.jsx(ft,{colSpan:n.groupColumns.length+(b[0]?.length||1),className:"text-center text-gray-400 py-8",children:"No data available for preview."})})})]})}),a.jsx(pt,{children:a.jsx(J,{color:"secondary",onClick:t,children:"Close"})})]})};function Zd(){const{isInitialized:e,worksheets:t}=Ms(),{config:n,updateConfig:r,addMetricGroup:o,removeMetricGroup:s,updateMetricGroup:i,resetConfig:l,setConfig:c}=li(),[f,d]=m.useState([]),[p,b]=m.useState([]),[v,w]=m.useState(!1),[g,h]=m.useState([]),[x,E]=m.useState(null),[C,j]=m.useState(null),[k,O]=m.useState(!1),[N,S]=m.useState(0),[R,F]=m.useState(!1),[P,A]=m.useState("idle");m.useEffect(()=>{if(e&&window.tableau?.extensions?.settings){const D=window.tableau.extensions.settings.get("active_worksheet");let M=null;if(D&&(M=window.tableau.extensions.settings.get(`config_${D}`)),M||(M=window.tableau.extensions.settings.get("config")),M)try{const $=JSON.parse(M);console.log("Loaded saved config:",$),c($)}catch($){console.error("Error loading saved config:",$)}}},[e]),m.useEffect(()=>{(async()=>{if(!(!n.selectedWorksheet||!e)){w(!0);try{const M=t.find($=>$.name===n.selectedWorksheet);if(M){const $=await M.getDataSourcesAsync(),X=new Map;$.forEach(B=>{B.fields.forEach(ee=>{const re={caption:ee.caption||ee.name,isCalculatedField:ee.isCalculatedField||!1};X.set(ee.name,re),X.set(ee.id,re)})});const T=await M.getSummaryDataAsync({maxRows:1e4}),U=T.columns.findIndex(B=>B.fieldName==="Measure Names"),W=T.columns.findIndex(B=>B.fieldName==="Measure Values"),oe=U!==-1&&W!==-1;console.log("Summary Data Columns:",T.columns);let _=T.columns.filter(B=>B.fieldName!=="Measure Names"&&B.fieldName!=="Measure Values").map(B=>{const ee=X.get(B.fieldName),re=ee?.caption||B.name||B.fieldName,ce=ee?ee.isCalculatedField:B.isCalculatedField;return{id:B.fieldName,name:re,dataType:B.dataType,isCalculatedField:ce}});if(oe){const B=new Set;T.data.forEach(ee=>{const re=ee[U].value;if(re){let ce=re;const Te=re.match(/\[([^\]]+)\]\.\[([^:]+):([^:]+):/);if(Te&&Te[3])ce=Te[3];else{const Ge=re.match(/\[([^\]]+)\]$/);Ge&&Ge[1]&&(ce=Ge[1])}B.add(ce)}}),B.forEach(ee=>{const re=X.get(ee),ce=re?.caption||ee,Te=re?re.isCalculatedField:!0;_.push({id:ee,name:ce,dataType:"float",isCalculatedField:Te})}),console.log("Extracted measures from Measure Values:",Array.from(B))}console.log("Fetched columns from view:",_);const Ne=await M.getFiltersAsync(),he=await Promise.all(Ne.filter(B=>B.fieldName!=="Measure Names").map(async B=>{let ee="";switch(B.filterType){case"categorical":ee=B.appliedValues?.map(re=>re.formattedValue).join(", ")||"All";break;case"range":ee=`${B.minValue?.formattedValue||"*"} to ${B.maxValue?.formattedValue||"*"}`;break;case"relative-date":ee=`${B.period} ${B.rangeType}`;break;default:ee="Complex Filter"}return{id:B.fieldName,name:B.fieldName,value:ee}}));b(he),d(_)}}catch(M){console.error("Error fetching columns:",M),d([]),b([])}finally{w(!1)}}})()},[n.selectedWorksheet,e,t]);const Y=D=>{const M={id:`custom_${Date.now()}`,name:D,dataType:"float",isCalculatedField:!0,isCustom:!0};d($=>[...$,M])},Z=D=>{d(M=>M.filter($=>$.id!==D))},H=(D,M)=>{d($=>$.map(X=>X.id===D?{...X,name:M}:X))},te=[...f,...n.customFields||[]],G=te.filter(D=>{const M=n.groupColumns.some(T=>T.id===D.id),$=n.pivotColumns.some(T=>T.id===D.id),X=n.valueColumns.some(T=>T.id===D.id);return!M&&!$&&!X}),ie=async()=>{if(n.selectedWorksheet){O(!0);try{const{main:D,gcData:M,rcData:$}=await ii(()=>import("./dataFetcher-CWqu6ZEc.js"),[],import.meta.url).then(W=>W.fetchFullDataset(n.selectedWorksheet,2e4));S(D.length),h(D),E(M),j($),D.length>0;const X=n.groupColumns.filter(W=>W.id!=="Measure Names"&&W.id!=="Measure Values"),T=n.pivotColumns.filter(W=>W.id!=="Measure Names"&&W.id!=="Measure Values"),U=n.valueColumns.filter(W=>W.id!=="Measure Names"&&W.id!=="Measure Values");(X.length!==n.groupColumns.length||T.length!==n.pivotColumns.length||U.length!==n.valueColumns.length)&&r({groupColumns:X,pivotColumns:T,valueColumns:U})}finally{O(!1)}}},I=async()=>{if(n.exportMode==="datadump"){alert("Preview only available for formatted excel report");return}F(!0),await ie()},L=()=>{window.tableau?.extensions?.settings&&n.selectedWorksheet&&(A("saving"),window.tableau.extensions.settings.set(`config_${n.selectedWorksheet}`,JSON.stringify(n)),window.tableau.extensions.settings.set("active_worksheet",n.selectedWorksheet),window.tableau.extensions.settings.saveAsync().then(()=>{A("saved"),setTimeout(()=>A("idle"),3e3)}).catch(D=>{console.error("Error saving settings:",D),A("error")}))},K=D=>{if(!D)return;const M=window.tableau.extensions.settings.get(`config_${D}`);if(M)try{const $=JSON.parse(M);c($)}catch{console.error("Error parsing saved config for sheet:",D),l(D)}else l(D)};return e?a.jsx("div",{className:"min-h-screen bg-gray-50 p-6",children:a.jsxs("div",{className:"max-w-7xl mx-auto",children:[a.jsx("header",{className:"mb-6 bg-white p-4 rounded-lg shadow-sm",children:a.jsxs("div",{className:"flex items-center justify-between",children:[a.jsxs("div",{className:"flex items-center gap-4",children:[a.jsx("img",{src:"./eps-logo-2023_v03--blue.svg",alt:"Epsilon",className:"h-8"}),a.jsx("h1",{className:"text-xl font-bold text-epsilon-blue",children:"Configure Excel Export"})]}),v&&a.jsx(Un,{size:"sm",color:"primary"}),a.jsx("div",{className:"flex gap-4 items-center",children:a.jsx(Er,{content:"If you're facing any issues using this page or there are any issues, please contact abhishek.rao@epsilon.com",placement:"bottom",children:a.jsx(Ti,{className:"text-epsilon-blue cursor-help h-5 w-5"})})})]})}),a.jsx(Hc,{config:n,onUpdateConfig:r,worksheets:t,filters:p,onWorksheetChange:K,availableColumns:G,allFields:te,groupColumns:n.groupColumns,pivotColumns:n.pivotColumns,valueColumns:n.valueColumns,onColumnsUpdate:(D,M)=>{r({[`${D}Columns`]:M})},metricGroups:n.metricGroups,onAddGroup:o,onRemoveGroup:s,onUpdateGroup:i,onAddCustomField:Y,onDeleteCustomField:Z,onUpdateCustomField:H}),a.jsx(Jd,{visible:R,onClose:()=>F(!1),config:n,previewData:g,gcData:x,rcData:C,isLoading:k,totalRows:N,filters:p,allFields:f}),a.jsxs("div",{className:"mt-6 flex justify-end gap-3 items-center",children:[P==="saved"&&a.jsx("span",{className:"text-green-600 font-medium mr-2",children:"Configuration Saved!"}),P==="error"&&a.jsx("span",{className:"text-red-600 font-medium mr-2",children:"Error Saving!"}),a.jsx(J,{color:"secondary",onClick:()=>window.tableau?.extensions?.ui?.closeDialog("cancel"),children:"Close"}),a.jsx(J,{color:"primary",onClick:L,disabled:P==="saving",children:P==="saving"?"Saving...":"Save Configuration"}),a.jsx(J,{color:"primary",variant:"outline",onClick:I,disabled:!n.selectedWorksheet||k,className:"border-epsilon-blue text-epsilon-blue hover:bg-epsilon-blue hover:text-white",children:k?a.jsx(Un,{size:"sm"}):"Preview"})]})]})}):a.jsx("div",{className:"flex items-center justify-center h-screen bg-gray-50",children:a.jsxs("div",{className:"text-center",children:[a.jsx(Un,{color:"primary",className:"mb-3"}),a.jsx("p",{className:"text-gray-600",children:"Initializing configuration..."})]})})}Ps.createRoot(document.getElementById("root")).render(a.jsx(m.StrictMode,{children:a.jsx(Zd,{})}));
